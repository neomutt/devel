<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: pgpinvoke.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mutt.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">1.7.1</span>
   </div>
   <div id="projectbrief">Mail Reader</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">pgpinvoke.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="pgpinvoke_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (C) 1997-2003 Thomas Roessler &lt;roessler@does-not-exist.org&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *     This program is free software; you can redistribute it</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *     and/or modify it under the terms of the GNU General Public</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *     License as published by the Free Software Foundation; either</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *     version 2 of the License, or (at your option) any later</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *     version.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *     This program is distributed in the hope that it will be</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *     useful, but WITHOUT ANY WARRANTY; without even the implied</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *     warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *     PURPOSE.  See the GNU General Public License for more</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *     details.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *     You should have received a copy of the GNU General Public</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *     License along with this program; if not, write to the Free</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *     Software Foundation, Inc., 51 Franklin Street, Fifth Floor,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *     Boston, MA  02110-1301, USA.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> */</span> </div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/* This file contains the new pgp invocation code.  Note that this</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * is almost entirely format based.</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#if HAVE_CONFIG_H</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor"># include &quot;config.h&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mutt_8h.html">mutt.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mutt__curses_8h.html">mutt_curses.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mutt__idna_8h.html">mutt_idna.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pgp_8h.html">pgp.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rfc822_8h.html">rfc822.h</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> * The actual command line formatter.</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="structpgp__command__context.html">   50</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structpgp__command__context.html">pgp_command_context</a> {</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structpgp__command__context.html#a2dd8c0b313a19702e786598dff3c165a">   51</a></span>&#160;  <span class="keywordtype">short</span> <a class="code" href="structpgp__command__context.html#a2dd8c0b313a19702e786598dff3c165a">need_passphrase</a>;        <span class="comment">/* %p */</span></div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">   52</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a>;            <span class="comment">/* %f */</span></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structpgp__command__context.html#ae14ae4ce3db686b47d7c21266e512e0a">   53</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#ae14ae4ce3db686b47d7c21266e512e0a">sig_fname</a>;        <span class="comment">/* %s */</span></div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="structpgp__command__context.html#a00fbb8c8d4ad55fd6938768ee6faed9b">   54</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#a00fbb8c8d4ad55fd6938768ee6faed9b">signas</a>;           <span class="comment">/* %a */</span></div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="structpgp__command__context.html#a24d99e7907a4c8b545c7c21367bb6f94">   55</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#a24d99e7907a4c8b545c7c21367bb6f94">ids</a>;              <span class="comment">/* %r */</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;};</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#ae4b72b2e4706ac9624cdd50fad5844e7">   59</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="pgpinvoke_8c.html#ae4b72b2e4706ac9624cdd50fad5844e7">_mutt_fmt_pgp_command</a> (<span class="keywordtype">char</span> *dest,</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                   <span class="keywordtype">size_t</span> destlen,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                   <span class="keywordtype">size_t</span> col,</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                   <span class="keywordtype">int</span> cols,</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                   <span class="keywordtype">char</span> op,</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *src,</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix,</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *ifstring,</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *elsestring,</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> data,</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                   <a class="code" href="mutt_8h.html#a9498724ab6e4b2d35b96c492374513ae">format_flag</a> flags)</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordtype">char</span> fmt[16];</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keyword">struct </span><a class="code" href="structpgp__command__context.html">pgp_command_context</a> *cctx = (<span class="keyword">struct </span><a class="code" href="structpgp__command__context.html">pgp_command_context</a> *) data;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">int</span> optional = (flags &amp; <a class="code" href="mutt_8h.html#a9498724ab6e4b2d35b96c492374513aeaf2d8536087d5168ce24d2aa7e71823cb">MUTT_FORMAT_OPTIONAL</a>);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  </div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">switch</span> (op)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>:</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">if</span> (!optional)</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (fmt, <span class="keyword">sizeof</span> (fmt), <span class="stringliteral">&quot;%%%ss&quot;</span>, prefix);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (dest, destlen, fmt, <a class="code" href="lib_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a> (cctx-&gt;<a class="code" href="structpgp__command__context.html#a24d99e7907a4c8b545c7c21367bb6f94">ids</a>));</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!cctx-&gt;<a class="code" href="structpgp__command__context.html#a24d99e7907a4c8b545c7c21367bb6f94">ids</a>)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        optional = 0;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">if</span> (!optional)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (fmt, <span class="keyword">sizeof</span> (fmt), <span class="stringliteral">&quot;%%%ss&quot;</span>, prefix);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (dest, destlen, fmt, <a class="code" href="lib_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a> (cctx-&gt;<a class="code" href="structpgp__command__context.html#a00fbb8c8d4ad55fd6938768ee6faed9b">signas</a>));</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!cctx-&gt;<a class="code" href="structpgp__command__context.html#a00fbb8c8d4ad55fd6938768ee6faed9b">signas</a>)</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        optional = 0;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    </div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">if</span> (!optional)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (fmt, <span class="keyword">sizeof</span> (fmt), <span class="stringliteral">&quot;%%%ss&quot;</span>, prefix);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (dest, destlen, fmt, <a class="code" href="lib_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a> (cctx-&gt;<a class="code" href="structpgp__command__context.html#ae14ae4ce3db686b47d7c21266e512e0a">sig_fname</a>));</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!cctx-&gt;<a class="code" href="structpgp__command__context.html#ae14ae4ce3db686b47d7c21266e512e0a">sig_fname</a>)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        optional = 0;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    </div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">if</span> (!optional)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (fmt, <span class="keyword">sizeof</span> (fmt), <span class="stringliteral">&quot;%%%ss&quot;</span>, prefix);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (dest, destlen, fmt, <a class="code" href="lib_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a> (cctx-&gt;<a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a>));</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!cctx-&gt;<a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a>)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        optional = 0;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    </div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordflow">if</span> (!optional)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (fmt, <span class="keyword">sizeof</span> (fmt), <span class="stringliteral">&quot;%%%ss&quot;</span>, prefix);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (dest, destlen, fmt, cctx-&gt;<a class="code" href="structpgp__command__context.html#a2dd8c0b313a19702e786598dff3c165a">need_passphrase</a> ? <span class="stringliteral">&quot;PGPPASSFD=0&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!cctx-&gt;<a class="code" href="structpgp__command__context.html#a2dd8c0b313a19702e786598dff3c165a">need_passphrase</a> || <a class="code" href="pgp_8c.html#aaf433b0e23f81682f4911f5712e10051">pgp_use_gpg_agent</a>())</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        optional = 0;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      *dest = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">if</span> (optional)</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="muttlib_8c.html#a8f68fc734dc58779cfabcfbb2d547602">mutt_FormatString</a> (dest, destlen, col, cols, ifstring, <a class="code" href="pgpinvoke_8c.html#ae4b72b2e4706ac9624cdd50fad5844e7">_mutt_fmt_pgp_command</a>, data, 0);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flags &amp; <a class="code" href="mutt_8h.html#a9498724ab6e4b2d35b96c492374513aeaf2d8536087d5168ce24d2aa7e71823cb">MUTT_FORMAT_OPTIONAL</a>)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="muttlib_8c.html#a8f68fc734dc58779cfabcfbb2d547602">mutt_FormatString</a> (dest, destlen, col, cols, elsestring, <a class="code" href="pgpinvoke_8c.html#ae4b72b2e4706ac9624cdd50fad5844e7">_mutt_fmt_pgp_command</a>, data, 0);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">return</span> (src);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#a3d4c8886e5a525a8a898c99f600c7ce6">  151</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="pgpinvoke_8c.html#a3d4c8886e5a525a8a898c99f600c7ce6">mutt_pgp_command</a> (<span class="keywordtype">char</span> *d, <span class="keywordtype">size_t</span> dlen, <span class="keyword">struct</span> <a class="code" href="structpgp__command__context.html">pgp_command_context</a> *cctx, <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt)</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;{</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="muttlib_8c.html#a8f68fc734dc58779cfabcfbb2d547602">mutt_FormatString</a> (d, dlen, 0, <a class="code" href="curs__lib_8c.html#afd19d94fefe1f3e10bd6f2e3564bb005">MuttIndexWindow</a>-&gt;<a class="code" href="structmutt__window__t.html#a6899cc51ad027005177c1d2835bce781">cols</a>, <a class="code" href="lib_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a> (fmt), <a class="code" href="pgpinvoke_8c.html#ae4b72b2e4706ac9624cdd50fad5844e7">_mutt_fmt_pgp_command</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) cctx, 0);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="lib_8h.html#a5c75177122494450ca7234a1f4048711">dprint</a> (2, (debugfile, <span class="stringliteral">&quot;mutt_pgp_command: %s\n&quot;</span>, d));</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> * Glue.</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">  162</a></span>&#160;<span class="keyword">static</span> pid_t <a class="code" href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">pgp_invoke</a> (FILE **pgpin, FILE **pgpout, FILE **pgperr,</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                         <span class="keywordtype">int</span> pgpinfd, <span class="keywordtype">int</span> pgpoutfd, <span class="keywordtype">int</span> pgperrfd,</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                         <span class="keywordtype">short</span> <a class="code" href="structpgp__command__context.html#a2dd8c0b313a19702e786598dff3c165a">need_passphrase</a>,</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a>,</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#ae14ae4ce3db686b47d7c21266e512e0a">sig_fname</a>,</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#a00fbb8c8d4ad55fd6938768ee6faed9b">signas</a>,</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#a24d99e7907a4c8b545c7c21367bb6f94">ids</a>,</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">char</span> *format)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;{</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keyword">struct </span><a class="code" href="structpgp__command__context.html">pgp_command_context</a> cctx;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">char</span> cmd[<a class="code" href="lib_8h.html#a311ef6df9e7e4907c467d815ee8a20b2">HUGE_STRING</a>];</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  </div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="protos_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (&amp;cctx, 0, <span class="keyword">sizeof</span> (cctx));</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">if</span> (!format || !*format)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">return</span> (pid_t) -1;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  </div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  cctx.<a class="code" href="structpgp__command__context.html#a2dd8c0b313a19702e786598dff3c165a">need_passphrase</a> = <a class="code" href="structpgp__command__context.html#a2dd8c0b313a19702e786598dff3c165a">need_passphrase</a>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  cctx.<a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a>           = <a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  cctx.<a class="code" href="structpgp__command__context.html#ae14ae4ce3db686b47d7c21266e512e0a">sig_fname</a>       = <a class="code" href="structpgp__command__context.html#ae14ae4ce3db686b47d7c21266e512e0a">sig_fname</a>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  cctx.<a class="code" href="structpgp__command__context.html#a00fbb8c8d4ad55fd6938768ee6faed9b">signas</a>          = <a class="code" href="structpgp__command__context.html#a00fbb8c8d4ad55fd6938768ee6faed9b">signas</a>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  cctx.<a class="code" href="structpgp__command__context.html#a24d99e7907a4c8b545c7c21367bb6f94">ids</a>             = <a class="code" href="structpgp__command__context.html#a24d99e7907a4c8b545c7c21367bb6f94">ids</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  </div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="pgpinvoke_8c.html#a3d4c8886e5a525a8a898c99f600c7ce6">mutt_pgp_command</a> (cmd, <span class="keyword">sizeof</span> (cmd), &amp;cctx, format);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  </div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="filter_8c.html#ac11a676d3f214c21cf70e360002757ec">mutt_create_filter_fd</a> (cmd, pgpin, pgpout, pgperr,</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                               pgpinfd, pgpoutfd, pgperrfd);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"> * The exported interface.</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> * This is historic and may be removed at some point.</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#af4efc98585839254ef198fc11bfaef1a">  200</a></span>&#160;pid_t <a class="code" href="pgpinvoke_8c.html#af4efc98585839254ef198fc11bfaef1a">pgp_invoke_decode</a> (FILE **pgpin, FILE **pgpout, FILE **pgperr,</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                         <span class="keywordtype">int</span> pgpinfd, <span class="keywordtype">int</span> pgpoutfd, <span class="keywordtype">int</span> pgperrfd, </div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a>, <span class="keywordtype">short</span> <a class="code" href="structpgp__command__context.html#a2dd8c0b313a19702e786598dff3c165a">need_passphrase</a>)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;{</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">pgp_invoke</a> (pgpin, pgpout, pgperr, pgpinfd, pgpoutfd, pgperrfd,</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                     need_passphrase, fname, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="globals_8h.html#ada647458b3fb420ea7990fb9019440cd">PgpSignAs</a>, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, </div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                     <a class="code" href="globals_8h.html#a258cb9827d9b0b16bbcf324cf7f66d8f">PgpDecodeCommand</a>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#a8fe4ad1e92c87be40e03523299d3d0a0">  209</a></span>&#160;pid_t <a class="code" href="pgpinvoke_8c.html#a8fe4ad1e92c87be40e03523299d3d0a0">pgp_invoke_verify</a> (FILE **pgpin, FILE **pgpout, FILE **pgperr,</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                         <span class="keywordtype">int</span> pgpinfd, <span class="keywordtype">int</span> pgpoutfd, <span class="keywordtype">int</span> pgperrfd, </div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#ae14ae4ce3db686b47d7c21266e512e0a">sig_fname</a>)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;{</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">pgp_invoke</a> (pgpin, pgpout, pgperr, pgpinfd, pgpoutfd, pgperrfd,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                     0, fname, sig_fname, <a class="code" href="globals_8h.html#ada647458b3fb420ea7990fb9019440cd">PgpSignAs</a>, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="globals_8h.html#a954e6dfb93392d38a80ee1e98266855d">PgpVerifyCommand</a>);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;}</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#ae5bab436b25e622a2163ef2a5f7977da">  217</a></span>&#160;pid_t <a class="code" href="pgpinvoke_8c.html#ae5bab436b25e622a2163ef2a5f7977da">pgp_invoke_decrypt</a> (FILE **pgpin, FILE **pgpout, FILE **pgperr,</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                          <span class="keywordtype">int</span> pgpinfd, <span class="keywordtype">int</span> pgpoutfd, <span class="keywordtype">int</span> pgperrfd, </div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a>)</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;{</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">pgp_invoke</a> (pgpin, pgpout, pgperr, pgpinfd, pgpoutfd, pgperrfd,</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                     1, fname, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="globals_8h.html#ada647458b3fb420ea7990fb9019440cd">PgpSignAs</a>, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="globals_8h.html#abc35c3ba17b01b18e5c3b353a93b79aa">PgpDecryptCommand</a>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#a18b48d492a005f8baa81e8ca5ffd6ab4">  225</a></span>&#160;pid_t <a class="code" href="pgpinvoke_8c.html#a18b48d492a005f8baa81e8ca5ffd6ab4">pgp_invoke_sign</a> (FILE **pgpin, FILE **pgpout, FILE **pgperr,</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                       <span class="keywordtype">int</span> pgpinfd, <span class="keywordtype">int</span> pgpoutfd, <span class="keywordtype">int</span> pgperrfd, </div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a>)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;{</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">pgp_invoke</a> (pgpin, pgpout, pgperr, pgpinfd, pgpoutfd, pgperrfd,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                     1, fname, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="globals_8h.html#ada647458b3fb420ea7990fb9019440cd">PgpSignAs</a>, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="globals_8h.html#a417d69f294dd0da964b3e92a4c153880">PgpSignCommand</a>);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;}</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#abde452feebcf67086ff8152d75dbd20b">  234</a></span>&#160;pid_t <a class="code" href="pgpinvoke_8c.html#abde452feebcf67086ff8152d75dbd20b">pgp_invoke_encrypt</a> (FILE **pgpin, FILE **pgpout, FILE **pgperr,</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                          <span class="keywordtype">int</span> pgpinfd, <span class="keywordtype">int</span> pgpoutfd, <span class="keywordtype">int</span> pgperrfd,</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *uids, <span class="keywordtype">int</span> sign)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;{</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">if</span> (sign)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">pgp_invoke</a> (pgpin, pgpout, pgperr, pgpinfd, pgpoutfd, pgperrfd,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                       1, fname, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="globals_8h.html#ada647458b3fb420ea7990fb9019440cd">PgpSignAs</a>, uids, </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                       <a class="code" href="globals_8h.html#a0685f74bf825069af21d49ba3dc93524">PgpEncryptSignCommand</a>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">pgp_invoke</a> (pgpin, pgpout, pgperr, pgpinfd, pgpoutfd, pgperrfd,</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                       0, fname, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="globals_8h.html#ada647458b3fb420ea7990fb9019440cd">PgpSignAs</a>, uids,</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                       <a class="code" href="globals_8h.html#a56ceb2330854735cf9878e515983fa93">PgpEncryptOnlyCommand</a>);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#a5d8f983a20fcc1b2d1dbf4c94d774a4f">  248</a></span>&#160;pid_t <a class="code" href="pgpinvoke_8c.html#a5d8f983a20fcc1b2d1dbf4c94d774a4f">pgp_invoke_traditional</a> (FILE **pgpin, FILE **pgpout, FILE **pgperr,</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                              <span class="keywordtype">int</span> pgpinfd, <span class="keywordtype">int</span> pgpoutfd, <span class="keywordtype">int</span> pgperrfd,</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *uids, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">if</span> (flags &amp; <a class="code" href="mutt__crypt_8h.html#a1cb0c60ca582db30ae87362ca43e8c19">ENCRYPT</a>)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">pgp_invoke</a> (pgpin, pgpout, pgperr, pgpinfd, pgpoutfd, pgperrfd,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                       flags &amp; <a class="code" href="mutt__crypt_8h.html#a9576d2d6eb782d532607bac077e87892">SIGN</a> ? 1 : 0, fname, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="globals_8h.html#ada647458b3fb420ea7990fb9019440cd">PgpSignAs</a>, uids, </div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                       flags &amp; SIGN ? <a class="code" href="globals_8h.html#a0685f74bf825069af21d49ba3dc93524">PgpEncryptSignCommand</a> : <a class="code" href="globals_8h.html#a56ceb2330854735cf9878e515983fa93">PgpEncryptOnlyCommand</a>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">pgp_invoke</a> (pgpin, pgpout, pgperr, pgpinfd, pgpoutfd, pgperrfd,</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                       1, fname, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="globals_8h.html#ada647458b3fb420ea7990fb9019440cd">PgpSignAs</a>, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                       <a class="code" href="globals_8h.html#a6538b74305df01c996f002fbd113cf43">PgpClearSignCommand</a>);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#ac7dd71aa84bcd3b0a92ff90c59305b9d">  263</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="pgpinvoke_8c.html#ac7dd71aa84bcd3b0a92ff90c59305b9d">pgp_invoke_import</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a>)</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;{</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordtype">char</span> _fname[<a class="code" href="dcigettext_8c.html#a45614b6d4dc532a7211d75e0aa18c964">_POSIX_PATH_MAX</a> + <a class="code" href="lib_8h.html#a1f35aabd376e7d34b1900d9caae1715f">SHORT_STRING</a>];</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordtype">char</span> cmd[<a class="code" href="lib_8h.html#a311ef6df9e7e4907c467d815ee8a20b2">HUGE_STRING</a>];</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keyword">struct </span><a class="code" href="structpgp__command__context.html">pgp_command_context</a> cctx;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  </div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <a class="code" href="protos_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (&amp;cctx, 0, <span class="keyword">sizeof</span> (cctx));</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  </div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <a class="code" href="lib_8c.html#a103326f37296f71ab471ea2aa14130b4">mutt_quote_filename</a> (_fname, <span class="keyword">sizeof</span> (_fname), fname);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  cctx.<a class="code" href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">fname</a> = _fname;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  cctx.<a class="code" href="structpgp__command__context.html#a00fbb8c8d4ad55fd6938768ee6faed9b">signas</a> = <a class="code" href="globals_8h.html#ada647458b3fb420ea7990fb9019440cd">PgpSignAs</a>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  </div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <a class="code" href="pgpinvoke_8c.html#a3d4c8886e5a525a8a898c99f600c7ce6">mutt_pgp_command</a> (cmd, <span class="keyword">sizeof</span> (cmd), &amp;cctx, <a class="code" href="globals_8h.html#adcd4bfc434396ef0bd7053eaec238cbf">PgpImportCommand</a>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="protos_8h.html#a824e27c329552db25396e47110e45e73">mutt_system</a> (cmd);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#aa0b55876458e942aa84656afb8069724">  279</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="pgpinvoke_8c.html#aa0b55876458e942aa84656afb8069724">pgp_invoke_getkeys</a> (<a class="code" href="structADDRESS.html">ADDRESS</a> *addr)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordtype">char</span> buff[<a class="code" href="dotlock_8c.html#a2ed4d73ac96556fca2623216ca4a4e4a">LONG_STRING</a>];</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordtype">char</span> tmp[<a class="code" href="dotlock_8c.html#a2ed4d73ac96556fca2623216ca4a4e4a">LONG_STRING</a>];</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordtype">char</span> cmd[<a class="code" href="lib_8h.html#a311ef6df9e7e4907c467d815ee8a20b2">HUGE_STRING</a>];</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordtype">int</span> devnull;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordtype">char</span> *personal;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  </div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keyword">struct </span><a class="code" href="structpgp__command__context.html">pgp_command_context</a> cctx;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="globals_8h.html#a43e10f1ad0072f669dd58e20af8e777e">PgpGetkeysCommand</a>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  </div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="protos_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (&amp;cctx, 0, <span class="keyword">sizeof</span> (cctx));</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  personal = addr-&gt;<a class="code" href="structADDRESS.html#ac9da83650b2a5edb9999ff860f3b893d">personal</a>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  addr-&gt;<a class="code" href="structADDRESS.html#ac9da83650b2a5edb9999ff860f3b893d">personal</a> = <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  </div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  *tmp = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <a class="code" href="mutt__idna_8c.html#a5c4717533f3e89f64a7486456b721e4b">mutt_addrlist_to_local</a> (addr);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="rfc822_8c.html#ae18c5d69a0d4eefcbca158833035320e">rfc822_write_address_single</a> (tmp, <span class="keyword">sizeof</span> (tmp), addr, 0);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="lib_8c.html#a103326f37296f71ab471ea2aa14130b4">mutt_quote_filename</a> (buff, <span class="keyword">sizeof</span> (buff), tmp);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  addr-&gt;<a class="code" href="structADDRESS.html#ac9da83650b2a5edb9999ff860f3b893d">personal</a> = personal;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  </div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  cctx.<a class="code" href="structpgp__command__context.html#a24d99e7907a4c8b545c7c21367bb6f94">ids</a> = buff;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  </div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="code" href="pgpinvoke_8c.html#a3d4c8886e5a525a8a898c99f600c7ce6">mutt_pgp_command</a> (cmd, <span class="keyword">sizeof</span> (cmd), &amp;cctx, <a class="code" href="globals_8h.html#a43e10f1ad0072f669dd58e20af8e777e">PgpGetkeysCommand</a>);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  devnull = open (<span class="stringliteral">&quot;/dev/null&quot;</span>, O_RDWR);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="mutt__curses_8h.html#a3b0eecdf610c248824c3cdf71113e77e">isendwin</a> ()) <a class="code" href="globals_8h.html#a6021755edce63ab9d4e49f97213e83ab">mutt_message</a>  <a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Fetching PGP key...&quot;</span>);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <a class="code" href="protos_8h.html#a824e27c329552db25396e47110e45e73">mutt_system</a> (cmd);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="mutt__curses_8h.html#a3b0eecdf610c248824c3cdf71113e77e">isendwin</a> ()) <a class="code" href="curs__lib_8c.html#af068b3f524a31fad293b2fb61dfc4534">mutt_clear_error</a> ();</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  close (devnull);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;}</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#a6a768990340e1d8bedb0a61890c319cd">  319</a></span>&#160;pid_t <a class="code" href="pgpinvoke_8c.html#a6a768990340e1d8bedb0a61890c319cd">pgp_invoke_export</a> (FILE **pgpin, FILE **pgpout, FILE **pgperr,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                         <span class="keywordtype">int</span> pgpinfd, <span class="keywordtype">int</span> pgpoutfd, <span class="keywordtype">int</span> pgperrfd, </div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">char</span> *uids)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;{</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">pgp_invoke</a> (pgpin, pgpout, pgperr, pgpinfd, pgpoutfd, pgperrfd,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                     0, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="globals_8h.html#ada647458b3fb420ea7990fb9019440cd">PgpSignAs</a>, uids,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                     <a class="code" href="globals_8h.html#ad1a1cac28283978558ca1ac3661c9ac1">PgpExportCommand</a>);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#a7e95a69a07712c2d453ba2e5043d9677">  328</a></span>&#160;pid_t <a class="code" href="pgpinvoke_8c.html#a7e95a69a07712c2d453ba2e5043d9677">pgp_invoke_verify_key</a> (FILE **pgpin, FILE **pgpout, FILE **pgperr,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                             <span class="keywordtype">int</span> pgpinfd, <span class="keywordtype">int</span> pgpoutfd, <span class="keywordtype">int</span> pgperrfd, </div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">char</span> *uids)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;{</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">pgp_invoke</a> (pgpin, pgpout, pgperr, pgpinfd, pgpoutfd, pgperrfd,</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                     0, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="globals_8h.html#ada647458b3fb420ea7990fb9019440cd">PgpSignAs</a>, uids,</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                     <a class="code" href="globals_8h.html#aab0890a735382ff68865f39412fbcb15">PgpVerifyKeyCommand</a>);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="pgpinvoke_8c.html#a6ad29b75d425ed4996220bcdd7c2ab55">  337</a></span>&#160;pid_t <a class="code" href="pgpinvoke_8c.html#a6ad29b75d425ed4996220bcdd7c2ab55">pgp_invoke_list_keys</a> (FILE **pgpin, FILE **pgpout, FILE **pgperr,</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                            <span class="keywordtype">int</span> pgpinfd, <span class="keywordtype">int</span> pgpoutfd, <span class="keywordtype">int</span> pgperrfd, </div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                            <a class="code" href="mutt__crypt_8h.html#af31edd33e9040c838fac94aad916de4a">pgp_ring_t</a> keyring, <a class="code" href="structLIST.html">LIST</a> *hints)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;{</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordtype">char</span> uids[<a class="code" href="lib_8h.html#a311ef6df9e7e4907c467d815ee8a20b2">HUGE_STRING</a>];</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordtype">char</span> tmpuids[<a class="code" href="lib_8h.html#a311ef6df9e7e4907c467d815ee8a20b2">HUGE_STRING</a>];</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordtype">char</span> quoted[<a class="code" href="lib_8h.html#a311ef6df9e7e4907c467d815ee8a20b2">HUGE_STRING</a>];</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  </div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  *uids = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  </div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">for</span> (; hints; hints = hints-&gt;<a class="code" href="structLIST.html#a42719f561e09dc22e2d35d3d22fea181">next</a>)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="lib_8c.html#a103326f37296f71ab471ea2aa14130b4">mutt_quote_filename</a> (quoted, <span class="keyword">sizeof</span> (quoted), (<span class="keywordtype">char</span> *) hints-&gt;<a class="code" href="structLIST.html#a019e6cd242e6e2fdeb328c84bd6f6232">data</a>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (tmpuids, <span class="keyword">sizeof</span> (tmpuids), <span class="stringliteral">&quot;%s %s&quot;</span>, uids, quoted);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    strcpy (uids, tmpuids);     <span class="comment">/* __STRCPY_CHECKED__ */</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">pgp_invoke</a> (pgpin, pgpout, pgperr, pgpinfd, pgpoutfd, pgperrfd,</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                     0, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="globals_8h.html#ada647458b3fb420ea7990fb9019440cd">PgpSignAs</a>, uids,</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                     keyring == <a class="code" href="mutt__crypt_8h.html#a63661fdaf28901ab532e80373d2ce43caa5373b6a24d97bcf45a1acc335a8b35f">PGP_SECRING</a> ? <a class="code" href="globals_8h.html#a9296c257f670c3d85f5dd6f708078a93">PgpListSecringCommand</a> :</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                     <a class="code" href="globals_8h.html#afff1847a45a2bdb6e2e1ecc8ececbaf5">PgpListPubringCommand</a>);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div><div class="ttc" id="mutt__curses_8h_html"><div class="ttname"><a href="mutt__curses_8h.html">mutt_curses.h</a></div></div>
<div class="ttc" id="explodename_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="explodename_8c_source.html#l00034">explodename.c:34</a></div></div>
<div class="ttc" id="globals_8h_html_abc35c3ba17b01b18e5c3b353a93b79aa"><div class="ttname"><a href="globals_8h.html#abc35c3ba17b01b18e5c3b353a93b79aa">PgpDecryptCommand</a></div><div class="ttdeci">WHERE char * PgpDecryptCommand</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00283">globals.h:283</a></div></div>
<div class="ttc" id="lib_8h_html_a5c75177122494450ca7234a1f4048711"><div class="ttname"><a href="lib_8h.html#a5c75177122494450ca7234a1f4048711">dprint</a></div><div class="ttdeci">#define dprint(N, X)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00152">lib.h:152</a></div></div>
<div class="ttc" id="structLIST_html_a019e6cd242e6e2fdeb328c84bd6f6232"><div class="ttname"><a href="structLIST.html#a019e6cd242e6e2fdeb328c84bd6f6232">LIST::data</a></div><div class="ttdeci">char * data</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00635">mutt.h:635</a></div></div>
<div class="ttc" id="lib_8c_html_a103326f37296f71ab471ea2aa14130b4"><div class="ttname"><a href="lib_8c.html#a103326f37296f71ab471ea2aa14130b4">mutt_quote_filename</a></div><div class="ttdeci">size_t mutt_quote_filename(char *d, size_t l, const char *f)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00856">lib.c:856</a></div></div>
<div class="ttc" id="structpgp__command__context_html_ae14ae4ce3db686b47d7c21266e512e0a"><div class="ttname"><a href="structpgp__command__context.html#ae14ae4ce3db686b47d7c21266e512e0a">pgp_command_context::sig_fname</a></div><div class="ttdeci">const char * sig_fname</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00053">pgpinvoke.c:53</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_a6a768990340e1d8bedb0a61890c319cd"><div class="ttname"><a href="pgpinvoke_8c.html#a6a768990340e1d8bedb0a61890c319cd">pgp_invoke_export</a></div><div class="ttdeci">pid_t pgp_invoke_export(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd, int pgpoutfd, int pgperrfd, const char *uids)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00319">pgpinvoke.c:319</a></div></div>
<div class="ttc" id="structpgp__command__context_html_a24d99e7907a4c8b545c7c21367bb6f94"><div class="ttname"><a href="structpgp__command__context.html#a24d99e7907a4c8b545c7c21367bb6f94">pgp_command_context::ids</a></div><div class="ttdeci">const char * ids</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00055">pgpinvoke.c:55</a></div></div>
<div class="ttc" id="structLIST_html_a42719f561e09dc22e2d35d3d22fea181"><div class="ttname"><a href="structLIST.html#a42719f561e09dc22e2d35d3d22fea181">LIST::next</a></div><div class="ttdeci">struct list_t * next</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00636">mutt.h:636</a></div></div>
<div class="ttc" id="mutt_8h_html_a9498724ab6e4b2d35b96c492374513ae"><div class="ttname"><a href="mutt_8h.html#a9498724ab6e4b2d35b96c492374513ae">format_flag</a></div><div class="ttdeci">format_flag</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00137">mutt.h:137</a></div></div>
<div class="ttc" id="mutt__crypt_8h_html_a9576d2d6eb782d532607bac077e87892"><div class="ttname"><a href="mutt__crypt_8h.html#a9576d2d6eb782d532607bac077e87892">SIGN</a></div><div class="ttdeci">#define SIGN</div><div class="ttdef"><b>Definition:</b> <a href="mutt__crypt_8h_source.html#l00035">mutt_crypt.h:35</a></div></div>
<div class="ttc" id="mutt__curses_8h_html_a3b0eecdf610c248824c3cdf71113e77e"><div class="ttname"><a href="mutt__curses_8h.html#a3b0eecdf610c248824c3cdf71113e77e">isendwin</a></div><div class="ttdeci">int isendwin()</div></div>
<div class="ttc" id="protos_8h_html_a824e27c329552db25396e47110e45e73"><div class="ttname"><a href="protos_8h.html#a824e27c329552db25396e47110e45e73">mutt_system</a></div><div class="ttdeci">#define mutt_system(x)</div><div class="ttdef"><b>Definition:</b> <a href="protos_8h_source.html#l00058">protos.h:58</a></div></div>
<div class="ttc" id="mutt_8h_html_a9498724ab6e4b2d35b96c492374513aeaf2d8536087d5168ce24d2aa7e71823cb"><div class="ttname"><a href="mutt_8h.html#a9498724ab6e4b2d35b96c492374513aeaf2d8536087d5168ce24d2aa7e71823cb">MUTT_FORMAT_OPTIONAL</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00142">mutt.h:142</a></div></div>
<div class="ttc" id="globals_8h_html_a0685f74bf825069af21d49ba3dc93524"><div class="ttname"><a href="globals_8h.html#a0685f74bf825069af21d49ba3dc93524">PgpEncryptSignCommand</a></div><div class="ttdeci">WHERE char * PgpEncryptSignCommand</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00285">globals.h:285</a></div></div>
<div class="ttc" id="mutt__idna_8h_html"><div class="ttname"><a href="mutt__idna_8h.html">mutt_idna.h</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_abde452feebcf67086ff8152d75dbd20b"><div class="ttname"><a href="pgpinvoke_8c.html#abde452feebcf67086ff8152d75dbd20b">pgp_invoke_encrypt</a></div><div class="ttdeci">pid_t pgp_invoke_encrypt(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd, int pgpoutfd, int pgperrfd, const char *fname, const char *uids, int sign)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00234">pgpinvoke.c:234</a></div></div>
<div class="ttc" id="mutt_8h_html"><div class="ttname"><a href="mutt_8h.html">mutt.h</a></div></div>
<div class="ttc" id="globals_8h_html_a6538b74305df01c996f002fbd113cf43"><div class="ttname"><a href="globals_8h.html#a6538b74305df01c996f002fbd113cf43">PgpClearSignCommand</a></div><div class="ttdeci">WHERE char * PgpClearSignCommand</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00280">globals.h:280</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_aa0b55876458e942aa84656afb8069724"><div class="ttname"><a href="pgpinvoke_8c.html#aa0b55876458e942aa84656afb8069724">pgp_invoke_getkeys</a></div><div class="ttdeci">void pgp_invoke_getkeys(ADDRESS *addr)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00279">pgpinvoke.c:279</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_a8fe4ad1e92c87be40e03523299d3d0a0"><div class="ttname"><a href="pgpinvoke_8c.html#a8fe4ad1e92c87be40e03523299d3d0a0">pgp_invoke_verify</a></div><div class="ttdeci">pid_t pgp_invoke_verify(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd, int pgpoutfd, int pgperrfd, const char *fname, const char *sig_fname)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00209">pgpinvoke.c:209</a></div></div>
<div class="ttc" id="curs__lib_8c_html_af068b3f524a31fad293b2fb61dfc4534"><div class="ttname"><a href="curs__lib_8c.html#af068b3f524a31fad293b2fb61dfc4534">mutt_clear_error</a></div><div class="ttdeci">void mutt_clear_error(void)</div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00197">curs_lib.c:197</a></div></div>
<div class="ttc" id="dcigettext_8c_html_a45614b6d4dc532a7211d75e0aa18c964"><div class="ttname"><a href="dcigettext_8c.html#a45614b6d4dc532a7211d75e0aa18c964">_POSIX_PATH_MAX</a></div><div class="ttdeci">#define _POSIX_PATH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="dcigettext_8c_source.html#l00159">dcigettext.c:159</a></div></div>
<div class="ttc" id="mutt__crypt_8h_html_a63661fdaf28901ab532e80373d2ce43caa5373b6a24d97bcf45a1acc335a8b35f"><div class="ttname"><a href="mutt__crypt_8h.html#a63661fdaf28901ab532e80373d2ce43caa5373b6a24d97bcf45a1acc335a8b35f">PGP_SECRING</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt__crypt_8h_source.html#l00099">mutt_crypt.h:99</a></div></div>
<div class="ttc" id="globals_8h_html_ada647458b3fb420ea7990fb9019440cd"><div class="ttname"><a href="globals_8h.html#ada647458b3fb420ea7990fb9019440cd">PgpSignAs</a></div><div class="ttdeci">WHERE char * PgpSignAs</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00277">globals.h:277</a></div></div>
<div class="ttc" id="globals_8h_html_a258cb9827d9b0b16bbcf324cf7f66d8f"><div class="ttname"><a href="globals_8h.html#a258cb9827d9b0b16bbcf324cf7f66d8f">PgpDecodeCommand</a></div><div class="ttdeci">WHERE char * PgpDecodeCommand</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00281">globals.h:281</a></div></div>
<div class="ttc" id="muttlib_8c_html_a8f68fc734dc58779cfabcfbb2d547602"><div class="ttname"><a href="muttlib_8c.html#a8f68fc734dc58779cfabcfbb2d547602">mutt_FormatString</a></div><div class="ttdeci">void mutt_FormatString(char *dest, size_t destlen, size_t col, int cols, const char *src, format_t *callback, unsigned long data, format_flag flags)</div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8c_source.html#l01186">muttlib.c:1186</a></div></div>
<div class="ttc" id="globals_8h_html_a954e6dfb93392d38a80ee1e98266855d"><div class="ttname"><a href="globals_8h.html#a954e6dfb93392d38a80ee1e98266855d">PgpVerifyCommand</a></div><div class="ttdeci">WHERE char * PgpVerifyCommand</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00282">globals.h:282</a></div></div>
<div class="ttc" id="mutt__crypt_8h_html_af31edd33e9040c838fac94aad916de4a"><div class="ttname"><a href="mutt__crypt_8h.html#af31edd33e9040c838fac94aad916de4a">pgp_ring_t</a></div><div class="ttdeci">enum pgp_ring pgp_ring_t</div><div class="ttdef"><b>Definition:</b> <a href="mutt__crypt_8h_source.html#l00101">mutt_crypt.h:101</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_a6ad29b75d425ed4996220bcdd7c2ab55"><div class="ttname"><a href="pgpinvoke_8c.html#a6ad29b75d425ed4996220bcdd7c2ab55">pgp_invoke_list_keys</a></div><div class="ttdeci">pid_t pgp_invoke_list_keys(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd, int pgpoutfd, int pgperrfd, pgp_ring_t keyring, LIST *hints)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00337">pgpinvoke.c:337</a></div></div>
<div class="ttc" id="curs__lib_8c_html_afd19d94fefe1f3e10bd6f2e3564bb005"><div class="ttname"><a href="curs__lib_8c.html#afd19d94fefe1f3e10bd6f2e3564bb005">MuttIndexWindow</a></div><div class="ttdeci">mutt_window_t * MuttIndexWindow</div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00074">curs_lib.c:74</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_a69c5206ee17a28dc7fbebce99e41c4cf"><div class="ttname"><a href="pgpinvoke_8c.html#a69c5206ee17a28dc7fbebce99e41c4cf">pgp_invoke</a></div><div class="ttdeci">static pid_t pgp_invoke(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd, int pgpoutfd, int pgperrfd, short need_passphrase, const char *fname, const char *sig_fname, const char *signas, const char *ids, const char *format)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00162">pgpinvoke.c:162</a></div></div>
<div class="ttc" id="rfc822_8h_html"><div class="ttname"><a href="rfc822_8h.html">rfc822.h</a></div></div>
<div class="ttc" id="globals_8h_html_ad1a1cac28283978558ca1ac3661c9ac1"><div class="ttname"><a href="globals_8h.html#ad1a1cac28283978558ca1ac3661c9ac1">PgpExportCommand</a></div><div class="ttdeci">WHERE char * PgpExportCommand</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00288">globals.h:288</a></div></div>
<div class="ttc" id="structpgp__command__context_html_a2dd8c0b313a19702e786598dff3c165a"><div class="ttname"><a href="structpgp__command__context.html#a2dd8c0b313a19702e786598dff3c165a">pgp_command_context::need_passphrase</a></div><div class="ttdeci">short need_passphrase</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00051">pgpinvoke.c:51</a></div></div>
<div class="ttc" id="structmutt__window__t_html_a6899cc51ad027005177c1d2835bce781"><div class="ttname"><a href="structmutt__window__t.html#a6899cc51ad027005177c1d2835bce781">mutt_window_t::cols</a></div><div class="ttdeci">int cols</div><div class="ttdef"><b>Definition:</b> <a href="mutt__curses_8h_source.html#l00183">mutt_curses.h:183</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_a3d4c8886e5a525a8a898c99f600c7ce6"><div class="ttname"><a href="pgpinvoke_8c.html#a3d4c8886e5a525a8a898c99f600c7ce6">mutt_pgp_command</a></div><div class="ttdeci">void mutt_pgp_command(char *d, size_t dlen, struct pgp_command_context *cctx, const char *fmt)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00151">pgpinvoke.c:151</a></div></div>
<div class="ttc" id="structpgp__command__context_html_a00fbb8c8d4ad55fd6938768ee6faed9b"><div class="ttname"><a href="structpgp__command__context.html#a00fbb8c8d4ad55fd6938768ee6faed9b">pgp_command_context::signas</a></div><div class="ttdeci">const char * signas</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00054">pgpinvoke.c:54</a></div></div>
<div class="ttc" id="lib_8h_html_a7e0481bed27661ea2679f256b24e0283"><div class="ttname"><a href="lib_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a></div><div class="ttdeci">#define NONULL(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00078">lib.h:78</a></div></div>
<div class="ttc" id="pgp_8h_html"><div class="ttname"><a href="pgp_8h.html">pgp.h</a></div></div>
<div class="ttc" id="globals_8h_html_adcd4bfc434396ef0bd7053eaec238cbf"><div class="ttname"><a href="globals_8h.html#adcd4bfc434396ef0bd7053eaec238cbf">PgpImportCommand</a></div><div class="ttdeci">WHERE char * PgpImportCommand</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00287">globals.h:287</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_ae4b72b2e4706ac9624cdd50fad5844e7"><div class="ttname"><a href="pgpinvoke_8c.html#ae4b72b2e4706ac9624cdd50fad5844e7">_mutt_fmt_pgp_command</a></div><div class="ttdeci">const char * _mutt_fmt_pgp_command(char *dest, size_t destlen, size_t col, int cols, char op, const char *src, const char *prefix, const char *ifstring, const char *elsestring, unsigned long data, format_flag flags)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00059">pgpinvoke.c:59</a></div></div>
<div class="ttc" id="globals_8h_html_a6021755edce63ab9d4e49f97213e83ab"><div class="ttname"><a href="globals_8h.html#a6021755edce63ab9d4e49f97213e83ab">mutt_message</a></div><div class="ttdeci">WHERE void(* mutt_message)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00020">globals.h:20</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_ac7dd71aa84bcd3b0a92ff90c59305b9d"><div class="ttname"><a href="pgpinvoke_8c.html#ac7dd71aa84bcd3b0a92ff90c59305b9d">pgp_invoke_import</a></div><div class="ttdeci">void pgp_invoke_import(const char *fname)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00263">pgpinvoke.c:263</a></div></div>
<div class="ttc" id="structpgp__command__context_html_a4b7b8aebf925a078121111cc0278d5e3"><div class="ttname"><a href="structpgp__command__context.html#a4b7b8aebf925a078121111cc0278d5e3">pgp_command_context::fname</a></div><div class="ttdeci">const char * fname</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00052">pgpinvoke.c:52</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_a7e95a69a07712c2d453ba2e5043d9677"><div class="ttname"><a href="pgpinvoke_8c.html#a7e95a69a07712c2d453ba2e5043d9677">pgp_invoke_verify_key</a></div><div class="ttdeci">pid_t pgp_invoke_verify_key(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd, int pgpoutfd, int pgperrfd, const char *uids)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00328">pgpinvoke.c:328</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="globals_8h_html_a56ceb2330854735cf9878e515983fa93"><div class="ttname"><a href="globals_8h.html#a56ceb2330854735cf9878e515983fa93">PgpEncryptOnlyCommand</a></div><div class="ttdeci">WHERE char * PgpEncryptOnlyCommand</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00286">globals.h:286</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_ae5bab436b25e622a2163ef2a5f7977da"><div class="ttname"><a href="pgpinvoke_8c.html#ae5bab436b25e622a2163ef2a5f7977da">pgp_invoke_decrypt</a></div><div class="ttdeci">pid_t pgp_invoke_decrypt(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd, int pgpoutfd, int pgperrfd, const char *fname)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00217">pgpinvoke.c:217</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_a5d8f983a20fcc1b2d1dbf4c94d774a4f"><div class="ttname"><a href="pgpinvoke_8c.html#a5d8f983a20fcc1b2d1dbf4c94d774a4f">pgp_invoke_traditional</a></div><div class="ttdeci">pid_t pgp_invoke_traditional(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd, int pgpoutfd, int pgperrfd, const char *fname, const char *uids, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00248">pgpinvoke.c:248</a></div></div>
<div class="ttc" id="structADDRESS_html"><div class="ttname"><a href="structADDRESS.html">ADDRESS</a></div><div class="ttdef"><b>Definition:</b> <a href="rfc822_8h_source.html#l00036">rfc822.h:36</a></div></div>
<div class="ttc" id="dotlock_8c_html_a357a42eb6494ea592e9c3f96c55cebe2"><div class="ttname"><a href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a></div><div class="ttdeci">int snprintf(char *, size_t, const char *,...)</div></div>
<div class="ttc" id="structLIST_html"><div class="ttname"><a href="structLIST.html">LIST</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00633">mutt.h:633</a></div></div>
<div class="ttc" id="pgp_8c_html_aaf433b0e23f81682f4911f5712e10051"><div class="ttname"><a href="pgp_8c.html#aaf433b0e23f81682f4911f5712e10051">pgp_use_gpg_agent</a></div><div class="ttdeci">int pgp_use_gpg_agent(void)</div><div class="ttdef"><b>Definition:</b> <a href="pgp_8c_source.html#l00108">pgp.c:108</a></div></div>
<div class="ttc" id="mutt__crypt_8h_html_a1cb0c60ca582db30ae87362ca43e8c19"><div class="ttname"><a href="mutt__crypt_8h.html#a1cb0c60ca582db30ae87362ca43e8c19">ENCRYPT</a></div><div class="ttdeci">#define ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="mutt__crypt_8h_source.html#l00034">mutt_crypt.h:34</a></div></div>
<div class="ttc" id="globals_8h_html_a9296c257f670c3d85f5dd6f708078a93"><div class="ttname"><a href="globals_8h.html#a9296c257f670c3d85f5dd6f708078a93">PgpListSecringCommand</a></div><div class="ttdeci">WHERE char * PgpListSecringCommand</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00290">globals.h:290</a></div></div>
<div class="ttc" id="dotlock_8c_html_a2ed4d73ac96556fca2623216ca4a4e4a"><div class="ttname"><a href="dotlock_8c.html#a2ed4d73ac96556fca2623216ca4a4e4a">LONG_STRING</a></div><div class="ttdeci">#define LONG_STRING</div><div class="ttdef"><b>Definition:</b> <a href="dotlock_8c_source.html#l00063">dotlock.c:63</a></div></div>
<div class="ttc" id="globals_8h_html_a43e10f1ad0072f669dd58e20af8e777e"><div class="ttname"><a href="globals_8h.html#a43e10f1ad0072f669dd58e20af8e777e">PgpGetkeysCommand</a></div><div class="ttdeci">WHERE char * PgpGetkeysCommand</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00292">globals.h:292</a></div></div>
<div class="ttc" id="structpgp__command__context_html"><div class="ttname"><a href="structpgp__command__context.html">pgp_command_context</a></div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00050">pgpinvoke.c:50</a></div></div>
<div class="ttc" id="lib_8h_html_a311ef6df9e7e4907c467d815ee8a20b2"><div class="ttname"><a href="lib_8h.html#a311ef6df9e7e4907c467d815ee8a20b2">HUGE_STRING</a></div><div class="ttdeci">#define HUGE_STRING</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00060">lib.h:60</a></div></div>
<div class="ttc" id="filter_8c_html_ac11a676d3f214c21cf70e360002757ec"><div class="ttname"><a href="filter_8c.html#ac11a676d3f214c21cf70e360002757ec">mutt_create_filter_fd</a></div><div class="ttdeci">pid_t mutt_create_filter_fd(const char *cmd, FILE **in, FILE **out, FILE **err, int fdin, int fdout, int fderr)</div><div class="ttdef"><b>Definition:</b> <a href="filter_8c_source.html#l00034">filter.c:34</a></div></div>
<div class="ttc" id="lib_8h_html_a1f35aabd376e7d34b1900d9caae1715f"><div class="ttname"><a href="lib_8h.html#a1f35aabd376e7d34b1900d9caae1715f">SHORT_STRING</a></div><div class="ttdeci">#define SHORT_STRING</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00063">lib.h:63</a></div></div>
<div class="ttc" id="rfc822_8c_html_ae18c5d69a0d4eefcbca158833035320e"><div class="ttname"><a href="rfc822_8c.html#ae18c5d69a0d4eefcbca158833035320e">rfc822_write_address_single</a></div><div class="ttdeci">void rfc822_write_address_single(char *buf, size_t buflen, ADDRESS *addr, int display)</div><div class="ttdef"><b>Definition:</b> <a href="rfc822_8c_source.html#l00600">rfc822.c:600</a></div></div>
<div class="ttc" id="structADDRESS_html_ac9da83650b2a5edb9999ff860f3b893d"><div class="ttname"><a href="structADDRESS.html#ac9da83650b2a5edb9999ff860f3b893d">ADDRESS::personal</a></div><div class="ttdeci">char * personal</div><div class="ttdef"><b>Definition:</b> <a href="rfc822_8h_source.html#l00041">rfc822.h:41</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_a18b48d492a005f8baa81e8ca5ffd6ab4"><div class="ttname"><a href="pgpinvoke_8c.html#a18b48d492a005f8baa81e8ca5ffd6ab4">pgp_invoke_sign</a></div><div class="ttdeci">pid_t pgp_invoke_sign(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd, int pgpoutfd, int pgperrfd, const char *fname)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00225">pgpinvoke.c:225</a></div></div>
<div class="ttc" id="mutt__idna_8c_html_a5c4717533f3e89f64a7486456b721e4b"><div class="ttname"><a href="mutt__idna_8c.html#a5c4717533f3e89f64a7486456b721e4b">mutt_addrlist_to_local</a></div><div class="ttdeci">int mutt_addrlist_to_local(ADDRESS *a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__idna_8c_source.html#l00260">mutt_idna.c:260</a></div></div>
<div class="ttc" id="pgpinvoke_8c_html_af4efc98585839254ef198fc11bfaef1a"><div class="ttname"><a href="pgpinvoke_8c.html#af4efc98585839254ef198fc11bfaef1a">pgp_invoke_decode</a></div><div class="ttdeci">pid_t pgp_invoke_decode(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd, int pgpoutfd, int pgperrfd, const char *fname, short need_passphrase)</div><div class="ttdef"><b>Definition:</b> <a href="pgpinvoke_8c_source.html#l00200">pgpinvoke.c:200</a></div></div>
<div class="ttc" id="globals_8h_html_afff1847a45a2bdb6e2e1ecc8ececbaf5"><div class="ttname"><a href="globals_8h.html#afff1847a45a2bdb6e2e1ecc8ececbaf5">PgpListPubringCommand</a></div><div class="ttdeci">WHERE char * PgpListPubringCommand</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00291">globals.h:291</a></div></div>
<div class="ttc" id="globals_8h_html_a417d69f294dd0da964b3e92a4c153880"><div class="ttname"><a href="globals_8h.html#a417d69f294dd0da964b3e92a4c153880">PgpSignCommand</a></div><div class="ttdeci">WHERE char * PgpSignCommand</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00284">globals.h:284</a></div></div>
<div class="ttc" id="globals_8h_html_aab0890a735382ff68865f39412fbcb15"><div class="ttname"><a href="globals_8h.html#aab0890a735382ff68865f39412fbcb15">PgpVerifyKeyCommand</a></div><div class="ttdeci">WHERE char * PgpVerifyKeyCommand</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00289">globals.h:289</a></div></div>
<div class="ttc" id="protos_8h_html_adb03df3679ce1445e801310614624ccb"><div class="ttname"><a href="protos_8h.html#adb03df3679ce1445e801310614624ccb">memset</a></div><div class="ttdeci">void * memset()</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
