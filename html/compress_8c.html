<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: compress.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mutt.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">1.7.1</span>
   </div>
   <div id="projectbrief">Mail Reader</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">compress.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &quot;<a class="el" href="mutt_8h_source.html">mutt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mailbox_8h_source.html">mailbox.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mutt__curses_8h_source.html">mutt_curses.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mx_8h_source.html">mx.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="compress_8h_source.html">compress.h</a>&quot;</code><br />
</div>
<p><a href="compress_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Private data for compress.  <a href="structCOMPRESS__INFO.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afe8cd0103ee2736842782ff97d3cf300"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#afe8cd0103ee2736842782ff97d3cf300">lock_realpath</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx, int excl)</td></tr>
<tr class="memdesc:afe8cd0103ee2736842782ff97d3cf300"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to lock the ctx-&gt;realpath : Mailbox to lock : Lock exclusively?  <a href="#afe8cd0103ee2736842782ff97d3cf300">More...</a><br /></td></tr>
<tr class="separator:afe8cd0103ee2736842782ff97d3cf300"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad02e220bbca8247f9b048092a07074bb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#ad02e220bbca8247f9b048092a07074bb">unlock_realpath</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx)</td></tr>
<tr class="memdesc:ad02e220bbca8247f9b048092a07074bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlock the ctx-&gt;realpath : Mailbox to unlock.  <a href="#ad02e220bbca8247f9b048092a07074bb">More...</a><br /></td></tr>
<tr class="separator:ad02e220bbca8247f9b048092a07074bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a804b29dcfdfaf4eb8a5ebfb7cb4213c8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a804b29dcfdfaf4eb8a5ebfb7cb4213c8">setup_paths</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx)</td></tr>
<tr class="memdesc:a804b29dcfdfaf4eb8a5ebfb7cb4213c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the mailbox paths : Mailbox to modify.  <a href="#a804b29dcfdfaf4eb8a5ebfb7cb4213c8">More...</a><br /></td></tr>
<tr class="separator:a804b29dcfdfaf4eb8a5ebfb7cb4213c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef351258938e8f659c65e9e925bf3ef2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#aef351258938e8f659c65e9e925bf3ef2">get_size</a> (<a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *path)</td></tr>
<tr class="memdesc:aef351258938e8f659c65e9e925bf3ef2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the size of a file : File to measure.  <a href="#aef351258938e8f659c65e9e925bf3ef2">More...</a><br /></td></tr>
<tr class="separator:aef351258938e8f659c65e9e925bf3ef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66135b1e3433cc07352b16bd8463db74"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a66135b1e3433cc07352b16bd8463db74">store_size</a> (<a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx)</td></tr>
<tr class="memdesc:a66135b1e3433cc07352b16bd8463db74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the size of the compressed file : Mailbox.  <a href="#a66135b1e3433cc07352b16bd8463db74">More...</a><br /></td></tr>
<tr class="separator:a66135b1e3433cc07352b16bd8463db74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43803535152ad5c75657dbc93b036786"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a43803535152ad5c75657dbc93b036786">find_hook</a> (int type, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *path)</td></tr>
<tr class="memdesc:a43803535152ad5c75657dbc93b036786"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find a hook to match a path : Type of hook, e.g.  <a href="#a43803535152ad5c75657dbc93b036786">More...</a><br /></td></tr>
<tr class="separator:a43803535152ad5c75657dbc93b036786"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a909545bed7377d2c98b787ef173162cc"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a909545bed7377d2c98b787ef173162cc">set_compress_info</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx)</td></tr>
<tr class="memdesc:a909545bed7377d2c98b787ef173162cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the compress hooks for a mailbox : Mailbox to examine.  <a href="#a909545bed7377d2c98b787ef173162cc">More...</a><br /></td></tr>
<tr class="separator:a909545bed7377d2c98b787ef173162cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97b329171e49a0fc29f030bca2cda467"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a97b329171e49a0fc29f030bca2cda467">mutt_free_compress_info</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx)</td></tr>
<tr class="memdesc:a97b329171e49a0fc29f030bca2cda467"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees the compress info members and structure.  <a href="#a97b329171e49a0fc29f030bca2cda467">More...</a><br /></td></tr>
<tr class="separator:a97b329171e49a0fc29f030bca2cda467"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1b0f0a971423299d997e242128b425f"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#ae1b0f0a971423299d997e242128b425f">escape_path</a> (char *src)</td></tr>
<tr class="memdesc:ae1b0f0a971423299d997e242128b425f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Escapes single quotes in a path for a command string.  <a href="#ae1b0f0a971423299d997e242128b425f">More...</a><br /></td></tr>
<tr class="separator:ae1b0f0a971423299d997e242128b425f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0389489fc84dd74952cc102477d4078"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#af0389489fc84dd74952cc102477d4078">cb_format_str</a> (char *dest, size_t destlen, size_t col, int cols, char op, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *src, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *fmt, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *ifstring, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *elsestring, unsigned long data, <a class="el" href="mutt_8h.html#a9498724ab6e4b2d35b96c492374513ae">format_flag</a> flags)</td></tr>
<tr class="memdesc:af0389489fc84dd74952cc102477d4078"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand the filenames in the command string : Buffer in which to save string : Buffer length : Starting column, UNUSED : Number of screen columns, UNUSED : printf-like operator, e.g.  <a href="#af0389489fc84dd74952cc102477d4078">More...</a><br /></td></tr>
<tr class="separator:af0389489fc84dd74952cc102477d4078"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a650b796a0272b691aa27bed43e68b808"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a650b796a0272b691aa27bed43e68b808">expand_command_str</a> (<a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *cmd, char *buf, int buflen)</td></tr>
<tr class="memdesc:a650b796a0272b691aa27bed43e68b808"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand placeholders in command string : Mailbox for paths : Buffer to store the command : Size of the buffer.  <a href="#a650b796a0272b691aa27bed43e68b808">More...</a><br /></td></tr>
<tr class="separator:a650b796a0272b691aa27bed43e68b808"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9031d1b73f7ebb9b32878441bd7eedb2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a9031d1b73f7ebb9b32878441bd7eedb2">execute_command</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *command, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *progress)</td></tr>
<tr class="memdesc:a9031d1b73f7ebb9b32878441bd7eedb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run a system command : Mailbox to work with : Command string to execute : Message to show the user.  <a href="#a9031d1b73f7ebb9b32878441bd7eedb2">More...</a><br /></td></tr>
<tr class="separator:a9031d1b73f7ebb9b32878441bd7eedb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f58c5d1c5690258d1e44930d4bc7ed9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a3f58c5d1c5690258d1e44930d4bc7ed9">open_mailbox</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx)</td></tr>
<tr class="memdesc:a3f58c5d1c5690258d1e44930d4bc7ed9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open a compressed mailbox : Mailbox to open.  <a href="#a3f58c5d1c5690258d1e44930d4bc7ed9">More...</a><br /></td></tr>
<tr class="separator:a3f58c5d1c5690258d1e44930d4bc7ed9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ac021d4af3de65b7ca4de32af878ec2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a5ac021d4af3de65b7ca4de32af878ec2">open_append_mailbox</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx, int flags)</td></tr>
<tr class="memdesc:a5ac021d4af3de65b7ca4de32af878ec2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open a compressed mailbox for appending : Mailbox to open : e.g.  <a href="#a5ac021d4af3de65b7ca4de32af878ec2">More...</a><br /></td></tr>
<tr class="separator:a5ac021d4af3de65b7ca4de32af878ec2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1a2c2a59bce7cb7856db6011e0090fc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#ae1a2c2a59bce7cb7856db6011e0090fc">close_mailbox</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx)</td></tr>
<tr class="memdesc:ae1a2c2a59bce7cb7856db6011e0090fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close a compressed mailbox : Mailbox to close.  <a href="#ae1a2c2a59bce7cb7856db6011e0090fc">More...</a><br /></td></tr>
<tr class="separator:ae1a2c2a59bce7cb7856db6011e0090fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6babf155ed54215ecd27a93fae8fb45"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#ac6babf155ed54215ecd27a93fae8fb45">check_mailbox</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx, int *index_hint)</td></tr>
<tr class="memdesc:ac6babf155ed54215ecd27a93fae8fb45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for changes in the compressed file : Mailbox.  <a href="#ac6babf155ed54215ecd27a93fae8fb45">More...</a><br /></td></tr>
<tr class="separator:ac6babf155ed54215ecd27a93fae8fb45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5232331c813fe71f4ea930ec99101246"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a5232331c813fe71f4ea930ec99101246">open_message</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx, <a class="el" href="structMESSAGE.html">MESSAGE</a> *msg, int msgno)</td></tr>
<tr class="memdesc:a5232331c813fe71f4ea930ec99101246"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delegated to mbox handler.  <a href="#a5232331c813fe71f4ea930ec99101246">More...</a><br /></td></tr>
<tr class="separator:a5232331c813fe71f4ea930ec99101246"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87dfb73561a1ecd40ab143cc855a571a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a87dfb73561a1ecd40ab143cc855a571a">close_message</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx, <a class="el" href="structMESSAGE.html">MESSAGE</a> *msg)</td></tr>
<tr class="memdesc:a87dfb73561a1ecd40ab143cc855a571a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delegated to mbox handler.  <a href="#a87dfb73561a1ecd40ab143cc855a571a">More...</a><br /></td></tr>
<tr class="separator:a87dfb73561a1ecd40ab143cc855a571a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b514370d6f708885d67bf537f8bb9f4"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a3b514370d6f708885d67bf537f8bb9f4">commit_message</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx, <a class="el" href="structMESSAGE.html">MESSAGE</a> *msg)</td></tr>
<tr class="memdesc:a3b514370d6f708885d67bf537f8bb9f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delegated to mbox handler.  <a href="#a3b514370d6f708885d67bf537f8bb9f4">More...</a><br /></td></tr>
<tr class="separator:a3b514370d6f708885d67bf537f8bb9f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60f6006c9ac04a68d73218dce2e13e98"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a60f6006c9ac04a68d73218dce2e13e98">open_new_message</a> (<a class="el" href="structMESSAGE.html">MESSAGE</a> *msg, <a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx, <a class="el" href="structHEADER.html">HEADER</a> *hdr)</td></tr>
<tr class="memdesc:a60f6006c9ac04a68d73218dce2e13e98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delegated to mbox handler.  <a href="#a60f6006c9ac04a68d73218dce2e13e98">More...</a><br /></td></tr>
<tr class="separator:a60f6006c9ac04a68d73218dce2e13e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a001813a1c455c618868239b9154487aa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a001813a1c455c618868239b9154487aa">mutt_comp_can_append</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx)</td></tr>
<tr class="memdesc:a001813a1c455c618868239b9154487aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Can we append to this path? : pathname of file to be tested.  <a href="#a001813a1c455c618868239b9154487aa">More...</a><br /></td></tr>
<tr class="separator:a001813a1c455c618868239b9154487aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a160490f9047fab7fc16837cab8992427"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a160490f9047fab7fc16837cab8992427">mutt_comp_can_read</a> (<a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *path)</td></tr>
<tr class="memdesc:a160490f9047fab7fc16837cab8992427"><td class="mdescLeft">&#160;</td><td class="mdescRight">Can we read from this file? : Pathname of file to be tested.  <a href="#a160490f9047fab7fc16837cab8992427">More...</a><br /></td></tr>
<tr class="separator:a160490f9047fab7fc16837cab8992427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab327914fd4d8b132c3ef4ec7680a484e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#ab327914fd4d8b132c3ef4ec7680a484e">sync_mailbox</a> (<a class="el" href="structCONTEXT.html">CONTEXT</a> *ctx, int *index_hint)</td></tr>
<tr class="memdesc:ab327914fd4d8b132c3ef4ec7680a484e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save changes to the compressed mailbox file : Mailbox to sync.  <a href="#ab327914fd4d8b132c3ef4ec7680a484e">More...</a><br /></td></tr>
<tr class="separator:ab327914fd4d8b132c3ef4ec7680a484e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab77ea42f102d3aced8ea915e95a83bd4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#ab77ea42f102d3aced8ea915e95a83bd4">mutt_comp_valid_command</a> (<a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *cmd)</td></tr>
<tr class="memdesc:ab77ea42f102d3aced8ea915e95a83bd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is this command string allowed? : Command string.  <a href="#ab77ea42f102d3aced8ea915e95a83bd4">More...</a><br /></td></tr>
<tr class="separator:ab77ea42f102d3aced8ea915e95a83bd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a42c0fbc4fb4b2d4fd495bc815271ca7d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structmx__ops.html">mx_ops</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="compress_8c.html#a42c0fbc4fb4b2d4fd495bc815271ca7d">mx_comp_ops</a></td></tr>
<tr class="memdesc:a42c0fbc4fb4b2d4fd495bc815271ca7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mailbox callback functions.  <a href="#a42c0fbc4fb4b2d4fd495bc815271ca7d">More...</a><br /></td></tr>
<tr class="separator:a42c0fbc4fb4b2d4fd495bc815271ca7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="afe8cd0103ee2736842782ff97d3cf300"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe8cd0103ee2736842782ff97d3cf300">&#9670;&nbsp;</a></span>lock_realpath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lock_realpath </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>excl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Try to lock the ctx-&gt;realpath : Mailbox to lock : Lock exclusively? </p>
<p>Try to (exclusively) lock the mailbox. If we succeed, then we mark the mailbox as locked. If we fail, but we didn't want exclusive rights, then the mailbox will be marked readonly.</p>
<p>Returns: 1: Success (locked or readonly) 0: Error (can't lock the file) </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00071">71</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">if</span> (!ctx)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">if</span> (!ci)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">if</span> (ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a2c21de6a5ffc32f55d51273b90b5d36f">locked</a>)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordflow">if</span> (excl)</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6c6e5e2693d2f21999e136926eefeba9">lockfp</a> = fopen (ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a>, <span class="stringliteral">&quot;a&quot;</span>);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6c6e5e2693d2f21999e136926eefeba9">lockfp</a> = fopen (ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a>, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">if</span> (!ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6c6e5e2693d2f21999e136926eefeba9">lockfp</a>)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="curs__lib_8c.html#a5cf1f13c15fb3a24b0222e7a033e4027">mutt_perror</a> (ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a>);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">int</span> r = <a class="code" href="mx_8c.html#a45cce8222f0ffe40536c8a8ea2a247e8">mx_lock_file</a> (ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a>, fileno (ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6c6e5e2693d2f21999e136926eefeba9">lockfp</a>), excl, 1, 1);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span> (r == 0)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a2c21de6a5ffc32f55d51273b90b5d36f">locked</a> = 1;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (excl == 0)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="lib_8c.html#af03da38defdb7d2ba4e9e517c3c54836">safe_fclose</a> (&amp;ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6c6e5e2693d2f21999e136926eefeba9">lockfp</a>);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    ctx-&gt;<a class="code" href="structCONTEXT.html#a53580c3479115ea0f00732ca8f5c55fa">readonly</a> = 1;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">return</span> (r == 0);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div><div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="mx_8c_html_a45cce8222f0ffe40536c8a8ea2a247e8"><div class="ttname"><a href="mx_8c.html#a45cce8222f0ffe40536c8a8ea2a247e8">mx_lock_file</a></div><div class="ttdeci">int mx_lock_file(const char *path, int fd, int excl, int dot, int timeout)</div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l00198">mx.c:198</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a2c21de6a5ffc32f55d51273b90b5d36f"><div class="ttname"><a href="structCOMPRESS__INFO.html#a2c21de6a5ffc32f55d51273b90b5d36f">COMPRESS_INFO::locked</a></div><div class="ttdeci">int locked</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00052">compress.c:52</a></div></div>
<div class="ttc" id="structCONTEXT_html_a53580c3479115ea0f00732ca8f5c55fa"><div class="ttname"><a href="structCONTEXT.html#a53580c3479115ea0f00732ca8f5c55fa">CONTEXT::readonly</a></div><div class="ttdeci">unsigned int readonly</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01042">mutt.h:1042</a></div></div>
<div class="ttc" id="lib_8c_html_af03da38defdb7d2ba4e9e517c3c54836"><div class="ttname"><a href="lib_8c.html#af03da38defdb7d2ba4e9e517c3c54836">safe_fclose</a></div><div class="ttdeci">int safe_fclose(FILE **f)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00203">lib.c:203</a></div></div>
<div class="ttc" id="structCONTEXT_html_aa33eac2793b011daf40590752dfb9ddc"><div class="ttname"><a href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">CONTEXT::realpath</a></div><div class="ttdeci">char * realpath</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01011">mutt.h:1011</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a6c6e5e2693d2f21999e136926eefeba9"><div class="ttname"><a href="structCOMPRESS__INFO.html#a6c6e5e2693d2f21999e136926eefeba9">COMPRESS_INFO::lockfp</a></div><div class="ttdeci">FILE * lockfp</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00053">compress.c:53</a></div></div>
<div class="ttc" id="curs__lib_8c_html_a5cf1f13c15fb3a24b0222e7a033e4027"><div class="ttname"><a href="curs__lib_8c.html#a5cf1f13c15fb3a24b0222e7a033e4027">mutt_perror</a></div><div class="ttdeci">void mutt_perror(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00742">curs_lib.c:742</a></div></div>
<div class="ttc" id="structCONTEXT_html_a97a63c10344e36eacb10be318022b198"><div class="ttname"><a href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">CONTEXT::compress_info</a></div><div class="ttdeci">void * compress_info</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01051">mutt.h:1051</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad02e220bbca8247f9b048092a07074bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad02e220bbca8247f9b048092a07074bb">&#9670;&nbsp;</a></span>unlock_realpath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void unlock_realpath </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unlock the ctx-&gt;realpath : Mailbox to unlock. </p>
<p>Unlock a mailbox previously locked by lock_mailbox(). </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00114">114</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;{</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">if</span> (!ctx)</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">if</span> (!ci)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span> (!ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a2c21de6a5ffc32f55d51273b90b5d36f">locked</a>)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="mx_8c.html#a8b783b797caf94ef300cb95fd278a273">mx_unlock_file</a> (ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a>, fileno (ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6c6e5e2693d2f21999e136926eefeba9">lockfp</a>), 1);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a2c21de6a5ffc32f55d51273b90b5d36f">locked</a> = 0;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="lib_8c.html#af03da38defdb7d2ba4e9e517c3c54836">safe_fclose</a> (&amp;ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6c6e5e2693d2f21999e136926eefeba9">lockfp</a>);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div><div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a2c21de6a5ffc32f55d51273b90b5d36f"><div class="ttname"><a href="structCOMPRESS__INFO.html#a2c21de6a5ffc32f55d51273b90b5d36f">COMPRESS_INFO::locked</a></div><div class="ttdeci">int locked</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00052">compress.c:52</a></div></div>
<div class="ttc" id="lib_8c_html_af03da38defdb7d2ba4e9e517c3c54836"><div class="ttname"><a href="lib_8c.html#af03da38defdb7d2ba4e9e517c3c54836">safe_fclose</a></div><div class="ttdeci">int safe_fclose(FILE **f)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00203">lib.c:203</a></div></div>
<div class="ttc" id="structCONTEXT_html_aa33eac2793b011daf40590752dfb9ddc"><div class="ttname"><a href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">CONTEXT::realpath</a></div><div class="ttdeci">char * realpath</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01011">mutt.h:1011</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a6c6e5e2693d2f21999e136926eefeba9"><div class="ttname"><a href="structCOMPRESS__INFO.html#a6c6e5e2693d2f21999e136926eefeba9">COMPRESS_INFO::lockfp</a></div><div class="ttdeci">FILE * lockfp</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00053">compress.c:53</a></div></div>
<div class="ttc" id="mx_8c_html_a8b783b797caf94ef300cb95fd278a273"><div class="ttname"><a href="mx_8c.html#a8b783b797caf94ef300cb95fd278a273">mx_unlock_file</a></div><div class="ttdeci">int mx_unlock_file(const char *path, int fd, int dot)</div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l00302">mx.c:302</a></div></div>
<div class="ttc" id="structCONTEXT_html_a97a63c10344e36eacb10be318022b198"><div class="ttname"><a href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">CONTEXT::compress_info</a></div><div class="ttdeci">void * compress_info</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01051">mutt.h:1051</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a804b29dcfdfaf4eb8a5ebfb7cb4213c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a804b29dcfdfaf4eb8a5ebfb7cb4213c8">&#9670;&nbsp;</a></span>setup_paths()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int setup_paths </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the mailbox paths : Mailbox to modify. </p>
<p>Save the compressed filename in ctx-&gt;realpath. Create a temporary filename and put its name in ctx-&gt;path. The temporary file is created to prevent symlink attacks.</p>
<p>Returns: 0: Success -1: Error </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00145">145</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">if</span> (!ctx)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">char</span> tmppath[<a class="code" href="dcigettext_8c.html#a45614b6d4dc532a7211d75e0aa18c964">_POSIX_PATH_MAX</a>];</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  FILE *tmpfp;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">/* Setup the right paths */</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a> = ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">/* We will uncompress to /tmp */</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="protos_8h.html#ae0183b49b12ba5b43c93fae37d46d68b">mutt_mktemp</a> (tmppath, <span class="keyword">sizeof</span> (tmppath));</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a> = <a class="code" href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a> (tmppath);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">if</span> ((tmpfp = <a class="code" href="lib_8c.html#a6828784843a0b204119503e3e0bd984f">safe_fopen</a> (ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>, <span class="stringliteral">&quot;w&quot;</span>)) == <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <a class="code" href="lib_8c.html#af03da38defdb7d2ba4e9e517c3c54836">safe_fclose</a> (&amp;tmpfp);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div><div class="ttc" id="explodename_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="explodename_8c_source.html#l00034">explodename.c:34</a></div></div>
<div class="ttc" id="structCONTEXT_html_a5dc77ea6580ac49ef1faf75e5bb85349"><div class="ttname"><a href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">CONTEXT::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01010">mutt.h:1010</a></div></div>
<div class="ttc" id="lib_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00077">lib.h:77</a></div></div>
<div class="ttc" id="dcigettext_8c_html_a45614b6d4dc532a7211d75e0aa18c964"><div class="ttname"><a href="dcigettext_8c.html#a45614b6d4dc532a7211d75e0aa18c964">_POSIX_PATH_MAX</a></div><div class="ttdeci">#define _POSIX_PATH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="dcigettext_8c_source.html#l00159">dcigettext.c:159</a></div></div>
<div class="ttc" id="lib_8c_html_a26d804f329dea2733da34a4953a22a9d"><div class="ttname"><a href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a></div><div class="ttdeci">char * safe_strdup(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00234">lib.c:234</a></div></div>
<div class="ttc" id="lib_8c_html_a6828784843a0b204119503e3e0bd984f"><div class="ttname"><a href="lib_8c.html#a6828784843a0b204119503e3e0bd984f">safe_fopen</a></div><div class="ttdeci">FILE * safe_fopen(const char *path, const char *mode)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00698">lib.c:698</a></div></div>
<div class="ttc" id="lib_8c_html_af03da38defdb7d2ba4e9e517c3c54836"><div class="ttname"><a href="lib_8c.html#af03da38defdb7d2ba4e9e517c3c54836">safe_fclose</a></div><div class="ttdeci">int safe_fclose(FILE **f)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00203">lib.c:203</a></div></div>
<div class="ttc" id="structCONTEXT_html_aa33eac2793b011daf40590752dfb9ddc"><div class="ttname"><a href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">CONTEXT::realpath</a></div><div class="ttdeci">char * realpath</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01011">mutt.h:1011</a></div></div>
<div class="ttc" id="protos_8h_html_ae0183b49b12ba5b43c93fae37d46d68b"><div class="ttname"><a href="protos_8h.html#ae0183b49b12ba5b43c93fae37d46d68b">mutt_mktemp</a></div><div class="ttdeci">#define mutt_mktemp(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="protos_8h_source.html#l00246">protos.h:246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef351258938e8f659c65e9e925bf3ef2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef351258938e8f659c65e9e925bf3ef2">&#9670;&nbsp;</a></span>get_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int get_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the size of a file : File to measure. </p>
<p>Returns: number: Size in bytes 0: On error </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00177">177</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">if</span> (!path)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keyword">struct </span>stat sb;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">if</span> (stat (path, &amp;sb) != 0)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">return</span> sb.st_size;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a66135b1e3433cc07352b16bd8463db74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66135b1e3433cc07352b16bd8463db74">&#9670;&nbsp;</a></span>store_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void store_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save the size of the compressed file : Mailbox. </p>
<p>Save the compressed file size in the compress_info struct. </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00196">196</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;{</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">if</span> (!ctx)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">if</span> (!ci)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6b5072dfe620abb24f2a96356de6cd72">size</a> = <a class="code" href="compress_8c.html#aef351258938e8f659c65e9e925bf3ef2">get_size</a> (ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a>);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div><div class="ttc" id="compress_8c_html_aef351258938e8f659c65e9e925bf3ef2"><div class="ttname"><a href="compress_8c.html#aef351258938e8f659c65e9e925bf3ef2">get_size</a></div><div class="ttdeci">static int get_size(const char *path)</div><div class="ttdoc">Get the size of a file : File to measure. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00177">compress.c:177</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a6b5072dfe620abb24f2a96356de6cd72"><div class="ttname"><a href="structCOMPRESS__INFO.html#a6b5072dfe620abb24f2a96356de6cd72">COMPRESS_INFO::size</a></div><div class="ttdeci">off_t size</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00050">compress.c:50</a></div></div>
<div class="ttc" id="structCONTEXT_html_aa33eac2793b011daf40590752dfb9ddc"><div class="ttname"><a href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">CONTEXT::realpath</a></div><div class="ttdeci">char * realpath</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01011">mutt.h:1011</a></div></div>
<div class="ttc" id="structCONTEXT_html_a97a63c10344e36eacb10be318022b198"><div class="ttname"><a href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">CONTEXT::compress_info</a></div><div class="ttdeci">void * compress_info</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01051">mutt.h:1051</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a43803535152ad5c75657dbc93b036786"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43803535152ad5c75657dbc93b036786">&#9670;&nbsp;</a></span>find_hook()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char* find_hook </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find a hook to match a path : Type of hook, e.g. </p>
<p>MUTT_CLOSEHOOK : Filename to test</p>
<p>Each hook has a type and a pattern. Find a command that matches the type and path supplied. e.g.</p>
<p>User config: open-hook '.gz$' "gzip -cd '%f' &gt; '%t'"</p>
<p>Call: find_hook (MUTT_OPENHOOK, "myfile.gz");</p>
<p>Returns: string: Matching hook command NULL: No matches </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00227">227</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;{</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">if</span> (!path)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *c = <a class="code" href="hook_8c.html#a16fdbc19d6826e589af4462a0bcde7eb">mutt_find_hook</a> (type, path);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span> (!c || !*c)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">return</span> c;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div><div class="ttc" id="explodename_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="explodename_8c_source.html#l00034">explodename.c:34</a></div></div>
<div class="ttc" id="hook_8c_html_a16fdbc19d6826e589af4462a0bcde7eb"><div class="ttname"><a href="hook_8c.html#a16fdbc19d6826e589af4462a0bcde7eb">mutt_find_hook</a></div><div class="ttdeci">char * mutt_find_hook(int type, const char *pat)</div><div class="ttdef"><b>Definition:</b> <a href="hook_8c_source.html#l00353">hook.c:353</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a909545bed7377d2c98b787ef173162cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a909545bed7377d2c98b787ef173162cc">&#9670;&nbsp;</a></span>set_compress_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a>* set_compress_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find the compress hooks for a mailbox : Mailbox to examine. </p>
<p>When a mailbox is opened, we check if there are any matching hooks.</p>
<p>Returns: <a class="el" href="structCOMPRESS__INFO.html" title="Private data for compress. ">COMPRESS_INFO</a>: Hook info for the mailbox's path NULL: On error </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00250">250</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">if</span> (!ctx || !ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>)</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">/* Open is compulsory */</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *o = <a class="code" href="compress_8c.html#a43803535152ad5c75657dbc93b036786">find_hook</a> (<a class="code" href="mutt_8h.html#abffdc7d595ce7738f067dda3552e9260">MUTT_OPENHOOK</a>,   ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">if</span> (!o)</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *c = <a class="code" href="compress_8c.html#a43803535152ad5c75657dbc93b036786">find_hook</a> (<a class="code" href="mutt_8h.html#a8d3b21774b7d164c974ef74d0e554924">MUTT_CLOSEHOOK</a>,  ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *a = <a class="code" href="compress_8c.html#a43803535152ad5c75657dbc93b036786">find_hook</a> (<a class="code" href="mutt_8h.html#adf5e570a335de447f7ec1503f8b8d9a3">MUTT_APPENDHOOK</a>, ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = <a class="code" href="lib_8c.html#a725ea15665b1be820aee11fddd857f8a">safe_calloc</a> (1, <span class="keyword">sizeof</span> (<a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a>));</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a> = ci;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a752d1c082026693bbcf1c21db35df6dc">open</a>   = <a class="code" href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a> (o);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">close</a>  = <a class="code" href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a> (c);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a3e03b4d1334a638d10276396cb200c0f">append</a> = <a class="code" href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a> (a);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">return</span> ci;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div><div class="ttc" id="explodename_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="explodename_8c_source.html#l00034">explodename.c:34</a></div></div>
<div class="ttc" id="mutt_8h_html_abffdc7d595ce7738f067dda3552e9260"><div class="ttname"><a href="mutt_8h.html#abffdc7d595ce7738f067dda3552e9260">MUTT_OPENHOOK</a></div><div class="ttdeci">#define MUTT_OPENHOOK</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00163">mutt.h:163</a></div></div>
<div class="ttc" id="structCONTEXT_html_a5dc77ea6580ac49ef1faf75e5bb85349"><div class="ttname"><a href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">CONTEXT::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01010">mutt.h:1010</a></div></div>
<div class="ttc" id="mutt_8h_html_a8d3b21774b7d164c974ef74d0e554924"><div class="ttname"><a href="mutt_8h.html#a8d3b21774b7d164c974ef74d0e554924">MUTT_CLOSEHOOK</a></div><div class="ttdeci">#define MUTT_CLOSEHOOK</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00165">mutt.h:165</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a6e6ff62d93d1861462036c895e43abfc"><div class="ttname"><a href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">COMPRESS_INFO::close</a></div><div class="ttdeci">const char * close</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00048">compress.c:48</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a3e03b4d1334a638d10276396cb200c0f"><div class="ttname"><a href="structCOMPRESS__INFO.html#a3e03b4d1334a638d10276396cb200c0f">COMPRESS_INFO::append</a></div><div class="ttdeci">const char * append</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00047">compress.c:47</a></div></div>
<div class="ttc" id="lib_8c_html_a26d804f329dea2733da34a4953a22a9d"><div class="ttname"><a href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a></div><div class="ttdeci">char * safe_strdup(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00234">lib.c:234</a></div></div>
<div class="ttc" id="lib_8c_html_a725ea15665b1be820aee11fddd857f8a"><div class="ttname"><a href="lib_8c.html#a725ea15665b1be820aee11fddd857f8a">safe_calloc</a></div><div class="ttdeci">void * safe_calloc(size_t nmemb, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00122">lib.c:122</a></div></div>
<div class="ttc" id="compress_8c_html_a43803535152ad5c75657dbc93b036786"><div class="ttname"><a href="compress_8c.html#a43803535152ad5c75657dbc93b036786">find_hook</a></div><div class="ttdeci">static const char * find_hook(int type, const char *path)</div><div class="ttdoc">Find a hook to match a path : Type of hook, e.g. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00227">compress.c:227</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a752d1c082026693bbcf1c21db35df6dc"><div class="ttname"><a href="structCOMPRESS__INFO.html#a752d1c082026693bbcf1c21db35df6dc">COMPRESS_INFO::open</a></div><div class="ttdeci">const char * open</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00049">compress.c:49</a></div></div>
<div class="ttc" id="mutt_8h_html_adf5e570a335de447f7ec1503f8b8d9a3"><div class="ttname"><a href="mutt_8h.html#adf5e570a335de447f7ec1503f8b8d9a3">MUTT_APPENDHOOK</a></div><div class="ttdeci">#define MUTT_APPENDHOOK</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00164">mutt.h:164</a></div></div>
<div class="ttc" id="structCONTEXT_html_a97a63c10344e36eacb10be318022b198"><div class="ttname"><a href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">CONTEXT::compress_info</a></div><div class="ttdeci">void * compress_info</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01051">mutt.h:1051</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a97b329171e49a0fc29f030bca2cda467"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97b329171e49a0fc29f030bca2cda467">&#9670;&nbsp;</a></span>mutt_free_compress_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_free_compress_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees the compress info members and structure. </p>
<p>: Mailbox to free compress_info for. </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00281">281</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;{</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">if</span> (!ctx || !ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  ci = ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a> (&amp;ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a752d1c082026693bbcf1c21db35df6dc">open</a>);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a> (&amp;ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">close</a>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a> (&amp;ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a3e03b4d1334a638d10276396cb200c0f">append</a>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <a class="code" href="compress_8c.html#ad02e220bbca8247f9b048092a07074bb">unlock_realpath</a> (ctx);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a> (&amp;ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;}</div><div class="ttc" id="compress_8c_html_ad02e220bbca8247f9b048092a07074bb"><div class="ttname"><a href="compress_8c.html#ad02e220bbca8247f9b048092a07074bb">unlock_realpath</a></div><div class="ttdeci">static void unlock_realpath(CONTEXT *ctx)</div><div class="ttdoc">Unlock the ctx-&gt;realpath : Mailbox to unlock. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00114">compress.c:114</a></div></div>
<div class="ttc" id="lib_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00077">lib.h:77</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a6e6ff62d93d1861462036c895e43abfc"><div class="ttname"><a href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">COMPRESS_INFO::close</a></div><div class="ttdeci">const char * close</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00048">compress.c:48</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a3e03b4d1334a638d10276396cb200c0f"><div class="ttname"><a href="structCOMPRESS__INFO.html#a3e03b4d1334a638d10276396cb200c0f">COMPRESS_INFO::append</a></div><div class="ttdeci">const char * append</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00047">compress.c:47</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a752d1c082026693bbcf1c21db35df6dc"><div class="ttname"><a href="structCOMPRESS__INFO.html#a752d1c082026693bbcf1c21db35df6dc">COMPRESS_INFO::open</a></div><div class="ttdeci">const char * open</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00049">compress.c:49</a></div></div>
<div class="ttc" id="structCONTEXT_html_a97a63c10344e36eacb10be318022b198"><div class="ttname"><a href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">CONTEXT::compress_info</a></div><div class="ttdeci">void * compress_info</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01051">mutt.h:1051</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1b0f0a971423299d997e242128b425f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1b0f0a971423299d997e242128b425f">&#9670;&nbsp;</a></span>escape_path()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char* escape_path </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Escapes single quotes in a path for a command string. </p>
<p>the path to escape.</p>
<p>Returns: a pointer to the escaped string. </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00305">305</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;{</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> dest[<a class="code" href="lib_8h.html#a311ef6df9e7e4907c467d815ee8a20b2">HUGE_STRING</a>];</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordtype">char</span> *destp = dest;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordtype">int</span> destsize = 0;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">if</span> (!src)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">while</span> (*src &amp;&amp; (destsize &lt; <span class="keyword">sizeof</span>(dest) - 1))</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">if</span> (*src != <span class="charliteral">&#39;\&#39;&#39;</span>)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      *destp++ = *src++;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      destsize++;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    }</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="comment">/* convert &#39; into &#39;\&#39;&#39; */</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keywordflow">if</span> (destsize + 4 &lt; <span class="keyword">sizeof</span>(dest))</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        *destp++ = *src++;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        *destp++ = <span class="charliteral">&#39;\\&#39;</span>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        *destp++ = <span class="charliteral">&#39;\&#39;&#39;</span>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        *destp++ = <span class="charliteral">&#39;\&#39;&#39;</span>;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        destsize += 4;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  }</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  *destp = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">return</span> dest;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;}</div><div class="ttc" id="explodename_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="explodename_8c_source.html#l00034">explodename.c:34</a></div></div>
<div class="ttc" id="lib_8h_html_a311ef6df9e7e4907c467d815ee8a20b2"><div class="ttname"><a href="lib_8h.html#a311ef6df9e7e4907c467d815ee8a20b2">HUGE_STRING</a></div><div class="ttdeci">#define HUGE_STRING</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00060">lib.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af0389489fc84dd74952cc102477d4078"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0389489fc84dd74952cc102477d4078">&#9670;&nbsp;</a></span>cb_format_str()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char* cb_format_str </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>destlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>ifstring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>elsestring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mutt_8h.html#a9498724ab6e4b2d35b96c492374513ae">format_flag</a>&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Expand the filenames in the command string : Buffer in which to save string : Buffer length : Starting column, UNUSED : Number of screen columns, UNUSED : printf-like operator, e.g. </p>
<p>'t' : printf-like format string : Field formatting string, UNUSED : If condition is met, display this string, UNUSED : Otherwise, display this string, UNUSED : Pointer to the mailbox <a class="el" href="structCONTEXT.html">CONTEXT</a> : Format flags, UNUSED</p>
<p>cb_format_str is a callback function for mutt_FormatString. It understands two operators. 'f' : 'from' filename, 't' : 'to' filename.</p>
<p>Returns: src (unchanged) </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00361">361</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;{</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">if</span> (!dest || (data == 0))</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">return</span> src;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <a class="code" href="structCONTEXT.html">CONTEXT</a> *ctx = (<a class="code" href="structCONTEXT.html">CONTEXT</a> *) data;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">switch</span> (op)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="comment">/* Compressed file */</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (dest, destlen, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="lib_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a> (<a class="code" href="compress_8c.html#ae1b0f0a971423299d997e242128b425f">escape_path</a> (ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a>)));</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="comment">/* Plaintext, temporary file */</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (dest, destlen, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="lib_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a> (<a class="code" href="compress_8c.html#ae1b0f0a971423299d997e242128b425f">escape_path</a> (ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>)));</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordflow">return</span> src;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div><div class="ttc" id="compress_8c_html_ae1b0f0a971423299d997e242128b425f"><div class="ttname"><a href="compress_8c.html#ae1b0f0a971423299d997e242128b425f">escape_path</a></div><div class="ttdeci">static char * escape_path(char *src)</div><div class="ttdoc">Escapes single quotes in a path for a command string. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00305">compress.c:305</a></div></div>
<div class="ttc" id="structCONTEXT_html_a5dc77ea6580ac49ef1faf75e5bb85349"><div class="ttname"><a href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">CONTEXT::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01010">mutt.h:1010</a></div></div>
<div class="ttc" id="structCONTEXT_html"><div class="ttname"><a href="structCONTEXT.html">CONTEXT</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01008">mutt.h:1008</a></div></div>
<div class="ttc" id="structCONTEXT_html_aa33eac2793b011daf40590752dfb9ddc"><div class="ttname"><a href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">CONTEXT::realpath</a></div><div class="ttdeci">char * realpath</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01011">mutt.h:1011</a></div></div>
<div class="ttc" id="lib_8h_html_a7e0481bed27661ea2679f256b24e0283"><div class="ttname"><a href="lib_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a></div><div class="ttdeci">#define NONULL(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00078">lib.h:78</a></div></div>
<div class="ttc" id="dotlock_8c_html_a357a42eb6494ea592e9c3f96c55cebe2"><div class="ttname"><a href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a></div><div class="ttdeci">int snprintf(char *, size_t, const char *,...)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a650b796a0272b691aa27bed43e68b808"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a650b796a0272b691aa27bed43e68b808">&#9670;&nbsp;</a></span>expand_command_str()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void expand_command_str </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>buflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Expand placeholders in command string : Mailbox for paths : Buffer to store the command : Size of the buffer. </p>
<p>This function takes a hook command and expands the filename placeholders within it. The function calls <a class="el" href="muttlib_8c.html#a8f68fc734dc58779cfabcfbb2d547602">mutt_FormatString()</a> to do the replacement which calls our callback function <a class="el" href="compress_8c.html#af0389489fc84dd74952cc102477d4078" title="Expand the filenames in the command string : Buffer in which to save string : Buffer length : Startin...">cb_format_str()</a>. e.g.</p>
<p>Template command: gzip -cd 'f' &gt; 't'</p>
<p>Result: gzip -dc '~/mail/abc.gz' &gt; '/tmp/xyz' </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00401">401</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;{</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">if</span> (!ctx || !cmd || !buf)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <a class="code" href="muttlib_8c.html#a8f68fc734dc58779cfabcfbb2d547602">mutt_FormatString</a> (buf, buflen, 0, buflen, cmd, <a class="code" href="compress_8c.html#af0389489fc84dd74952cc102477d4078">cb_format_str</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) ctx, 0);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;}</div><div class="ttc" id="muttlib_8c_html_a8f68fc734dc58779cfabcfbb2d547602"><div class="ttname"><a href="muttlib_8c.html#a8f68fc734dc58779cfabcfbb2d547602">mutt_FormatString</a></div><div class="ttdeci">void mutt_FormatString(char *dest, size_t destlen, size_t col, int cols, const char *src, format_t *callback, unsigned long data, format_flag flags)</div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8c_source.html#l01186">muttlib.c:1186</a></div></div>
<div class="ttc" id="compress_8c_html_af0389489fc84dd74952cc102477d4078"><div class="ttname"><a href="compress_8c.html#af0389489fc84dd74952cc102477d4078">cb_format_str</a></div><div class="ttdeci">static const char * cb_format_str(char *dest, size_t destlen, size_t col, int cols, char op, const char *src, const char *fmt, const char *ifstring, const char *elsestring, unsigned long data, format_flag flags)</div><div class="ttdoc">Expand the filenames in the command string : Buffer in which to save string : Buffer length : Startin...</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00361">compress.c:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9031d1b73f7ebb9b32878441bd7eedb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9031d1b73f7ebb9b32878441bd7eedb2">&#9670;&nbsp;</a></span>execute_command()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int execute_command </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>progress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run a system command : Mailbox to work with : Command string to execute : Message to show the user. </p>
<p>Run the supplied command, taking care of all the Mutt requirements, such as locking files and blocking signals.</p>
<p>Returns: 1: Success 0: Failure </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00423">423</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;{</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordtype">int</span> rc = 1;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keywordtype">char</span> sys_cmd[<a class="code" href="lib_8h.html#a311ef6df9e7e4907c467d815ee8a20b2">HUGE_STRING</a>];</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">if</span> (!ctx || !command || !progress)</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordflow">if</span> (!ctx-&gt;<a class="code" href="structCONTEXT.html#aa673f050342c18bae81bd314e8c226ff">quiet</a>)</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="globals_8h.html#a6021755edce63ab9d4e49f97213e83ab">mutt_message</a> (progress, ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a>);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <a class="code" href="protos_8h.html#a7617dc58ee4985d47caee2c3b6cec2c7">mutt_block_signals</a>();</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <a class="code" href="mutt__curses_8h.html#aa98171f44124758f59e52647bb2d40f7">endwin</a>();</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <a class="code" href="protos_8h.html#abb5c87cbfd718b3afa493c87bb0c5152">fflush</a> (stdout);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <a class="code" href="compress_8c.html#a650b796a0272b691aa27bed43e68b808">expand_command_str</a> (ctx, command, sys_cmd, <span class="keyword">sizeof</span> (sys_cmd));</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="protos_8h.html#a824e27c329552db25396e47110e45e73">mutt_system</a> (sys_cmd) != 0)</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    rc = 0;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a> (<a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Error running \&quot;%s\&quot;!&quot;</span>), sys_cmd);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <a class="code" href="protos_8h.html#ad8426c0bac1e84cc10808cbecb0e7206">mutt_unblock_signals</a>();</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div><div class="ttc" id="structCONTEXT_html_aa673f050342c18bae81bd314e8c226ff"><div class="ttname"><a href="structCONTEXT.html#aa673f050342c18bae81bd314e8c226ff">CONTEXT::quiet</a></div><div class="ttdeci">unsigned int quiet</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01045">mutt.h:1045</a></div></div>
<div class="ttc" id="explodename_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="explodename_8c_source.html#l00034">explodename.c:34</a></div></div>
<div class="ttc" id="protos_8h_html_a7617dc58ee4985d47caee2c3b6cec2c7"><div class="ttname"><a href="protos_8h.html#a7617dc58ee4985d47caee2c3b6cec2c7">mutt_block_signals</a></div><div class="ttdeci">void mutt_block_signals(void)</div><div class="ttdef"><b>Definition:</b> <a href="signal_8c_source.html#l00170">signal.c:170</a></div></div>
<div class="ttc" id="mutt__curses_8h_html_aa98171f44124758f59e52647bb2d40f7"><div class="ttname"><a href="mutt__curses_8h.html#aa98171f44124758f59e52647bb2d40f7">endwin</a></div><div class="ttdeci">int endwin()</div></div>
<div class="ttc" id="protos_8h_html_a824e27c329552db25396e47110e45e73"><div class="ttname"><a href="protos_8h.html#a824e27c329552db25396e47110e45e73">mutt_system</a></div><div class="ttdeci">#define mutt_system(x)</div><div class="ttdef"><b>Definition:</b> <a href="protos_8h_source.html#l00058">protos.h:58</a></div></div>
<div class="ttc" id="protos_8h_html_ad8426c0bac1e84cc10808cbecb0e7206"><div class="ttname"><a href="protos_8h.html#ad8426c0bac1e84cc10808cbecb0e7206">mutt_unblock_signals</a></div><div class="ttdeci">void mutt_unblock_signals(void)</div><div class="ttdef"><b>Definition:</b> <a href="signal_8c_source.html#l00188">signal.c:188</a></div></div>
<div class="ttc" id="extlib_8c_html_a90829ddbd5f0edf736c9f6e595cfc0be"><div class="ttname"><a href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a></div><div class="ttdeci">void(* mutt_error)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="extlib_8c_source.html#l00037">extlib.c:37</a></div></div>
<div class="ttc" id="structCONTEXT_html_aa33eac2793b011daf40590752dfb9ddc"><div class="ttname"><a href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">CONTEXT::realpath</a></div><div class="ttdeci">char * realpath</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01011">mutt.h:1011</a></div></div>
<div class="ttc" id="globals_8h_html_a6021755edce63ab9d4e49f97213e83ab"><div class="ttname"><a href="globals_8h.html#a6021755edce63ab9d4e49f97213e83ab">mutt_message</a></div><div class="ttdeci">WHERE void(* mutt_message)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00020">globals.h:20</a></div></div>
<div class="ttc" id="curs__lib_8c_html_ab6a61cdfcf8c2c73ee59381c79c79774"><div class="ttname"><a href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a></div><div class="ttdeci">int mutt_any_key_to_continue(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00751">curs_lib.c:751</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="lib_8h_html_a311ef6df9e7e4907c467d815ee8a20b2"><div class="ttname"><a href="lib_8h.html#a311ef6df9e7e4907c467d815ee8a20b2">HUGE_STRING</a></div><div class="ttdeci">#define HUGE_STRING</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00060">lib.h:60</a></div></div>
<div class="ttc" id="compress_8c_html_a650b796a0272b691aa27bed43e68b808"><div class="ttname"><a href="compress_8c.html#a650b796a0272b691aa27bed43e68b808">expand_command_str</a></div><div class="ttdeci">static void expand_command_str(const CONTEXT *ctx, const char *cmd, char *buf, int buflen)</div><div class="ttdoc">Expand placeholders in command string : Mailbox for paths : Buffer to store the command : Size of the...</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00401">compress.c:401</a></div></div>
<div class="ttc" id="protos_8h_html_abb5c87cbfd718b3afa493c87bb0c5152"><div class="ttname"><a href="protos_8h.html#abb5c87cbfd718b3afa493c87bb0c5152">fflush</a></div><div class="ttdeci">int fflush()</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f58c5d1c5690258d1e44930d4bc7ed9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f58c5d1c5690258d1e44930d4bc7ed9">&#9670;&nbsp;</a></span>open_mailbox()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int open_mailbox </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Open a compressed mailbox : Mailbox to open. </p>
<p>Set up a compressed mailbox to be read. Decompress the mailbox and set up the paths and hooks needed. Then determine the type of the mailbox so we can delegate the handling of messages. </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00462">462</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;{</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">if</span> (!ctx || (ctx-&gt;<a class="code" href="structCONTEXT.html#ae975ede7d262b60f85c17745fcb95064">magic</a> != <a class="code" href="mx_8h.html#aac34dfe6c6b73b43a4656c9dce041034abe3e473aa651d6b7030b5ef08953eb4e">MUTT_COMPRESSED</a>))</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = <a class="code" href="compress_8c.html#a909545bed7377d2c98b787ef173162cc">set_compress_info</a> (ctx);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">if</span> (!ci)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">/* If there&#39;s no close-hook, or the file isn&#39;t writable */</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">if</span> (!ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">close</a> || (access (ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>, W_OK) != 0))</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    ctx-&gt;<a class="code" href="structCONTEXT.html#a53580c3479115ea0f00732ca8f5c55fa">readonly</a> = 1;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="compress_8c.html#a804b29dcfdfaf4eb8a5ebfb7cb4213c8">setup_paths</a> (ctx) != 0)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">goto</span> or_fail;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <a class="code" href="compress_8c.html#a66135b1e3433cc07352b16bd8463db74">store_size</a> (ctx);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="compress_8c.html#afe8cd0103ee2736842782ff97d3cf300">lock_realpath</a> (ctx, 0))</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Unable to lock mailbox!&quot;</span>));</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">goto</span> or_fail;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  }</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordtype">int</span> rc = <a class="code" href="compress_8c.html#a9031d1b73f7ebb9b32878441bd7eedb2">execute_command</a> (ctx, ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a752d1c082026693bbcf1c21db35df6dc">open</a>, <a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Decompressing %s&quot;</span>));</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">if</span> (rc == 0)</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">goto</span> or_fail;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <a class="code" href="compress_8c.html#ad02e220bbca8247f9b048092a07074bb">unlock_realpath</a> (ctx);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  ctx-&gt;<a class="code" href="structCONTEXT.html#ae975ede7d262b60f85c17745fcb95064">magic</a> = <a class="code" href="mailbox_8h.html#a2c41d964b6fe8ecf33643cb3d56248e5">mx_get_magic</a> (ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structCONTEXT.html#ae975ede7d262b60f85c17745fcb95064">magic</a> == 0)</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t identify the contents of the compressed file&quot;</span>));</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">goto</span> or_fail;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">child_ops</a> = <a class="code" href="mx_8c.html#abf342fbe3affa0f0203320a9a9a307b1">mx_get_ops</a> (ctx-&gt;<a class="code" href="structCONTEXT.html#ae975ede7d262b60f85c17745fcb95064">magic</a>);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">if</span> (!ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">child_ops</a>)</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t find mailbox ops for mailbox type %d&quot;</span>), ctx-&gt;<a class="code" href="structCONTEXT.html#ae975ede7d262b60f85c17745fcb95064">magic</a>);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">goto</span> or_fail;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  }</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">return</span> ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">child_ops</a>-&gt;<a class="code" href="structmx__ops.html#af4039e2b7d91e8d304b719ca100eca95">open</a> (ctx);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;or_fail:</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="comment">/* remove the partial uncompressed file */</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keyword">remove</span> (ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <a class="code" href="compress_8c.html#a97b329171e49a0fc29f030bca2cda467">mutt_free_compress_info</a> (ctx);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div><div class="ttc" id="compress_8c_html_ad02e220bbca8247f9b048092a07074bb"><div class="ttname"><a href="compress_8c.html#ad02e220bbca8247f9b048092a07074bb">unlock_realpath</a></div><div class="ttdeci">static void unlock_realpath(CONTEXT *ctx)</div><div class="ttdoc">Unlock the ctx-&gt;realpath : Mailbox to unlock. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00114">compress.c:114</a></div></div>
<div class="ttc" id="mx_8c_html_abf342fbe3affa0f0203320a9a9a307b1"><div class="ttname"><a href="mx_8c.html#abf342fbe3affa0f0203320a9a9a307b1">mx_get_ops</a></div><div class="ttdeci">struct mx_ops * mx_get_ops(int magic)</div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l00075">mx.c:75</a></div></div>
<div class="ttc" id="structmx__ops_html_af4039e2b7d91e8d304b719ca100eca95"><div class="ttname"><a href="structmx__ops.html#af4039e2b7d91e8d304b719ca100eca95">mx_ops::open</a></div><div class="ttdeci">int(* open)(struct _context *)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00997">mutt.h:997</a></div></div>
<div class="ttc" id="compress_8c_html_a909545bed7377d2c98b787ef173162cc"><div class="ttname"><a href="compress_8c.html#a909545bed7377d2c98b787ef173162cc">set_compress_info</a></div><div class="ttdeci">static COMPRESS_INFO * set_compress_info(CONTEXT *ctx)</div><div class="ttdoc">Find the compress hooks for a mailbox : Mailbox to examine. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00250">compress.c:250</a></div></div>
<div class="ttc" id="structCONTEXT_html_a5dc77ea6580ac49ef1faf75e5bb85349"><div class="ttname"><a href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">CONTEXT::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01010">mutt.h:1010</a></div></div>
<div class="ttc" id="mx_8h_html_aac34dfe6c6b73b43a4656c9dce041034abe3e473aa651d6b7030b5ef08953eb4e"><div class="ttname"><a href="mx_8h.html#aac34dfe6c6b73b43a4656c9dce041034abe3e473aa651d6b7030b5ef08953eb4e">MUTT_COMPRESSED</a></div><div class="ttdef"><b>Definition:</b> <a href="mx_8h_source.html#l00045">mx.h:45</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a6e6ff62d93d1861462036c895e43abfc"><div class="ttname"><a href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">COMPRESS_INFO::close</a></div><div class="ttdeci">const char * close</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00048">compress.c:48</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="mailbox_8h_html_a2c41d964b6fe8ecf33643cb3d56248e5"><div class="ttname"><a href="mailbox_8h.html#a2c41d964b6fe8ecf33643cb3d56248e5">mx_get_magic</a></div><div class="ttdeci">int mx_get_magic(const char *)</div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l00431">mx.c:431</a></div></div>
<div class="ttc" id="extlib_8c_html_a90829ddbd5f0edf736c9f6e595cfc0be"><div class="ttname"><a href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a></div><div class="ttdeci">void(* mutt_error)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="extlib_8c_source.html#l00037">extlib.c:37</a></div></div>
<div class="ttc" id="structCONTEXT_html_a53580c3479115ea0f00732ca8f5c55fa"><div class="ttname"><a href="structCONTEXT.html#a53580c3479115ea0f00732ca8f5c55fa">CONTEXT::readonly</a></div><div class="ttdeci">unsigned int readonly</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01042">mutt.h:1042</a></div></div>
<div class="ttc" id="compress_8c_html_a9031d1b73f7ebb9b32878441bd7eedb2"><div class="ttname"><a href="compress_8c.html#a9031d1b73f7ebb9b32878441bd7eedb2">execute_command</a></div><div class="ttdeci">static int execute_command(CONTEXT *ctx, const char *command, const char *progress)</div><div class="ttdoc">Run a system command : Mailbox to work with : Command string to execute : Message to show the user...</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00423">compress.c:423</a></div></div>
<div class="ttc" id="compress_8c_html_a97b329171e49a0fc29f030bca2cda467"><div class="ttname"><a href="compress_8c.html#a97b329171e49a0fc29f030bca2cda467">mutt_free_compress_info</a></div><div class="ttdeci">void mutt_free_compress_info(CONTEXT *ctx)</div><div class="ttdoc">Frees the compress info members and structure. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00281">compress.c:281</a></div></div>
<div class="ttc" id="compress_8c_html_afe8cd0103ee2736842782ff97d3cf300"><div class="ttname"><a href="compress_8c.html#afe8cd0103ee2736842782ff97d3cf300">lock_realpath</a></div><div class="ttdeci">static int lock_realpath(CONTEXT *ctx, int excl)</div><div class="ttdoc">Try to lock the ctx-&gt;realpath : Mailbox to lock : Lock exclusively? </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00071">compress.c:71</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a752d1c082026693bbcf1c21db35df6dc"><div class="ttname"><a href="structCOMPRESS__INFO.html#a752d1c082026693bbcf1c21db35df6dc">COMPRESS_INFO::open</a></div><div class="ttdeci">const char * open</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00049">compress.c:49</a></div></div>
<div class="ttc" id="structCONTEXT_html_ae975ede7d262b60f85c17745fcb95064"><div class="ttname"><a href="structCONTEXT.html#ae975ede7d262b60f85c17745fcb95064">CONTEXT::magic</a></div><div class="ttdeci">short magic</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01036">mutt.h:1036</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a7374278fe8b8a87a1ceb32677da81f50"><div class="ttname"><a href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">COMPRESS_INFO::child_ops</a></div><div class="ttdeci">struct mx_ops * child_ops</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00051">compress.c:51</a></div></div>
<div class="ttc" id="compress_8c_html_a804b29dcfdfaf4eb8a5ebfb7cb4213c8"><div class="ttname"><a href="compress_8c.html#a804b29dcfdfaf4eb8a5ebfb7cb4213c8">setup_paths</a></div><div class="ttdeci">static int setup_paths(CONTEXT *ctx)</div><div class="ttdoc">Set the mailbox paths : Mailbox to modify. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00145">compress.c:145</a></div></div>
<div class="ttc" id="compress_8c_html_a66135b1e3433cc07352b16bd8463db74"><div class="ttname"><a href="compress_8c.html#a66135b1e3433cc07352b16bd8463db74">store_size</a></div><div class="ttdeci">static void store_size(const CONTEXT *ctx)</div><div class="ttdoc">Save the size of the compressed file : Mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00196">compress.c:196</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ac021d4af3de65b7ca4de32af878ec2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ac021d4af3de65b7ca4de32af878ec2">&#9670;&nbsp;</a></span>open_append_mailbox()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int open_append_mailbox </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Open a compressed mailbox for appending : Mailbox to open : e.g. </p>
<p>Does the file already exist?</p>
<p>To append to a compressed mailbox we need an append-hook (or both open- and close-hooks).</p>
<p>Returns: 0: Success -1: Failure </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00527">527</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;{</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">if</span> (!ctx)</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">/* If this succeeds, we know there&#39;s an open-hook */</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = <a class="code" href="compress_8c.html#a909545bed7377d2c98b787ef173162cc">set_compress_info</a> (ctx);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">if</span> (!ci)</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">/* To append we need an append-hook or a close-hook */</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordflow">if</span> (!ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a3e03b4d1334a638d10276396cb200c0f">append</a> &amp;&amp; !ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">close</a>)</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Cannot append without an append-hook or close-hook : %s&quot;</span>), ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">goto</span> oa_fail1;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="compress_8c.html#a804b29dcfdfaf4eb8a5ebfb7cb4213c8">setup_paths</a> (ctx) != 0)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordflow">goto</span> oa_fail2;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">/* Lock the realpath for the duration of the append.</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">   * It will be unlocked in the close */</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="compress_8c.html#afe8cd0103ee2736842782ff97d3cf300">lock_realpath</a> (ctx, 1))</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Unable to lock mailbox!&quot;</span>));</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">goto</span> oa_fail2;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">/* Open the existing mailbox, unless we are appending */</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordflow">if</span> (!ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a3e03b4d1334a638d10276396cb200c0f">append</a> &amp;&amp; (<a class="code" href="compress_8c.html#aef351258938e8f659c65e9e925bf3ef2">get_size</a> (ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a>) &gt; 0))</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  {</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordtype">int</span> rc = <a class="code" href="compress_8c.html#a9031d1b73f7ebb9b32878441bd7eedb2">execute_command</a> (ctx, ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a752d1c082026693bbcf1c21db35df6dc">open</a>, <a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Decompressing %s&quot;</span>));</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">if</span> (rc == 0)</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    {</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Compress command failed: %s&quot;</span>), ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a752d1c082026693bbcf1c21db35df6dc">open</a>);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">goto</span> oa_fail2;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    ctx-&gt;<a class="code" href="structCONTEXT.html#ae975ede7d262b60f85c17745fcb95064">magic</a> = <a class="code" href="mailbox_8h.html#a2c41d964b6fe8ecf33643cb3d56248e5">mx_get_magic</a> (ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  }</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    ctx-&gt;<a class="code" href="structCONTEXT.html#ae975ede7d262b60f85c17745fcb95064">magic</a> = DefaultMagic;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">/* We can only deal with mbox and mmdf mailboxes */</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">if</span> ((ctx-&gt;<a class="code" href="structCONTEXT.html#ae975ede7d262b60f85c17745fcb95064">magic</a> != <a class="code" href="mx_8h.html#aac34dfe6c6b73b43a4656c9dce041034a817ef3cf5f529965875400b412678525">MUTT_MBOX</a>) &amp;&amp; (ctx-&gt;<a class="code" href="structCONTEXT.html#ae975ede7d262b60f85c17745fcb95064">magic</a> != <a class="code" href="mx_8h.html#aac34dfe6c6b73b43a4656c9dce041034a09cef4c4e3dc42c9137860413dcdb374">MUTT_MMDF</a>))</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Unsupported mailbox type for appending.&quot;</span>));</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">goto</span> oa_fail2;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">child_ops</a> = <a class="code" href="mx_8c.html#abf342fbe3affa0f0203320a9a9a307b1">mx_get_ops</a> (ctx-&gt;<a class="code" href="structCONTEXT.html#ae975ede7d262b60f85c17745fcb95064">magic</a>);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordflow">if</span> (!ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">child_ops</a>)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t find mailbox ops for mailbox type %d&quot;</span>), ctx-&gt;<a class="code" href="structCONTEXT.html#ae975ede7d262b60f85c17745fcb95064">magic</a>);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">goto</span> oa_fail2;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">if</span> (ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">child_ops</a>-&gt;<a class="code" href="structmx__ops.html#a6339c9204b0a2069cddc50b3216658c5">open_append</a> (ctx, flags) != 0)</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">goto</span> oa_fail2;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;oa_fail2:</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">/* remove the partial uncompressed file */</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keyword">remove</span> (ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;oa_fail1:</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="comment">/* Free the compress_info to prevent close from trying to recompress */</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <a class="code" href="compress_8c.html#a97b329171e49a0fc29f030bca2cda467">mutt_free_compress_info</a> (ctx);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;}</div><div class="ttc" id="mx_8c_html_abf342fbe3affa0f0203320a9a9a307b1"><div class="ttname"><a href="mx_8c.html#abf342fbe3affa0f0203320a9a9a307b1">mx_get_ops</a></div><div class="ttdeci">struct mx_ops * mx_get_ops(int magic)</div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l00075">mx.c:75</a></div></div>
<div class="ttc" id="compress_8c_html_a909545bed7377d2c98b787ef173162cc"><div class="ttname"><a href="compress_8c.html#a909545bed7377d2c98b787ef173162cc">set_compress_info</a></div><div class="ttdeci">static COMPRESS_INFO * set_compress_info(CONTEXT *ctx)</div><div class="ttdoc">Find the compress hooks for a mailbox : Mailbox to examine. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00250">compress.c:250</a></div></div>
<div class="ttc" id="compress_8c_html_aef351258938e8f659c65e9e925bf3ef2"><div class="ttname"><a href="compress_8c.html#aef351258938e8f659c65e9e925bf3ef2">get_size</a></div><div class="ttdeci">static int get_size(const char *path)</div><div class="ttdoc">Get the size of a file : File to measure. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00177">compress.c:177</a></div></div>
<div class="ttc" id="structCONTEXT_html_a5dc77ea6580ac49ef1faf75e5bb85349"><div class="ttname"><a href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">CONTEXT::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01010">mutt.h:1010</a></div></div>
<div class="ttc" id="structmx__ops_html_a6339c9204b0a2069cddc50b3216658c5"><div class="ttname"><a href="structmx__ops.html#a6339c9204b0a2069cddc50b3216658c5">mx_ops::open_append</a></div><div class="ttdeci">int(* open_append)(struct _context *, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00998">mutt.h:998</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a6e6ff62d93d1861462036c895e43abfc"><div class="ttname"><a href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">COMPRESS_INFO::close</a></div><div class="ttdeci">const char * close</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00048">compress.c:48</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a3e03b4d1334a638d10276396cb200c0f"><div class="ttname"><a href="structCOMPRESS__INFO.html#a3e03b4d1334a638d10276396cb200c0f">COMPRESS_INFO::append</a></div><div class="ttdeci">const char * append</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00047">compress.c:47</a></div></div>
<div class="ttc" id="mailbox_8h_html_a2c41d964b6fe8ecf33643cb3d56248e5"><div class="ttname"><a href="mailbox_8h.html#a2c41d964b6fe8ecf33643cb3d56248e5">mx_get_magic</a></div><div class="ttdeci">int mx_get_magic(const char *)</div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l00431">mx.c:431</a></div></div>
<div class="ttc" id="extlib_8c_html_a90829ddbd5f0edf736c9f6e595cfc0be"><div class="ttname"><a href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a></div><div class="ttdeci">void(* mutt_error)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="extlib_8c_source.html#l00037">extlib.c:37</a></div></div>
<div class="ttc" id="mx_8h_html_aac34dfe6c6b73b43a4656c9dce041034a09cef4c4e3dc42c9137860413dcdb374"><div class="ttname"><a href="mx_8h.html#aac34dfe6c6b73b43a4656c9dce041034a09cef4c4e3dc42c9137860413dcdb374">MUTT_MMDF</a></div><div class="ttdef"><b>Definition:</b> <a href="mx_8h_source.html#l00035">mx.h:35</a></div></div>
<div class="ttc" id="compress_8c_html_a9031d1b73f7ebb9b32878441bd7eedb2"><div class="ttname"><a href="compress_8c.html#a9031d1b73f7ebb9b32878441bd7eedb2">execute_command</a></div><div class="ttdeci">static int execute_command(CONTEXT *ctx, const char *command, const char *progress)</div><div class="ttdoc">Run a system command : Mailbox to work with : Command string to execute : Message to show the user...</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00423">compress.c:423</a></div></div>
<div class="ttc" id="compress_8c_html_a97b329171e49a0fc29f030bca2cda467"><div class="ttname"><a href="compress_8c.html#a97b329171e49a0fc29f030bca2cda467">mutt_free_compress_info</a></div><div class="ttdeci">void mutt_free_compress_info(CONTEXT *ctx)</div><div class="ttdoc">Frees the compress info members and structure. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00281">compress.c:281</a></div></div>
<div class="ttc" id="compress_8c_html_afe8cd0103ee2736842782ff97d3cf300"><div class="ttname"><a href="compress_8c.html#afe8cd0103ee2736842782ff97d3cf300">lock_realpath</a></div><div class="ttdeci">static int lock_realpath(CONTEXT *ctx, int excl)</div><div class="ttdoc">Try to lock the ctx-&gt;realpath : Mailbox to lock : Lock exclusively? </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00071">compress.c:71</a></div></div>
<div class="ttc" id="mx_8h_html_aac34dfe6c6b73b43a4656c9dce041034a817ef3cf5f529965875400b412678525"><div class="ttname"><a href="mx_8h.html#aac34dfe6c6b73b43a4656c9dce041034a817ef3cf5f529965875400b412678525">MUTT_MBOX</a></div><div class="ttdef"><b>Definition:</b> <a href="mx_8h_source.html#l00034">mx.h:34</a></div></div>
<div class="ttc" id="structCONTEXT_html_aa33eac2793b011daf40590752dfb9ddc"><div class="ttname"><a href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">CONTEXT::realpath</a></div><div class="ttdeci">char * realpath</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01011">mutt.h:1011</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a752d1c082026693bbcf1c21db35df6dc"><div class="ttname"><a href="structCOMPRESS__INFO.html#a752d1c082026693bbcf1c21db35df6dc">COMPRESS_INFO::open</a></div><div class="ttdeci">const char * open</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00049">compress.c:49</a></div></div>
<div class="ttc" id="structCONTEXT_html_ae975ede7d262b60f85c17745fcb95064"><div class="ttname"><a href="structCONTEXT.html#ae975ede7d262b60f85c17745fcb95064">CONTEXT::magic</a></div><div class="ttdeci">short magic</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01036">mutt.h:1036</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a7374278fe8b8a87a1ceb32677da81f50"><div class="ttname"><a href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">COMPRESS_INFO::child_ops</a></div><div class="ttdeci">struct mx_ops * child_ops</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00051">compress.c:51</a></div></div>
<div class="ttc" id="compress_8c_html_a804b29dcfdfaf4eb8a5ebfb7cb4213c8"><div class="ttname"><a href="compress_8c.html#a804b29dcfdfaf4eb8a5ebfb7cb4213c8">setup_paths</a></div><div class="ttdeci">static int setup_paths(CONTEXT *ctx)</div><div class="ttdoc">Set the mailbox paths : Mailbox to modify. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00145">compress.c:145</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1a2c2a59bce7cb7856db6011e0090fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1a2c2a59bce7cb7856db6011e0090fc">&#9670;&nbsp;</a></span>close_mailbox()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int close_mailbox </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Close a compressed mailbox : Mailbox to close. </p>
<p>If the mailbox has been changed then re-compress the tmp file. Then delete the tmp file.</p>
<p>Returns: 0: Success -1: Failure </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00610">610</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;{</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">if</span> (!ctx)</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordflow">if</span> (!ci)</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keyword">struct </span><a class="code" href="structmx__ops.html">mx_ops</a> *ops = ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">child_ops</a>;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordflow">if</span> (!ops)</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  ops-&gt;<a class="code" href="structmx__ops.html#a4945b64b2bd8df0320b4c267182852f7">close</a> (ctx);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="comment">/* sync has already been called, so we only need to delete some files */</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordflow">if</span> (!ctx-&gt;<a class="code" href="structCONTEXT.html#a0ccea147fe4657ac15a2a6b9498aac26">append</a>)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">/* If the file was removed, remove the compressed folder too */</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">if</span> ((access (ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>, F_OK) != 0) &amp;&amp; !<a class="code" href="mutt_8h.html#ae01642ac28c3b02ba17e0020477e90c1">option</a> (<a class="code" href="mutt_8h.html#a94798fdadfbf49a7c658ace669a1d310ae4c06a55ad322305b4ca3fe58dcc97a0">OPTSAVEEMPTY</a>))</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keyword">remove</span> (ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a>);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    {</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keyword">remove</span> (ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *append;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *msg;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="comment">/* The file exists and we can append */</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keywordflow">if</span> ((access (ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a>, F_OK) == 0) &amp;&amp; ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a3e03b4d1334a638d10276396cb200c0f">append</a>)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  {</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    append = ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a3e03b4d1334a638d10276396cb200c0f">append</a>;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    msg = <a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Compressed-appending to %s...&quot;</span>);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  {</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    append = ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">close</a>;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    msg = <a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Compressing %s...&quot;</span>);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordtype">int</span> rc = <a class="code" href="compress_8c.html#a9031d1b73f7ebb9b32878441bd7eedb2">execute_command</a> (ctx, append, msg);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordflow">if</span> (rc == 0)</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <a class="code" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a> (<a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Error. Preserving temporary file: %s&quot;</span>), ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keyword">remove</span> (ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <a class="code" href="compress_8c.html#ad02e220bbca8247f9b048092a07074bb">unlock_realpath</a> (ctx);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;}</div><div class="ttc" id="compress_8c_html_ad02e220bbca8247f9b048092a07074bb"><div class="ttname"><a href="compress_8c.html#ad02e220bbca8247f9b048092a07074bb">unlock_realpath</a></div><div class="ttdeci">static void unlock_realpath(CONTEXT *ctx)</div><div class="ttdoc">Unlock the ctx-&gt;realpath : Mailbox to unlock. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00114">compress.c:114</a></div></div>
<div class="ttc" id="explodename_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="explodename_8c_source.html#l00034">explodename.c:34</a></div></div>
<div class="ttc" id="structCONTEXT_html_a5dc77ea6580ac49ef1faf75e5bb85349"><div class="ttname"><a href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">CONTEXT::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01010">mutt.h:1010</a></div></div>
<div class="ttc" id="structmx__ops_html"><div class="ttname"><a href="structmx__ops.html">mx_ops</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00995">mutt.h:995</a></div></div>
<div class="ttc" id="structCONTEXT_html_a0ccea147fe4657ac15a2a6b9498aac26"><div class="ttname"><a href="structCONTEXT.html#a0ccea147fe4657ac15a2a6b9498aac26">CONTEXT::append</a></div><div class="ttdeci">unsigned int append</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01044">mutt.h:1044</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a6e6ff62d93d1861462036c895e43abfc"><div class="ttname"><a href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">COMPRESS_INFO::close</a></div><div class="ttdeci">const char * close</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00048">compress.c:48</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="mutt_8h_html_a94798fdadfbf49a7c658ace669a1d310ae4c06a55ad322305b4ca3fe58dcc97a0"><div class="ttname"><a href="mutt_8h.html#a94798fdadfbf49a7c658ace669a1d310ae4c06a55ad322305b4ca3fe58dcc97a0">OPTSAVEEMPTY</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00493">mutt.h:493</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a3e03b4d1334a638d10276396cb200c0f"><div class="ttname"><a href="structCOMPRESS__INFO.html#a3e03b4d1334a638d10276396cb200c0f">COMPRESS_INFO::append</a></div><div class="ttdeci">const char * append</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00047">compress.c:47</a></div></div>
<div class="ttc" id="mutt_8h_html_ae01642ac28c3b02ba17e0020477e90c1"><div class="ttname"><a href="mutt_8h.html#ae01642ac28c3b02ba17e0020477e90c1">option</a></div><div class="ttdeci">#define option(x)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00631">mutt.h:631</a></div></div>
<div class="ttc" id="extlib_8c_html_a90829ddbd5f0edf736c9f6e595cfc0be"><div class="ttname"><a href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a></div><div class="ttdeci">void(* mutt_error)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="extlib_8c_source.html#l00037">extlib.c:37</a></div></div>
<div class="ttc" id="compress_8c_html_a9031d1b73f7ebb9b32878441bd7eedb2"><div class="ttname"><a href="compress_8c.html#a9031d1b73f7ebb9b32878441bd7eedb2">execute_command</a></div><div class="ttdeci">static int execute_command(CONTEXT *ctx, const char *command, const char *progress)</div><div class="ttdoc">Run a system command : Mailbox to work with : Command string to execute : Message to show the user...</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00423">compress.c:423</a></div></div>
<div class="ttc" id="structCONTEXT_html_aa33eac2793b011daf40590752dfb9ddc"><div class="ttname"><a href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">CONTEXT::realpath</a></div><div class="ttdeci">char * realpath</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01011">mutt.h:1011</a></div></div>
<div class="ttc" id="curs__lib_8c_html_ab6a61cdfcf8c2c73ee59381c79c79774"><div class="ttname"><a href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a></div><div class="ttdeci">int mutt_any_key_to_continue(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00751">curs_lib.c:751</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a7374278fe8b8a87a1ceb32677da81f50"><div class="ttname"><a href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">COMPRESS_INFO::child_ops</a></div><div class="ttdeci">struct mx_ops * child_ops</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00051">compress.c:51</a></div></div>
<div class="ttc" id="structmx__ops_html_a4945b64b2bd8df0320b4c267182852f7"><div class="ttname"><a href="structmx__ops.html#a4945b64b2bd8df0320b4c267182852f7">mx_ops::close</a></div><div class="ttdeci">int(* close)(struct _context *)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00999">mutt.h:999</a></div></div>
<div class="ttc" id="structCONTEXT_html_a97a63c10344e36eacb10be318022b198"><div class="ttname"><a href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">CONTEXT::compress_info</a></div><div class="ttdeci">void * compress_info</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01051">mutt.h:1051</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6babf155ed54215ecd27a93fae8fb45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6babf155ed54215ecd27a93fae8fb45">&#9670;&nbsp;</a></span>check_mailbox()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int check_mailbox </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>index_hint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check for changes in the compressed file : Mailbox. </p>
<p>If the compressed file changes in size but the mailbox hasn't been changed in Mutt, then we can close and reopen the mailbox.</p>
<p>If the mailbox has been changed in Mutt, warn the user.</p>
<p>The return codes are picked to match <a class="el" href="mailbox_8h.html#ae83f34cd26d6c81c8ce900d1f0e394ee">mx_check_mailbox()</a>.</p>
<p>Returns: 0: Mailbox OK MUTT_REOPENED: The mailbox was closed and reopened -1: Mailbox bad </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00687">687</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;{</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keywordflow">if</span> (!ctx)</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">if</span> (!ci)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keyword">struct </span><a class="code" href="structmx__ops.html">mx_ops</a> *ops = ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">child_ops</a>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="keywordflow">if</span> (!ops)</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordtype">int</span> size = <a class="code" href="compress_8c.html#aef351258938e8f659c65e9e925bf3ef2">get_size</a> (ctx-&gt;<a class="code" href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">realpath</a>);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordflow">if</span> (size == ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6b5072dfe620abb24f2a96356de6cd72">size</a>)</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="compress_8c.html#afe8cd0103ee2736842782ff97d3cf300">lock_realpath</a> (ctx, 0))</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  {</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Unable to lock mailbox!&quot;</span>));</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  }</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordtype">int</span> rc = <a class="code" href="compress_8c.html#a9031d1b73f7ebb9b32878441bd7eedb2">execute_command</a> (ctx, ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a752d1c082026693bbcf1c21db35df6dc">open</a>, <a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Decompressing %s&quot;</span>));</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <a class="code" href="compress_8c.html#a66135b1e3433cc07352b16bd8463db74">store_size</a> (ctx);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <a class="code" href="compress_8c.html#ad02e220bbca8247f9b048092a07074bb">unlock_realpath</a> (ctx);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keywordflow">if</span> (rc == 0)</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordflow">return</span> ops-&gt;<a class="code" href="structmx__ops.html#ae72e5d8656cd7a629aaa6d2a36d0a2fd">check</a> (ctx, index_hint);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;}</div><div class="ttc" id="compress_8c_html_ad02e220bbca8247f9b048092a07074bb"><div class="ttname"><a href="compress_8c.html#ad02e220bbca8247f9b048092a07074bb">unlock_realpath</a></div><div class="ttdeci">static void unlock_realpath(CONTEXT *ctx)</div><div class="ttdoc">Unlock the ctx-&gt;realpath : Mailbox to unlock. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00114">compress.c:114</a></div></div>
<div class="ttc" id="compress_8c_html_aef351258938e8f659c65e9e925bf3ef2"><div class="ttname"><a href="compress_8c.html#aef351258938e8f659c65e9e925bf3ef2">get_size</a></div><div class="ttdeci">static int get_size(const char *path)</div><div class="ttdoc">Get the size of a file : File to measure. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00177">compress.c:177</a></div></div>
<div class="ttc" id="structmx__ops_html"><div class="ttname"><a href="structmx__ops.html">mx_ops</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00995">mutt.h:995</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a6b5072dfe620abb24f2a96356de6cd72"><div class="ttname"><a href="structCOMPRESS__INFO.html#a6b5072dfe620abb24f2a96356de6cd72">COMPRESS_INFO::size</a></div><div class="ttdeci">off_t size</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00050">compress.c:50</a></div></div>
<div class="ttc" id="extlib_8c_html_a90829ddbd5f0edf736c9f6e595cfc0be"><div class="ttname"><a href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a></div><div class="ttdeci">void(* mutt_error)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="extlib_8c_source.html#l00037">extlib.c:37</a></div></div>
<div class="ttc" id="structmx__ops_html_ae72e5d8656cd7a629aaa6d2a36d0a2fd"><div class="ttname"><a href="structmx__ops.html#ae72e5d8656cd7a629aaa6d2a36d0a2fd">mx_ops::check</a></div><div class="ttdeci">int(* check)(struct _context *ctx, int *index_hint)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01000">mutt.h:1000</a></div></div>
<div class="ttc" id="compress_8c_html_a9031d1b73f7ebb9b32878441bd7eedb2"><div class="ttname"><a href="compress_8c.html#a9031d1b73f7ebb9b32878441bd7eedb2">execute_command</a></div><div class="ttdeci">static int execute_command(CONTEXT *ctx, const char *command, const char *progress)</div><div class="ttdoc">Run a system command : Mailbox to work with : Command string to execute : Message to show the user...</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00423">compress.c:423</a></div></div>
<div class="ttc" id="compress_8c_html_afe8cd0103ee2736842782ff97d3cf300"><div class="ttname"><a href="compress_8c.html#afe8cd0103ee2736842782ff97d3cf300">lock_realpath</a></div><div class="ttdeci">static int lock_realpath(CONTEXT *ctx, int excl)</div><div class="ttdoc">Try to lock the ctx-&gt;realpath : Mailbox to lock : Lock exclusively? </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00071">compress.c:71</a></div></div>
<div class="ttc" id="structCONTEXT_html_aa33eac2793b011daf40590752dfb9ddc"><div class="ttname"><a href="structCONTEXT.html#aa33eac2793b011daf40590752dfb9ddc">CONTEXT::realpath</a></div><div class="ttdeci">char * realpath</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01011">mutt.h:1011</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a752d1c082026693bbcf1c21db35df6dc"><div class="ttname"><a href="structCOMPRESS__INFO.html#a752d1c082026693bbcf1c21db35df6dc">COMPRESS_INFO::open</a></div><div class="ttdeci">const char * open</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00049">compress.c:49</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a7374278fe8b8a87a1ceb32677da81f50"><div class="ttname"><a href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">COMPRESS_INFO::child_ops</a></div><div class="ttdeci">struct mx_ops * child_ops</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00051">compress.c:51</a></div></div>
<div class="ttc" id="compress_8c_html_a66135b1e3433cc07352b16bd8463db74"><div class="ttname"><a href="compress_8c.html#a66135b1e3433cc07352b16bd8463db74">store_size</a></div><div class="ttdeci">static void store_size(const CONTEXT *ctx)</div><div class="ttdoc">Save the size of the compressed file : Mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00196">compress.c:196</a></div></div>
<div class="ttc" id="structCONTEXT_html_a97a63c10344e36eacb10be318022b198"><div class="ttname"><a href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">CONTEXT::compress_info</a></div><div class="ttdeci">void * compress_info</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01051">mutt.h:1051</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5232331c813fe71f4ea930ec99101246"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5232331c813fe71f4ea930ec99101246">&#9670;&nbsp;</a></span>open_message()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int open_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMESSAGE.html">MESSAGE</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>msgno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Delegated to mbox handler. </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00724">724</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;{</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="keywordflow">if</span> (!ctx)</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordflow">if</span> (!ci)</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keyword">struct </span><a class="code" href="structmx__ops.html">mx_ops</a> *ops = ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">child_ops</a>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordflow">if</span> (!ops)</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="comment">/* Delegate */</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">return</span> ops-&gt;<a class="code" href="structmx__ops.html#abd6f498813aabe161c7d875a18b740ca">open_msg</a> (ctx, msg, msgno);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;}</div><div class="ttc" id="structmx__ops_html_abd6f498813aabe161c7d875a18b740ca"><div class="ttname"><a href="structmx__ops.html#abd6f498813aabe161c7d875a18b740ca">mx_ops::open_msg</a></div><div class="ttdeci">int(* open_msg)(struct _context *, struct _message *, int msgno)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01002">mutt.h:1002</a></div></div>
<div class="ttc" id="structmx__ops_html"><div class="ttname"><a href="structmx__ops.html">mx_ops</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00995">mutt.h:995</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a7374278fe8b8a87a1ceb32677da81f50"><div class="ttname"><a href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">COMPRESS_INFO::child_ops</a></div><div class="ttdeci">struct mx_ops * child_ops</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00051">compress.c:51</a></div></div>
<div class="ttc" id="structCONTEXT_html_a97a63c10344e36eacb10be318022b198"><div class="ttname"><a href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">CONTEXT::compress_info</a></div><div class="ttdeci">void * compress_info</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01051">mutt.h:1051</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87dfb73561a1ecd40ab143cc855a571a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87dfb73561a1ecd40ab143cc855a571a">&#9670;&nbsp;</a></span>close_message()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int close_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMESSAGE.html">MESSAGE</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Delegated to mbox handler. </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00745">745</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;{</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="keywordflow">if</span> (!ctx)</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="keywordflow">if</span> (!ci)</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keyword">struct </span><a class="code" href="structmx__ops.html">mx_ops</a> *ops = ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">child_ops</a>;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">if</span> (!ops)</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="comment">/* Delegate */</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">return</span> ops-&gt;<a class="code" href="structmx__ops.html#ad013a5946e628fb3fbc0f6b0b9605a54">close_msg</a> (ctx, msg);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;}</div><div class="ttc" id="structmx__ops_html_ad013a5946e628fb3fbc0f6b0b9605a54"><div class="ttname"><a href="structmx__ops.html#ad013a5946e628fb3fbc0f6b0b9605a54">mx_ops::close_msg</a></div><div class="ttdeci">int(* close_msg)(struct _context *, struct _message *)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01003">mutt.h:1003</a></div></div>
<div class="ttc" id="structmx__ops_html"><div class="ttname"><a href="structmx__ops.html">mx_ops</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00995">mutt.h:995</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a7374278fe8b8a87a1ceb32677da81f50"><div class="ttname"><a href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">COMPRESS_INFO::child_ops</a></div><div class="ttdeci">struct mx_ops * child_ops</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00051">compress.c:51</a></div></div>
<div class="ttc" id="structCONTEXT_html_a97a63c10344e36eacb10be318022b198"><div class="ttname"><a href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">CONTEXT::compress_info</a></div><div class="ttdeci">void * compress_info</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01051">mutt.h:1051</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b514370d6f708885d67bf537f8bb9f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b514370d6f708885d67bf537f8bb9f4">&#9670;&nbsp;</a></span>commit_message()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int commit_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMESSAGE.html">MESSAGE</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Delegated to mbox handler. </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00766">766</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;{</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="keywordflow">if</span> (!ctx)</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="keywordflow">if</span> (!ci)</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keyword">struct </span><a class="code" href="structmx__ops.html">mx_ops</a> *ops = ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">child_ops</a>;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordflow">if</span> (!ops)</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="comment">/* Delegate */</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="keywordflow">return</span> ops-&gt;<a class="code" href="structmx__ops.html#af32c50189c1c5f6752d177bbcbf5431f">commit_msg</a> (ctx, msg);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;}</div><div class="ttc" id="structmx__ops_html"><div class="ttname"><a href="structmx__ops.html">mx_ops</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00995">mutt.h:995</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a7374278fe8b8a87a1ceb32677da81f50"><div class="ttname"><a href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">COMPRESS_INFO::child_ops</a></div><div class="ttdeci">struct mx_ops * child_ops</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00051">compress.c:51</a></div></div>
<div class="ttc" id="structmx__ops_html_af32c50189c1c5f6752d177bbcbf5431f"><div class="ttname"><a href="structmx__ops.html#af32c50189c1c5f6752d177bbcbf5431f">mx_ops::commit_msg</a></div><div class="ttdeci">int(* commit_msg)(struct _context *, struct _message *)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01004">mutt.h:1004</a></div></div>
<div class="ttc" id="structCONTEXT_html_a97a63c10344e36eacb10be318022b198"><div class="ttname"><a href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">CONTEXT::compress_info</a></div><div class="ttdeci">void * compress_info</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01051">mutt.h:1051</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a60f6006c9ac04a68d73218dce2e13e98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60f6006c9ac04a68d73218dce2e13e98">&#9670;&nbsp;</a></span>open_new_message()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int open_new_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMESSAGE.html">MESSAGE</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHEADER.html">HEADER</a> *&#160;</td>
          <td class="paramname"><em>hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Delegated to mbox handler. </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00787">787</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;{</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordflow">if</span> (!ctx)</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">if</span> (!ci)</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keyword">struct </span><a class="code" href="structmx__ops.html">mx_ops</a> *ops = ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">child_ops</a>;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordflow">if</span> (!ops)</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="comment">/* Delegate */</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordflow">return</span> ops-&gt;<a class="code" href="structmx__ops.html#a76da48bafa6f503600a016e7449832fe">open_new_msg</a> (msg, ctx, hdr);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;}</div><div class="ttc" id="structmx__ops_html"><div class="ttname"><a href="structmx__ops.html">mx_ops</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00995">mutt.h:995</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a7374278fe8b8a87a1ceb32677da81f50"><div class="ttname"><a href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">COMPRESS_INFO::child_ops</a></div><div class="ttdeci">struct mx_ops * child_ops</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00051">compress.c:51</a></div></div>
<div class="ttc" id="structmx__ops_html_a76da48bafa6f503600a016e7449832fe"><div class="ttname"><a href="structmx__ops.html#a76da48bafa6f503600a016e7449832fe">mx_ops::open_new_msg</a></div><div class="ttdeci">int(* open_new_msg)(struct _message *, struct _context *, HEADER *)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01005">mutt.h:1005</a></div></div>
<div class="ttc" id="structCONTEXT_html_a97a63c10344e36eacb10be318022b198"><div class="ttname"><a href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">CONTEXT::compress_info</a></div><div class="ttdeci">void * compress_info</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01051">mutt.h:1051</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a001813a1c455c618868239b9154487aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a001813a1c455c618868239b9154487aa">&#9670;&nbsp;</a></span>mutt_comp_can_append()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_comp_can_append </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Can we append to this path? : pathname of file to be tested. </p>
<p>To append to a file we can either use an 'append-hook' or a combination of 'open-hook' and 'close-hook'.</p>
<p>A match means it's our responsibility to append to the file.</p>
<p>Returns: 1: Yes, we can append to the file 0: No, appending isn't possible </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00819">819</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;{</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="keywordflow">if</span> (!ctx)</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="comment">/* If this succeeds, we know there&#39;s an open-hook */</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = <a class="code" href="compress_8c.html#a909545bed7377d2c98b787ef173162cc">set_compress_info</a> (ctx);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="keywordflow">if</span> (!ci)</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="comment">/* We have an open-hook, so to append we need an append-hook,</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">   * or a close-hook. */</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keywordflow">if</span> (ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a3e03b4d1334a638d10276396cb200c0f">append</a> || ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">close</a>)</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Cannot append without an append-hook or close-hook : %s&quot;</span>), ctx-&gt;<a class="code" href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">path</a>);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;}</div><div class="ttc" id="compress_8c_html_a909545bed7377d2c98b787ef173162cc"><div class="ttname"><a href="compress_8c.html#a909545bed7377d2c98b787ef173162cc">set_compress_info</a></div><div class="ttdeci">static COMPRESS_INFO * set_compress_info(CONTEXT *ctx)</div><div class="ttdoc">Find the compress hooks for a mailbox : Mailbox to examine. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00250">compress.c:250</a></div></div>
<div class="ttc" id="structCONTEXT_html_a5dc77ea6580ac49ef1faf75e5bb85349"><div class="ttname"><a href="structCONTEXT.html#a5dc77ea6580ac49ef1faf75e5bb85349">CONTEXT::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01010">mutt.h:1010</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a6e6ff62d93d1861462036c895e43abfc"><div class="ttname"><a href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">COMPRESS_INFO::close</a></div><div class="ttdeci">const char * close</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00048">compress.c:48</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a3e03b4d1334a638d10276396cb200c0f"><div class="ttname"><a href="structCOMPRESS__INFO.html#a3e03b4d1334a638d10276396cb200c0f">COMPRESS_INFO::append</a></div><div class="ttdeci">const char * append</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00047">compress.c:47</a></div></div>
<div class="ttc" id="extlib_8c_html_a90829ddbd5f0edf736c9f6e595cfc0be"><div class="ttname"><a href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a></div><div class="ttdeci">void(* mutt_error)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="extlib_8c_source.html#l00037">extlib.c:37</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a160490f9047fab7fc16837cab8992427"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a160490f9047fab7fc16837cab8992427">&#9670;&nbsp;</a></span>mutt_comp_can_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_comp_can_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Can we read from this file? : Pathname of file to be tested. </p>
<p>Search for an 'open-hook' with a regex that matches the path.</p>
<p>A match means it's our responsibility to open the file.</p>
<p>Returns: 1: Yes, we can read the file 0: No, we cannot read the file </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00851">851</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;{</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keywordflow">if</span> (!path)</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="compress_8c.html#a43803535152ad5c75657dbc93b036786">find_hook</a> (<a class="code" href="mutt_8h.html#abffdc7d595ce7738f067dda3552e9260">MUTT_OPENHOOK</a>, path))</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;}</div><div class="ttc" id="mutt_8h_html_abffdc7d595ce7738f067dda3552e9260"><div class="ttname"><a href="mutt_8h.html#abffdc7d595ce7738f067dda3552e9260">MUTT_OPENHOOK</a></div><div class="ttdeci">#define MUTT_OPENHOOK</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00163">mutt.h:163</a></div></div>
<div class="ttc" id="compress_8c_html_a43803535152ad5c75657dbc93b036786"><div class="ttname"><a href="compress_8c.html#a43803535152ad5c75657dbc93b036786">find_hook</a></div><div class="ttdeci">static const char * find_hook(int type, const char *path)</div><div class="ttdoc">Find a hook to match a path : Type of hook, e.g. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00227">compress.c:227</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab327914fd4d8b132c3ef4ec7680a484e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab327914fd4d8b132c3ef4ec7680a484e">&#9670;&nbsp;</a></span>sync_mailbox()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sync_mailbox </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONTEXT.html">CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>index_hint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save changes to the compressed mailbox file : Mailbox to sync. </p>
<p>Changes in Mutt only affect the tmp file. Calling <a class="el" href="compress_8c.html#ab327914fd4d8b132c3ef4ec7680a484e" title="Save changes to the compressed mailbox file : Mailbox to sync. ">sync_mailbox()</a> will commit them to the compressed file.</p>
<p>Returns: 0: Success -1: Failure </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00874">874</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;{</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">if</span> (!ctx)</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <a class="code" href="structCOMPRESS__INFO.html">COMPRESS_INFO</a> *ci = ctx-&gt;<a class="code" href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">compress_info</a>;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordflow">if</span> (!ci)</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keywordflow">if</span> (!ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">close</a>)</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t sync a compressed file without a close-hook&quot;</span>));</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  }</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="keyword">struct </span><a class="code" href="structmx__ops.html">mx_ops</a> *ops = ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">child_ops</a>;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="keywordflow">if</span> (!ops)</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="compress_8c.html#afe8cd0103ee2736842782ff97d3cf300">lock_realpath</a> (ctx, 1))</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Unable to lock mailbox!&quot;</span>));</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  }</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="keywordtype">int</span> rc = <a class="code" href="compress_8c.html#ac6babf155ed54215ecd27a93fae8fb45">check_mailbox</a> (ctx, index_hint);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="keywordflow">if</span> (rc != 0)</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">goto</span> sync_cleanup;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  rc = ops-&gt;<a class="code" href="structmx__ops.html#a582c2d966e7298d1aecb2f93bd999304">sync</a> (ctx, index_hint);</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="keywordflow">if</span> (rc != 0)</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">goto</span> sync_cleanup;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  rc = <a class="code" href="compress_8c.html#a9031d1b73f7ebb9b32878441bd7eedb2">execute_command</a> (ctx, ci-&gt;<a class="code" href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">close</a>, <a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Compressing %s&quot;</span>));</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="keywordflow">if</span> (rc == 0)</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    rc = -1;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">goto</span> sync_cleanup;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  }</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  rc = 0;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;sync_cleanup:</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <a class="code" href="compress_8c.html#a66135b1e3433cc07352b16bd8463db74">store_size</a> (ctx);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <a class="code" href="compress_8c.html#ad02e220bbca8247f9b048092a07074bb">unlock_realpath</a> (ctx);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;}</div><div class="ttc" id="compress_8c_html_ad02e220bbca8247f9b048092a07074bb"><div class="ttname"><a href="compress_8c.html#ad02e220bbca8247f9b048092a07074bb">unlock_realpath</a></div><div class="ttdeci">static void unlock_realpath(CONTEXT *ctx)</div><div class="ttdoc">Unlock the ctx-&gt;realpath : Mailbox to unlock. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00114">compress.c:114</a></div></div>
<div class="ttc" id="structmx__ops_html_a582c2d966e7298d1aecb2f93bd999304"><div class="ttname"><a href="structmx__ops.html#a582c2d966e7298d1aecb2f93bd999304">mx_ops::sync</a></div><div class="ttdeci">int(* sync)(struct _context *ctx, int *index_hint)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01001">mutt.h:1001</a></div></div>
<div class="ttc" id="structmx__ops_html"><div class="ttname"><a href="structmx__ops.html">mx_ops</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00995">mutt.h:995</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a6e6ff62d93d1861462036c895e43abfc"><div class="ttname"><a href="structCOMPRESS__INFO.html#a6e6ff62d93d1861462036c895e43abfc">COMPRESS_INFO::close</a></div><div class="ttdeci">const char * close</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00048">compress.c:48</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html"><div class="ttname"><a href="structCOMPRESS__INFO.html">COMPRESS_INFO</a></div><div class="ttdoc">Private data for compress. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00045">compress.c:45</a></div></div>
<div class="ttc" id="compress_8c_html_ac6babf155ed54215ecd27a93fae8fb45"><div class="ttname"><a href="compress_8c.html#ac6babf155ed54215ecd27a93fae8fb45">check_mailbox</a></div><div class="ttdeci">static int check_mailbox(CONTEXT *ctx, int *index_hint)</div><div class="ttdoc">Check for changes in the compressed file : Mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00687">compress.c:687</a></div></div>
<div class="ttc" id="extlib_8c_html_a90829ddbd5f0edf736c9f6e595cfc0be"><div class="ttname"><a href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a></div><div class="ttdeci">void(* mutt_error)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="extlib_8c_source.html#l00037">extlib.c:37</a></div></div>
<div class="ttc" id="compress_8c_html_a9031d1b73f7ebb9b32878441bd7eedb2"><div class="ttname"><a href="compress_8c.html#a9031d1b73f7ebb9b32878441bd7eedb2">execute_command</a></div><div class="ttdeci">static int execute_command(CONTEXT *ctx, const char *command, const char *progress)</div><div class="ttdoc">Run a system command : Mailbox to work with : Command string to execute : Message to show the user...</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00423">compress.c:423</a></div></div>
<div class="ttc" id="compress_8c_html_afe8cd0103ee2736842782ff97d3cf300"><div class="ttname"><a href="compress_8c.html#afe8cd0103ee2736842782ff97d3cf300">lock_realpath</a></div><div class="ttdeci">static int lock_realpath(CONTEXT *ctx, int excl)</div><div class="ttdoc">Try to lock the ctx-&gt;realpath : Mailbox to lock : Lock exclusively? </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00071">compress.c:71</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="structCOMPRESS__INFO_html_a7374278fe8b8a87a1ceb32677da81f50"><div class="ttname"><a href="structCOMPRESS__INFO.html#a7374278fe8b8a87a1ceb32677da81f50">COMPRESS_INFO::child_ops</a></div><div class="ttdeci">struct mx_ops * child_ops</div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00051">compress.c:51</a></div></div>
<div class="ttc" id="compress_8c_html_a66135b1e3433cc07352b16bd8463db74"><div class="ttname"><a href="compress_8c.html#a66135b1e3433cc07352b16bd8463db74">store_size</a></div><div class="ttdeci">static void store_size(const CONTEXT *ctx)</div><div class="ttdoc">Save the size of the compressed file : Mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00196">compress.c:196</a></div></div>
<div class="ttc" id="structCONTEXT_html_a97a63c10344e36eacb10be318022b198"><div class="ttname"><a href="structCONTEXT.html#a97a63c10344e36eacb10be318022b198">CONTEXT::compress_info</a></div><div class="ttdeci">void * compress_info</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l01051">mutt.h:1051</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab77ea42f102d3aced8ea915e95a83bd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab77ea42f102d3aced8ea915e95a83bd4">&#9670;&nbsp;</a></span>mutt_comp_valid_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_comp_valid_command </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>cmd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is this command string allowed? : Command string. </p>
<p>A valid command string must have both "%f" (from file) and "%t" (to file). We don't check if we can actually run the command.</p>
<p>Returns: 1: Valid command 0: "%f" and/or "%t" is missing </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00934">934</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;{</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordflow">if</span> (!cmd)</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="keywordflow">return</span> (strstr (cmd, <span class="stringliteral">&quot;%f&quot;</span>) &amp;&amp; strstr (cmd, <span class="stringliteral">&quot;%t&quot;</span>));</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a42c0fbc4fb4b2d4fd495bc815271ca7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42c0fbc4fb4b2d4fd495bc815271ca7d">&#9670;&nbsp;</a></span>mx_comp_ops</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structmx__ops.html">mx_ops</a> mx_comp_ops</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div><div class="line">{</div><div class="line">  .open         = <a class="code" href="compress_8c.html#a3f58c5d1c5690258d1e44930d4bc7ed9">open_mailbox</a>,</div><div class="line">  .open_append  = <a class="code" href="compress_8c.html#a5ac021d4af3de65b7ca4de32af878ec2">open_append_mailbox</a>,</div><div class="line">  .close        = <a class="code" href="compress_8c.html#ae1a2c2a59bce7cb7856db6011e0090fc">close_mailbox</a>,</div><div class="line">  .check        = <a class="code" href="compress_8c.html#ac6babf155ed54215ecd27a93fae8fb45">check_mailbox</a>,</div><div class="line">  .sync         = <a class="code" href="compress_8c.html#ab327914fd4d8b132c3ef4ec7680a484e">sync_mailbox</a>,</div><div class="line">  .open_msg     = <a class="code" href="compress_8c.html#a5232331c813fe71f4ea930ec99101246">open_message</a>,</div><div class="line">  .close_msg    = <a class="code" href="compress_8c.html#a87dfb73561a1ecd40ab143cc855a571a">close_message</a>,</div><div class="line">  .commit_msg   = <a class="code" href="compress_8c.html#a3b514370d6f708885d67bf537f8bb9f4">commit_message</a>,</div><div class="line">  .open_new_msg = <a class="code" href="compress_8c.html#a60f6006c9ac04a68d73218dce2e13e98">open_new_message</a></div><div class="line">}</div><div class="ttc" id="compress_8c_html_ae1a2c2a59bce7cb7856db6011e0090fc"><div class="ttname"><a href="compress_8c.html#ae1a2c2a59bce7cb7856db6011e0090fc">close_mailbox</a></div><div class="ttdeci">static int close_mailbox(CONTEXT *ctx)</div><div class="ttdoc">Close a compressed mailbox : Mailbox to close. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00610">compress.c:610</a></div></div>
<div class="ttc" id="compress_8c_html_a5232331c813fe71f4ea930ec99101246"><div class="ttname"><a href="compress_8c.html#a5232331c813fe71f4ea930ec99101246">open_message</a></div><div class="ttdeci">static int open_message(CONTEXT *ctx, MESSAGE *msg, int msgno)</div><div class="ttdoc">Delegated to mbox handler. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00724">compress.c:724</a></div></div>
<div class="ttc" id="compress_8c_html_ac6babf155ed54215ecd27a93fae8fb45"><div class="ttname"><a href="compress_8c.html#ac6babf155ed54215ecd27a93fae8fb45">check_mailbox</a></div><div class="ttdeci">static int check_mailbox(CONTEXT *ctx, int *index_hint)</div><div class="ttdoc">Check for changes in the compressed file : Mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00687">compress.c:687</a></div></div>
<div class="ttc" id="compress_8c_html_a5ac021d4af3de65b7ca4de32af878ec2"><div class="ttname"><a href="compress_8c.html#a5ac021d4af3de65b7ca4de32af878ec2">open_append_mailbox</a></div><div class="ttdeci">static int open_append_mailbox(CONTEXT *ctx, int flags)</div><div class="ttdoc">Open a compressed mailbox for appending : Mailbox to open : e.g. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00527">compress.c:527</a></div></div>
<div class="ttc" id="compress_8c_html_ab327914fd4d8b132c3ef4ec7680a484e"><div class="ttname"><a href="compress_8c.html#ab327914fd4d8b132c3ef4ec7680a484e">sync_mailbox</a></div><div class="ttdeci">static int sync_mailbox(CONTEXT *ctx, int *index_hint)</div><div class="ttdoc">Save changes to the compressed mailbox file : Mailbox to sync. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00874">compress.c:874</a></div></div>
<div class="ttc" id="compress_8c_html_a3b514370d6f708885d67bf537f8bb9f4"><div class="ttname"><a href="compress_8c.html#a3b514370d6f708885d67bf537f8bb9f4">commit_message</a></div><div class="ttdeci">static int commit_message(CONTEXT *ctx, MESSAGE *msg)</div><div class="ttdoc">Delegated to mbox handler. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00766">compress.c:766</a></div></div>
<div class="ttc" id="compress_8c_html_a87dfb73561a1ecd40ab143cc855a571a"><div class="ttname"><a href="compress_8c.html#a87dfb73561a1ecd40ab143cc855a571a">close_message</a></div><div class="ttdeci">static int close_message(CONTEXT *ctx, MESSAGE *msg)</div><div class="ttdoc">Delegated to mbox handler. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00745">compress.c:745</a></div></div>
<div class="ttc" id="compress_8c_html_a3f58c5d1c5690258d1e44930d4bc7ed9"><div class="ttname"><a href="compress_8c.html#a3f58c5d1c5690258d1e44930d4bc7ed9">open_mailbox</a></div><div class="ttdeci">static int open_mailbox(CONTEXT *ctx)</div><div class="ttdoc">Open a compressed mailbox : Mailbox to open. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00462">compress.c:462</a></div></div>
<div class="ttc" id="compress_8c_html_a60f6006c9ac04a68d73218dce2e13e98"><div class="ttname"><a href="compress_8c.html#a60f6006c9ac04a68d73218dce2e13e98">open_new_message</a></div><div class="ttdeci">static int open_new_message(MESSAGE *msg, CONTEXT *ctx, HEADER *hdr)</div><div class="ttdoc">Delegated to mbox handler. </div><div class="ttdef"><b>Definition:</b> <a href="compress_8c_source.html#l00787">compress.c:787</a></div></div>
</div><!-- fragment -->
<p>Mailbox callback functions. </p>
<p>Compress only uses open, close and check. The message functions are delegated to mbox. </p>

<p class="definition">Definition at line <a class="el" href="compress_8c_source.html#l00949">949</a> of file <a class="el" href="compress_8c_source.html">compress.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
