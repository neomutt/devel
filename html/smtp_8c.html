<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: smtp.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mutt.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">1.7.1</span>
   </div>
   <div id="projectbrief">Mail Reader</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">smtp.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="mutt_8h_source.html">mutt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mutt__curses_8h_source.html">mutt_curses.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mutt__socket_8h_source.html">mutt_socket.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mutt__sasl_8h_source.html">mutt_sasl.h</a>&quot;</code><br />
<code>#include &lt;sasl/sasl.h&gt;</code><br />
<code>#include &lt;sasl/saslutil.h&gt;</code><br />
<code>#include &lt;netdb.h&gt;</code><br />
<code>#include &lt;netinet/in.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
</div>
<p><a href="smtp_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a816bd1f7035855b6c4c4132b64571155"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a816bd1f7035855b6c4c4132b64571155">smtp_success</a>(x)&#160;&#160;&#160;((x)/100 == 2)</td></tr>
<tr class="separator:a816bd1f7035855b6c4c4132b64571155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f4e60f061c8059e4fac6b0f3b9f1057"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a3f4e60f061c8059e4fac6b0f3b9f1057">smtp_ready</a>&#160;&#160;&#160;334</td></tr>
<tr class="separator:a3f4e60f061c8059e4fac6b0f3b9f1057"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44a8faa29de46504ffad57d4f20b0487"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a44a8faa29de46504ffad57d4f20b0487">smtp_continue</a>&#160;&#160;&#160;354</td></tr>
<tr class="separator:a44a8faa29de46504ffad57d4f20b0487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03a78f4a9181af45cac263f2a313e474"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a03a78f4a9181af45cac263f2a313e474">smtp_err_read</a>&#160;&#160;&#160;-2</td></tr>
<tr class="separator:a03a78f4a9181af45cac263f2a313e474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1816449b160df247d202072e542a32a1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a>&#160;&#160;&#160;-3</td></tr>
<tr class="separator:a1816449b160df247d202072e542a32a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cb3d0a3a556014703d33a0b3cafa3e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a2cb3d0a3a556014703d33a0b3cafa3e5">smtp_err_code</a>&#160;&#160;&#160;-4</td></tr>
<tr class="separator:a2cb3d0a3a556014703d33a0b3cafa3e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6437be0fedb9dacef3a6b33d165ad8a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#af6437be0fedb9dacef3a6b33d165ad8a">SMTP_PORT</a>&#160;&#160;&#160;25</td></tr>
<tr class="separator:af6437be0fedb9dacef3a6b33d165ad8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e4660473a1ca02835a4b22e1ddb048f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a0e4660473a1ca02835a4b22e1ddb048f">SMTPS_PORT</a>&#160;&#160;&#160;465</td></tr>
<tr class="separator:a0e4660473a1ca02835a4b22e1ddb048f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9eefbe288d30f6c851eb53feace74cb3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a9eefbe288d30f6c851eb53feace74cb3">SMTP_AUTH_SUCCESS</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a9eefbe288d30f6c851eb53feace74cb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a636ce31e9faba3f7e620a8f7809252eb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a636ce31e9faba3f7e620a8f7809252eb">SMTP_AUTH_UNAVAIL</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a636ce31e9faba3f7e620a8f7809252eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84d8e78e08aaa71820593b38ac4e88cb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a84d8e78e08aaa71820593b38ac4e88cb">SMTP_AUTH_FAIL</a>&#160;&#160;&#160;-1</td></tr>
<tr class="separator:a84d8e78e08aaa71820593b38ac4e88cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a458e651af6690959efa2afb96be7d609"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609ae7cc0b2670caf4784fa8209e95971757">STARTTLS</a>, 
<a class="el" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a8b22fbb60fcbd7a4a5e1e6ff6ee38218">AUTH</a>, 
<a class="el" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd">DSN</a>, 
<a class="el" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a81b701d65406433d3b37bb2057213266">EIGHTBITMIME</a>, 
<br />
&#160;&#160;<a class="el" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a11ab51c9490b3f390e650b8826dc1fe4">SMTPUTF8</a>, 
<a class="el" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a59d924fd58cee243d7b1a29267e4bff4">CAPMAX</a>
<br />
 }</td></tr>
<tr class="separator:a458e651af6690959efa2afb96be7d609"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a834b9cb0cab80c145b9c4366f3e97160"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a834b9cb0cab80c145b9c4366f3e97160">smtp_auth</a> (<a class="el" href="structCONNECTION.html">CONNECTION</a> *conn)</td></tr>
<tr class="separator:a834b9cb0cab80c145b9c4366f3e97160"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2004bab178b66fa0b3db7caf610d1d9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#ad2004bab178b66fa0b3db7caf610d1d9">smtp_auth_sasl</a> (<a class="el" href="structCONNECTION.html">CONNECTION</a> *conn, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *mechanisms)</td></tr>
<tr class="separator:ad2004bab178b66fa0b3db7caf610d1d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a75505bd53f738baa45179f85c970b3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a9a75505bd53f738baa45179f85c970b3">smtp_fill_account</a> (<a class="el" href="structACCOUNT.html">ACCOUNT</a> *account)</td></tr>
<tr class="separator:a9a75505bd53f738baa45179f85c970b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0de44525c1ea8977b943f3fb86386bf2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a0de44525c1ea8977b943f3fb86386bf2">smtp_open</a> (<a class="el" href="structCONNECTION.html">CONNECTION</a> *conn)</td></tr>
<tr class="separator:a0de44525c1ea8977b943f3fb86386bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cf87569e236ca82851ae2afd70655bd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a5cf87569e236ca82851ae2afd70655bd">smtp_code</a> (char *buf, size_t len, int *<a class="el" href="ngettext_8c.html#a58257445f1a929304e537613b62ebb35">n</a>)</td></tr>
<tr class="separator:a5cf87569e236ca82851ae2afd70655bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89fdbb31e8fca646b1415e9fda4a48cf"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a89fdbb31e8fca646b1415e9fda4a48cf">smtp_get_resp</a> (<a class="el" href="structCONNECTION.html">CONNECTION</a> *conn)</td></tr>
<tr class="separator:a89fdbb31e8fca646b1415e9fda4a48cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4573858e2fd480944bb8fa81d0ca8784"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a4573858e2fd480944bb8fa81d0ca8784">smtp_rcpt_to</a> (<a class="el" href="structCONNECTION.html">CONNECTION</a> *conn, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structADDRESS.html">ADDRESS</a> *a)</td></tr>
<tr class="separator:a4573858e2fd480944bb8fa81d0ca8784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a043b2ff2473aeb7e19afb585ee1957af"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a043b2ff2473aeb7e19afb585ee1957af">smtp_data</a> (<a class="el" href="structCONNECTION.html">CONNECTION</a> *conn, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *msgfile)</td></tr>
<tr class="separator:a043b2ff2473aeb7e19afb585ee1957af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7052392c4bab85f8e0b231617a3f5312"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a7052392c4bab85f8e0b231617a3f5312">address_uses_unicode</a> (<a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *a)</td></tr>
<tr class="separator:a7052392c4bab85f8e0b231617a3f5312"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a372905fefabbe5ed994926e9111e2226"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a372905fefabbe5ed994926e9111e2226">addresses_use_unicode</a> (<a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structADDRESS.html">ADDRESS</a> *a)</td></tr>
<tr class="separator:a372905fefabbe5ed994926e9111e2226"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a025390cb6e4c15df20678a380e23da1e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a025390cb6e4c15df20678a380e23da1e">mutt_smtp_send</a> (<a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structADDRESS.html">ADDRESS</a> *from, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structADDRESS.html">ADDRESS</a> *to, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structADDRESS.html">ADDRESS</a> *cc, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structADDRESS.html">ADDRESS</a> *bcc, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *msgfile, int eightbit)</td></tr>
<tr class="separator:a025390cb6e4c15df20678a380e23da1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25add54877c2d71a9f3ef7ac4d823c7c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a25add54877c2d71a9f3ef7ac4d823c7c">smtp_helo</a> (<a class="el" href="structCONNECTION.html">CONNECTION</a> *conn)</td></tr>
<tr class="separator:a25add54877c2d71a9f3ef7ac4d823c7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aee943fe85d22876d59094cf9d82d8fe6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#aee943fe85d22876d59094cf9d82d8fe6">Esmtp</a> = 0</td></tr>
<tr class="separator:aee943fe85d22876d59094cf9d82d8fe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e61b16cfaf8c6f37eadbbcdf734e054"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a4e61b16cfaf8c6f37eadbbcdf734e054">AuthMechs</a> = <a class="el" href="regex_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td></tr>
<tr class="separator:a4e61b16cfaf8c6f37eadbbcdf734e054"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a864d1b1264069d37762bca2c36c2a26e"><td class="memItemLeft" align="right" valign="top">static unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a> [(<a class="el" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a59d924fd58cee243d7b1a29267e4bff4">CAPMAX</a>+7)/8]</td></tr>
<tr class="separator:a864d1b1264069d37762bca2c36c2a26e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a816bd1f7035855b6c4c4132b64571155"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a816bd1f7035855b6c4c4132b64571155">&#9670;&nbsp;</a></span>smtp_success</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define smtp_success</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x)/100 == 2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00044">44</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
<a id="a3f4e60f061c8059e4fac6b0f3b9f1057"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f4e60f061c8059e4fac6b0f3b9f1057">&#9670;&nbsp;</a></span>smtp_ready</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define smtp_ready&#160;&#160;&#160;334</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00045">45</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
<a id="a44a8faa29de46504ffad57d4f20b0487"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44a8faa29de46504ffad57d4f20b0487">&#9670;&nbsp;</a></span>smtp_continue</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define smtp_continue&#160;&#160;&#160;354</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00046">46</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
<a id="a03a78f4a9181af45cac263f2a313e474"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03a78f4a9181af45cac263f2a313e474">&#9670;&nbsp;</a></span>smtp_err_read</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define smtp_err_read&#160;&#160;&#160;-2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00048">48</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
<a id="a1816449b160df247d202072e542a32a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1816449b160df247d202072e542a32a1">&#9670;&nbsp;</a></span>smtp_err_write</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define smtp_err_write&#160;&#160;&#160;-3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00049">49</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
<a id="a2cb3d0a3a556014703d33a0b3cafa3e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cb3d0a3a556014703d33a0b3cafa3e5">&#9670;&nbsp;</a></span>smtp_err_code</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define smtp_err_code&#160;&#160;&#160;-4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00050">50</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
<a id="af6437be0fedb9dacef3a6b33d165ad8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6437be0fedb9dacef3a6b33d165ad8a">&#9670;&nbsp;</a></span>SMTP_PORT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMTP_PORT&#160;&#160;&#160;25</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00052">52</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
<a id="a0e4660473a1ca02835a4b22e1ddb048f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e4660473a1ca02835a4b22e1ddb048f">&#9670;&nbsp;</a></span>SMTPS_PORT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMTPS_PORT&#160;&#160;&#160;465</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00053">53</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
<a id="a9eefbe288d30f6c851eb53feace74cb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9eefbe288d30f6c851eb53feace74cb3">&#9670;&nbsp;</a></span>SMTP_AUTH_SUCCESS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMTP_AUTH_SUCCESS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00055">55</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
<a id="a636ce31e9faba3f7e620a8f7809252eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a636ce31e9faba3f7e620a8f7809252eb">&#9670;&nbsp;</a></span>SMTP_AUTH_UNAVAIL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMTP_AUTH_UNAVAIL&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00056">56</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
<a id="a84d8e78e08aaa71820593b38ac4e88cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84d8e78e08aaa71820593b38ac4e88cb">&#9670;&nbsp;</a></span>SMTP_AUTH_FAIL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMTP_AUTH_FAIL&#160;&#160;&#160;-1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00057">57</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a458e651af6690959efa2afb96be7d609"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a458e651af6690959efa2afb96be7d609">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a458e651af6690959efa2afb96be7d609ae7cc0b2670caf4784fa8209e95971757"></a>STARTTLS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a458e651af6690959efa2afb96be7d609a8b22fbb60fcbd7a4a5e1e6ff6ee38218"></a>AUTH&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd"></a>DSN&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a458e651af6690959efa2afb96be7d609a81b701d65406433d3b37bb2057213266"></a>EIGHTBITMIME&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a458e651af6690959efa2afb96be7d609a11ab51c9490b3f390e650b8826dc1fe4"></a>SMTPUTF8&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a458e651af6690959efa2afb96be7d609a59d924fd58cee243d7b1a29267e4bff4"></a>CAPMAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00059">59</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;     {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609ae7cc0b2670caf4784fa8209e95971757">STARTTLS</a>,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a8b22fbb60fcbd7a4a5e1e6ff6ee38218">AUTH</a>,</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd">DSN</a>,</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a81b701d65406433d3b37bb2057213266">EIGHTBITMIME</a>,</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a11ab51c9490b3f390e650b8826dc1fe4">SMTPUTF8</a>,</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a59d924fd58cee243d7b1a29267e4bff4">CAPMAX</a></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;};</div><div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a59d924fd58cee243d7b1a29267e4bff4"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a59d924fd58cee243d7b1a29267e4bff4">CAPMAX</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00066">smtp.c:66</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a8b22fbb60fcbd7a4a5e1e6ff6ee38218"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a8b22fbb60fcbd7a4a5e1e6ff6ee38218">AUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00061">smtp.c:61</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a11ab51c9490b3f390e650b8826dc1fe4"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a11ab51c9490b3f390e650b8826dc1fe4">SMTPUTF8</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00064">smtp.c:64</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a81b701d65406433d3b37bb2057213266"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a81b701d65406433d3b37bb2057213266">EIGHTBITMIME</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00063">smtp.c:63</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd">DSN</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00062">smtp.c:62</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609ae7cc0b2670caf4784fa8209e95971757"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609ae7cc0b2670caf4784fa8209e95971757">STARTTLS</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00060">smtp.c:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a834b9cb0cab80c145b9c4366f3e97160"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a834b9cb0cab80c145b9c4366f3e97160">&#9670;&nbsp;</a></span>smtp_auth()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int smtp_auth </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONNECTION.html">CONNECTION</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00511">511</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;{</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordtype">int</span> r = <a class="code" href="smtp_8c.html#a636ce31e9faba3f7e620a8f7809252eb">SMTP_AUTH_UNAVAIL</a>;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">if</span> (SmtpAuthenticators &amp;&amp; *SmtpAuthenticators)</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordtype">char</span>* methods = <a class="code" href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a> (SmtpAuthenticators);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordtype">char</span>* method;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordtype">char</span>* delim;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">for</span> (method = methods; method; method = delim)</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      delim = <a class="code" href="protos_8h.html#a58f035966ee1771c6b3bb7a84fb13019">strchr</a> (method, <span class="charliteral">&#39;:&#39;</span>);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <span class="keywordflow">if</span> (delim)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        *delim++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <span class="keywordflow">if</span> (! method[0])</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <a class="code" href="lib_8h.html#a5c75177122494450ca7234a1f4048711">dprint</a> (2, (debugfile, <span class="stringliteral">&quot;smtp_authenticate: Trying method %s\n&quot;</span>, method));</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      r = <a class="code" href="smtp_8c.html#ad2004bab178b66fa0b3db7caf610d1d9">smtp_auth_sasl</a> (conn, method);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      </div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordflow">if</span> (r == <a class="code" href="smtp_8c.html#a84d8e78e08aaa71820593b38ac4e88cb">SMTP_AUTH_FAIL</a> &amp;&amp; delim)</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;%s authentication failed, trying next method&quot;</span>), method);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <a class="code" href="muttlib_8c.html#a6fbcbe533be7c4e05d99b0eb9cdb2581">mutt_sleep</a> (1);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r != <a class="code" href="smtp_8c.html#a636ce31e9faba3f7e620a8f7809252eb">SMTP_AUTH_UNAVAIL</a>)</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a> (&amp;methods);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    r = <a class="code" href="smtp_8c.html#ad2004bab178b66fa0b3db7caf610d1d9">smtp_auth_sasl</a> (conn, <a class="code" href="smtp_8c.html#a4e61b16cfaf8c6f37eadbbcdf734e054">AuthMechs</a>);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">if</span> (r != <a class="code" href="smtp_8c.html#a9eefbe288d30f6c851eb53feace74cb3">SMTP_AUTH_SUCCESS</a>)</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="account_8c.html#a9bc10dc5367d939845d0de1aa30d56aa">mutt_account_unsetpass</a> (&amp;conn-&gt;<a class="code" href="structCONNECTION.html#ae90ecbc270392096c73277cf7ac07fb5">account</a>);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordflow">if</span> (r == <a class="code" href="smtp_8c.html#a84d8e78e08aaa71820593b38ac4e88cb">SMTP_AUTH_FAIL</a>)</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;SASL authentication failed&quot;</span>));</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="muttlib_8c.html#a6fbcbe533be7c4e05d99b0eb9cdb2581">mutt_sleep</a> (1);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r == <a class="code" href="smtp_8c.html#a636ce31e9faba3f7e620a8f7809252eb">SMTP_AUTH_UNAVAIL</a>)</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No authenticators available&quot;</span>));</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="muttlib_8c.html#a6fbcbe533be7c4e05d99b0eb9cdb2581">mutt_sleep</a> (1);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordflow">return</span> r == <a class="code" href="smtp_8c.html#a9eefbe288d30f6c851eb53feace74cb3">SMTP_AUTH_SUCCESS</a> ? 0 : -1;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}</div><div class="ttc" id="smtp_8c_html_ad2004bab178b66fa0b3db7caf610d1d9"><div class="ttname"><a href="smtp_8c.html#ad2004bab178b66fa0b3db7caf610d1d9">smtp_auth_sasl</a></div><div class="ttdeci">static int smtp_auth_sasl(CONNECTION *conn, const char *mechanisms)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00564">smtp.c:564</a></div></div>
<div class="ttc" id="lib_8h_html_a5c75177122494450ca7234a1f4048711"><div class="ttname"><a href="lib_8h.html#a5c75177122494450ca7234a1f4048711">dprint</a></div><div class="ttdeci">#define dprint(N, X)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00152">lib.h:152</a></div></div>
<div class="ttc" id="lib_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00077">lib.h:77</a></div></div>
<div class="ttc" id="smtp_8c_html_a9eefbe288d30f6c851eb53feace74cb3"><div class="ttname"><a href="smtp_8c.html#a9eefbe288d30f6c851eb53feace74cb3">SMTP_AUTH_SUCCESS</a></div><div class="ttdeci">#define SMTP_AUTH_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00055">smtp.c:55</a></div></div>
<div class="ttc" id="muttlib_8c_html_a6fbcbe533be7c4e05d99b0eb9cdb2581"><div class="ttname"><a href="muttlib_8c.html#a6fbcbe533be7c4e05d99b0eb9cdb2581">mutt_sleep</a></div><div class="ttdeci">void mutt_sleep(short s)</div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8c_source.html#l01851">muttlib.c:1851</a></div></div>
<div class="ttc" id="extlib_8c_html_a90829ddbd5f0edf736c9f6e595cfc0be"><div class="ttname"><a href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a></div><div class="ttdeci">void(* mutt_error)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="extlib_8c_source.html#l00037">extlib.c:37</a></div></div>
<div class="ttc" id="structCONNECTION_html_ae90ecbc270392096c73277cf7ac07fb5"><div class="ttname"><a href="structCONNECTION.html#ae90ecbc270392096c73277cf7ac07fb5">CONNECTION::account</a></div><div class="ttdeci">ACCOUNT account</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00033">mutt_socket.h:33</a></div></div>
<div class="ttc" id="lib_8c_html_a26d804f329dea2733da34a4953a22a9d"><div class="ttname"><a href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a></div><div class="ttdeci">char * safe_strdup(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00234">lib.c:234</a></div></div>
<div class="ttc" id="smtp_8c_html_a636ce31e9faba3f7e620a8f7809252eb"><div class="ttname"><a href="smtp_8c.html#a636ce31e9faba3f7e620a8f7809252eb">SMTP_AUTH_UNAVAIL</a></div><div class="ttdeci">#define SMTP_AUTH_UNAVAIL</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00056">smtp.c:56</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="smtp_8c_html_a4e61b16cfaf8c6f37eadbbcdf734e054"><div class="ttname"><a href="smtp_8c.html#a4e61b16cfaf8c6f37eadbbcdf734e054">AuthMechs</a></div><div class="ttdeci">static char * AuthMechs</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00078">smtp.c:78</a></div></div>
<div class="ttc" id="smtp_8c_html_a84d8e78e08aaa71820593b38ac4e88cb"><div class="ttname"><a href="smtp_8c.html#a84d8e78e08aaa71820593b38ac4e88cb">SMTP_AUTH_FAIL</a></div><div class="ttdeci">#define SMTP_AUTH_FAIL</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00057">smtp.c:57</a></div></div>
<div class="ttc" id="protos_8h_html_a58f035966ee1771c6b3bb7a84fb13019"><div class="ttname"><a href="protos_8h.html#a58f035966ee1771c6b3bb7a84fb13019">strchr</a></div><div class="ttdeci">char * strchr()</div></div>
<div class="ttc" id="account_8c_html_a9bc10dc5367d939845d0de1aa30d56aa"><div class="ttname"><a href="account_8c.html#a9bc10dc5367d939845d0de1aa30d56aa">mutt_account_unsetpass</a></div><div class="ttdeci">void mutt_account_unsetpass(ACCOUNT *account)</div><div class="ttdef"><b>Definition:</b> <a href="account_8c_source.html#l00265">account.c:265</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2004bab178b66fa0b3db7caf610d1d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2004bab178b66fa0b3db7caf610d1d9">&#9670;&nbsp;</a></span>smtp_auth_sasl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int smtp_auth_sasl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONNECTION.html">CONNECTION</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>mechanisms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00564">564</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;{</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  sasl_conn_t* saslconn;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  sasl_interact_t* interaction = <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* mech;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* data = <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keywordtype">char</span> *buf = <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordtype">size_t</span> bufsize = 0;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keywordtype">int</span> rc, saslrc;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="mutt__sasl_8c.html#a5d639537ecfd2f272b1aea38a2b7ba0a">mutt_sasl_client_new</a> (conn, &amp;saslconn) &lt; 0)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a84d8e78e08aaa71820593b38ac4e88cb">SMTP_AUTH_FAIL</a>;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">do</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    rc = sasl_client_start (saslconn, mechlist, &amp;interaction, &amp;data, &amp;len, &amp;mech);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">if</span> (rc == SASL_INTERACT)</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <a class="code" href="mutt__sasl_8c.html#a69d46ce6a265526da2e547529fe2d44b">mutt_sasl_interact</a> (interaction);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  }</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keywordflow">while</span> (rc == SASL_INTERACT);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">if</span> (rc != SASL_OK &amp;&amp; rc != SASL_CONTINUE)</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="lib_8h.html#a5c75177122494450ca7234a1f4048711">dprint</a> (2, (debugfile, <span class="stringliteral">&quot;smtp_auth_sasl: %s unavailable\n&quot;</span>, mech));</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    sasl_dispose (&amp;saslconn);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a636ce31e9faba3f7e620a8f7809252eb">SMTP_AUTH_UNAVAIL</a>;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="mutt_8h.html#ae01642ac28c3b02ba17e0020477e90c1">option</a>(<a class="code" href="mutt_8h.html#a94798fdadfbf49a7c658ace669a1d310a462266a26e607a8eb95bdb178c530187">OPTNOCURSES</a>))</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <a class="code" href="globals_8h.html#a6021755edce63ab9d4e49f97213e83ab">mutt_message</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Authenticating (%s)...&quot;</span>), mech);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  bufsize = ((len * 2) &gt; <a class="code" href="dotlock_8c.html#a2ed4d73ac96556fca2623216ca4a4e4a">LONG_STRING</a>) ? (len * 2) : <a class="code" href="dotlock_8c.html#a2ed4d73ac96556fca2623216ca4a4e4a">LONG_STRING</a>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  buf = <a class="code" href="lib_8c.html#a8479642d26d45508ddd80cebb9c010b5">safe_malloc</a> (bufsize);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (buf, bufsize, <span class="stringliteral">&quot;AUTH %s&quot;</span>, mech);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordflow">if</span> (len)</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <a class="code" href="lib_8c.html#ad2ce27add2ab878db5f51c2302576f2d">safe_strcat</a> (buf, bufsize, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">if</span> (sasl_encode64 (data, len, buf + <a class="code" href="lib_8c.html#a00be9c99a4660441645a663008f85cbe">mutt_strlen</a> (buf),</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                       bufsize - <a class="code" href="lib_8c.html#a00be9c99a4660441645a663008f85cbe">mutt_strlen</a> (buf), &amp;len) != SASL_OK)</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <a class="code" href="lib_8h.html#a5c75177122494450ca7234a1f4048711">dprint</a> (1, (debugfile, <span class="stringliteral">&quot;smtp_auth_sasl: error base64-encoding client response.\n&quot;</span>));</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keywordflow">goto</span> fail;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <a class="code" href="lib_8c.html#ad2ce27add2ab878db5f51c2302576f2d">safe_strcat</a> (buf, bufsize, <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">do</span> {</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a> (conn, buf) &lt; 0)</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="keywordflow">goto</span> fail;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">if</span> ((rc = <a class="code" href="mutt__socket_8h.html#a88b274d2735e74bc83b2800b4b1196bb">mutt_socket_readln</a> (buf, bufsize, conn)) &lt; 0)</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordflow">goto</span> fail;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="smtp_8c.html#a5cf87569e236ca82851ae2afd70655bd">smtp_code</a> (buf, rc, &amp;rc) &lt; 0)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">goto</span> fail;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordflow">if</span> (rc != <a class="code" href="smtp_8c.html#a3f4e60f061c8059e4fac6b0f3b9f1057">smtp_ready</a>)</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">if</span> (sasl_decode64 (buf+4, strlen (buf+4), buf, bufsize - 1, &amp;len) != SASL_OK)</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <a class="code" href="lib_8h.html#a5c75177122494450ca7234a1f4048711">dprint</a> (1, (debugfile, <span class="stringliteral">&quot;smtp_auth_sasl: error base64-decoding server response.\n&quot;</span>));</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="keywordflow">goto</span> fail;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      saslrc = sasl_client_step (saslconn, buf, len, &amp;interaction, &amp;data, &amp;len);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">if</span> (saslrc == SASL_INTERACT)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <a class="code" href="mutt__sasl_8c.html#a69d46ce6a265526da2e547529fe2d44b">mutt_sasl_interact</a> (interaction);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordflow">while</span> (saslrc == SASL_INTERACT);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">if</span> (len)</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    {</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keywordflow">if</span> ((len * 2) &gt; bufsize)</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        bufsize = len * 2;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <a class="code" href="lib_8c.html#aae229de722d5af03dddc42f0c319349c">safe_realloc</a> (&amp;buf, bufsize);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordflow">if</span> (sasl_encode64 (data, len, buf, bufsize, &amp;len) != SASL_OK)</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <a class="code" href="lib_8h.html#a5c75177122494450ca7234a1f4048711">dprint</a> (1, (debugfile, <span class="stringliteral">&quot;smtp_auth_sasl: error base64-encoding client response.\n&quot;</span>));</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordflow">goto</span> fail;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <a class="code" href="dotlock_8c.html#a768fe3117209ae26750fc8c64cf2b7ed">strfcpy</a> (buf + len, <span class="stringliteral">&quot;\r\n&quot;</span>, bufsize - len);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  } <span class="keywordflow">while</span> (rc == <a class="code" href="smtp_8c.html#a3f4e60f061c8059e4fac6b0f3b9f1057">smtp_ready</a> &amp;&amp; saslrc != SASL_FAIL);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="smtp_8c.html#a816bd1f7035855b6c4c4132b64571155">smtp_success</a> (rc))</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="mutt__sasl_8c.html#afc87b6c7d70197f9bfb5b355321a31bb">mutt_sasl_setup_conn</a> (conn, saslconn);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a> (&amp;buf);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a9eefbe288d30f6c851eb53feace74cb3">SMTP_AUTH_SUCCESS</a>;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;fail:</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  sasl_dispose (&amp;saslconn);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a> (&amp;buf);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a84d8e78e08aaa71820593b38ac4e88cb">SMTP_AUTH_FAIL</a>;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;}</div><div class="ttc" id="explodename_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="explodename_8c_source.html#l00034">explodename.c:34</a></div></div>
<div class="ttc" id="lib_8h_html_a5c75177122494450ca7234a1f4048711"><div class="ttname"><a href="lib_8h.html#a5c75177122494450ca7234a1f4048711">dprint</a></div><div class="ttdeci">#define dprint(N, X)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00152">lib.h:152</a></div></div>
<div class="ttc" id="mutt__sasl_8c_html_afc87b6c7d70197f9bfb5b355321a31bb"><div class="ttname"><a href="mutt__sasl_8c.html#afc87b6c7d70197f9bfb5b355321a31bb">mutt_sasl_setup_conn</a></div><div class="ttdeci">void mutt_sasl_setup_conn(CONNECTION *conn, sasl_conn_t *saslconn)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__sasl_8c_source.html#l00346">mutt_sasl.c:346</a></div></div>
<div class="ttc" id="mutt__sasl_8c_html_a69d46ce6a265526da2e547529fe2d44b"><div class="ttname"><a href="mutt__sasl_8c.html#a69d46ce6a265526da2e547529fe2d44b">mutt_sasl_interact</a></div><div class="ttdeci">int mutt_sasl_interact(sasl_interact_t *interaction)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__sasl_8c_source.html#l00306">mutt_sasl.c:306</a></div></div>
<div class="ttc" id="lib_8c_html_a00be9c99a4660441645a663008f85cbe"><div class="ttname"><a href="lib_8c.html#a00be9c99a4660441645a663008f85cbe">mutt_strlen</a></div><div class="ttdeci">size_t mutt_strlen(const char *a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00912">lib.c:912</a></div></div>
<div class="ttc" id="mutt__socket_8h_html_a8b6a425c6e3188a9378580f0d28d90b7"><div class="ttname"><a href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a></div><div class="ttdeci">#define mutt_socket_write(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00061">mutt_socket.h:61</a></div></div>
<div class="ttc" id="lib_8c_html_a8479642d26d45508ddd80cebb9c010b5"><div class="ttname"><a href="lib_8c.html#a8479642d26d45508ddd80cebb9c010b5">safe_malloc</a></div><div class="ttdeci">void * safe_malloc(size_t siz)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00145">lib.c:145</a></div></div>
<div class="ttc" id="lib_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00077">lib.h:77</a></div></div>
<div class="ttc" id="smtp_8c_html_a5cf87569e236ca82851ae2afd70655bd"><div class="ttname"><a href="smtp_8c.html#a5cf87569e236ca82851ae2afd70655bd">smtp_code</a></div><div class="ttdeci">static int smtp_code(char *buf, size_t len, int *n)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00081">smtp.c:81</a></div></div>
<div class="ttc" id="smtp_8c_html_a9eefbe288d30f6c851eb53feace74cb3"><div class="ttname"><a href="smtp_8c.html#a9eefbe288d30f6c851eb53feace74cb3">SMTP_AUTH_SUCCESS</a></div><div class="ttdeci">#define SMTP_AUTH_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00055">smtp.c:55</a></div></div>
<div class="ttc" id="lib_8c_html_ad2ce27add2ab878db5f51c2302576f2d"><div class="ttname"><a href="lib_8c.html#ad2ce27add2ab878db5f51c2302576f2d">safe_strcat</a></div><div class="ttdeci">char * safe_strcat(char *d, size_t l, const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00247">lib.c:247</a></div></div>
<div class="ttc" id="mutt__sasl_8c_html_a5d639537ecfd2f272b1aea38a2b7ba0a"><div class="ttname"><a href="mutt__sasl_8c.html#a5d639537ecfd2f272b1aea38a2b7ba0a">mutt_sasl_client_new</a></div><div class="ttdeci">int mutt_sasl_client_new(CONNECTION *conn, sasl_conn_t **saslconn)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__sasl_8c_source.html#l00170">mutt_sasl.c:170</a></div></div>
<div class="ttc" id="mutt_8h_html_ae01642ac28c3b02ba17e0020477e90c1"><div class="ttname"><a href="mutt_8h.html#ae01642ac28c3b02ba17e0020477e90c1">option</a></div><div class="ttdeci">#define option(x)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00631">mutt.h:631</a></div></div>
<div class="ttc" id="mutt_8h_html_a94798fdadfbf49a7c658ace669a1d310a462266a26e607a8eb95bdb178c530187"><div class="ttname"><a href="mutt_8h.html#a94798fdadfbf49a7c658ace669a1d310a462266a26e607a8eb95bdb178c530187">OPTNOCURSES</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00584">mutt.h:584</a></div></div>
<div class="ttc" id="mutt__socket_8h_html_a88b274d2735e74bc83b2800b4b1196bb"><div class="ttname"><a href="mutt__socket_8h.html#a88b274d2735e74bc83b2800b4b1196bb">mutt_socket_readln</a></div><div class="ttdeci">#define mutt_socket_readln(A, B, C)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00059">mutt_socket.h:59</a></div></div>
<div class="ttc" id="smtp_8c_html_a3f4e60f061c8059e4fac6b0f3b9f1057"><div class="ttname"><a href="smtp_8c.html#a3f4e60f061c8059e4fac6b0f3b9f1057">smtp_ready</a></div><div class="ttdeci">#define smtp_ready</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00045">smtp.c:45</a></div></div>
<div class="ttc" id="smtp_8c_html_a816bd1f7035855b6c4c4132b64571155"><div class="ttname"><a href="smtp_8c.html#a816bd1f7035855b6c4c4132b64571155">smtp_success</a></div><div class="ttdeci">#define smtp_success(x)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00044">smtp.c:44</a></div></div>
<div class="ttc" id="globals_8h_html_a6021755edce63ab9d4e49f97213e83ab"><div class="ttname"><a href="globals_8h.html#a6021755edce63ab9d4e49f97213e83ab">mutt_message</a></div><div class="ttdeci">WHERE void(* mutt_message)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00020">globals.h:20</a></div></div>
<div class="ttc" id="smtp_8c_html_a636ce31e9faba3f7e620a8f7809252eb"><div class="ttname"><a href="smtp_8c.html#a636ce31e9faba3f7e620a8f7809252eb">SMTP_AUTH_UNAVAIL</a></div><div class="ttdeci">#define SMTP_AUTH_UNAVAIL</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00056">smtp.c:56</a></div></div>
<div class="ttc" id="lib_8c_html_aae229de722d5af03dddc42f0c319349c"><div class="ttname"><a href="lib_8c.html#aae229de722d5af03dddc42f0c319349c">safe_realloc</a></div><div class="ttdeci">void safe_realloc(void *ptr, size_t siz)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00160">lib.c:160</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="dotlock_8c_html_a768fe3117209ae26750fc8c64cf2b7ed"><div class="ttname"><a href="dotlock_8c.html#a768fe3117209ae26750fc8c64cf2b7ed">strfcpy</a></div><div class="ttdeci">#define strfcpy(DST, SRC, LEN)</div><div class="ttdef"><b>Definition:</b> <a href="dotlock_8c_source.html#l00066">dotlock.c:66</a></div></div>
<div class="ttc" id="dotlock_8c_html_a357a42eb6494ea592e9c3f96c55cebe2"><div class="ttname"><a href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a></div><div class="ttdeci">int snprintf(char *, size_t, const char *,...)</div></div>
<div class="ttc" id="dotlock_8c_html_a2ed4d73ac96556fca2623216ca4a4e4a"><div class="ttname"><a href="dotlock_8c.html#a2ed4d73ac96556fca2623216ca4a4e4a">LONG_STRING</a></div><div class="ttdeci">#define LONG_STRING</div><div class="ttdef"><b>Definition:</b> <a href="dotlock_8c_source.html#l00063">dotlock.c:63</a></div></div>
<div class="ttc" id="smtp_8c_html_a84d8e78e08aaa71820593b38ac4e88cb"><div class="ttname"><a href="smtp_8c.html#a84d8e78e08aaa71820593b38ac4e88cb">SMTP_AUTH_FAIL</a></div><div class="ttdeci">#define SMTP_AUTH_FAIL</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00057">smtp.c:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a75505bd53f738baa45179f85c970b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a75505bd53f738baa45179f85c970b3">&#9670;&nbsp;</a></span>smtp_fill_account()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int smtp_fill_account </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structACCOUNT.html">ACCOUNT</a> *&#160;</td>
          <td class="paramname"><em>account</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00365">365</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;{</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> SmtpPort = 0;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keyword">struct </span>servent* service;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="structciss__url__t.html">ciss_url_t</a> url;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordtype">char</span>* urlstr;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  account-&gt;<a class="code" href="structACCOUNT.html#a6e2d0a9b75bfe913e0e848c76df21a6c">flags</a> = 0;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  account-&gt;<a class="code" href="structACCOUNT.html#aea977bd7d99d1a68e96b4c5410a84c38">port</a> = 0;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  account-&gt;<a class="code" href="structACCOUNT.html#adc856985604cf482f6c8f839d42cb46a">type</a> = <a class="code" href="account_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba1b53b8866e01613c1e63f164b6977b3e">MUTT_ACCT_TYPE_SMTP</a>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  urlstr = <a class="code" href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a> (SmtpUrl);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="url_8c.html#a7ce5f1891f27f3dde1bf95750644a431">url_parse_ciss</a> (&amp;url, urlstr);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">if</span> ((url.<a class="code" href="structciss__url__t.html#a752db69532eb9457f1ed7e558819a2e3">scheme</a> != <a class="code" href="url_8h.html#ad30f363a2e5d592c88003f447806eb3ca84592370a6845410408ef347ab154c4e">U_SMTP</a> &amp;&amp; url.<a class="code" href="structciss__url__t.html#a752db69532eb9457f1ed7e558819a2e3">scheme</a> != <a class="code" href="url_8h.html#ad30f363a2e5d592c88003f447806eb3ca5975934c7bde3342734ca20090bdbe79">U_SMTPS</a>)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      || <a class="code" href="account_8c.html#a21ae5cf1f17907e83331f6b3a520dddb">mutt_account_fromurl</a> (account, &amp;url) &lt; 0)</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a> (&amp;urlstr);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Invalid SMTP URL: %s&quot;</span>), SmtpUrl);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="muttlib_8c.html#a6fbcbe533be7c4e05d99b0eb9cdb2581">mutt_sleep</a> (1);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a> (&amp;urlstr);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordflow">if</span> (url.<a class="code" href="structciss__url__t.html#a752db69532eb9457f1ed7e558819a2e3">scheme</a> == <a class="code" href="url_8h.html#ad30f363a2e5d592c88003f447806eb3ca5975934c7bde3342734ca20090bdbe79">U_SMTPS</a>)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    account-&gt;<a class="code" href="structACCOUNT.html#a6e2d0a9b75bfe913e0e848c76df21a6c">flags</a> |= <a class="code" href="account_8h.html#a4a13697bc3f261ea3949d4dbe3869863">MUTT_ACCT_SSL</a>;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordflow">if</span> (!account-&gt;<a class="code" href="structACCOUNT.html#aea977bd7d99d1a68e96b4c5410a84c38">port</a>)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">if</span> (account-&gt;<a class="code" href="structACCOUNT.html#a6e2d0a9b75bfe913e0e848c76df21a6c">flags</a> &amp; <a class="code" href="account_8h.html#a4a13697bc3f261ea3949d4dbe3869863">MUTT_ACCT_SSL</a>)</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      account-&gt;<a class="code" href="structACCOUNT.html#aea977bd7d99d1a68e96b4c5410a84c38">port</a> = <a class="code" href="smtp_8c.html#a0e4660473a1ca02835a4b22e1ddb048f">SMTPS_PORT</a>;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">if</span> (!SmtpPort)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        service = getservbyname (<span class="stringliteral">&quot;smtp&quot;</span>, <span class="stringliteral">&quot;tcp&quot;</span>);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">if</span> (service)</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;          SmtpPort = ntohs (service-&gt;s_port);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;          SmtpPort = <a class="code" href="smtp_8c.html#af6437be0fedb9dacef3a6b33d165ad8a">SMTP_PORT</a>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <a class="code" href="lib_8h.html#a5c75177122494450ca7234a1f4048711">dprint</a> (3, (debugfile, <span class="stringliteral">&quot;Using default SMTP port %d\n&quot;</span>, SmtpPort));</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      account-&gt;<a class="code" href="structACCOUNT.html#aea977bd7d99d1a68e96b4c5410a84c38">port</a> = SmtpPort;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div><div class="ttc" id="lib_8h_html_a5c75177122494450ca7234a1f4048711"><div class="ttname"><a href="lib_8h.html#a5c75177122494450ca7234a1f4048711">dprint</a></div><div class="ttdeci">#define dprint(N, X)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00152">lib.h:152</a></div></div>
<div class="ttc" id="structciss__url__t_html"><div class="ttname"><a href="structciss__url__t.html">ciss_url_t</a></div><div class="ttdef"><b>Definition:</b> <a href="url_8h_source.html#l00026">url.h:26</a></div></div>
<div class="ttc" id="lib_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00077">lib.h:77</a></div></div>
<div class="ttc" id="account_8h_html_a4a13697bc3f261ea3949d4dbe3869863"><div class="ttname"><a href="account_8h.html#a4a13697bc3f261ea3949d4dbe3869863">MUTT_ACCT_SSL</a></div><div class="ttdeci">#define MUTT_ACCT_SSL</div><div class="ttdef"><b>Definition:</b> <a href="account_8h_source.html#l00041">account.h:41</a></div></div>
<div class="ttc" id="url_8h_html_ad30f363a2e5d592c88003f447806eb3ca84592370a6845410408ef347ab154c4e"><div class="ttname"><a href="url_8h.html#ad30f363a2e5d592c88003f447806eb3ca84592370a6845410408ef347ab154c4e">U_SMTP</a></div><div class="ttdef"><b>Definition:</b> <a href="url_8h_source.html#l00013">url.h:13</a></div></div>
<div class="ttc" id="url_8c_html_a7ce5f1891f27f3dde1bf95750644a431"><div class="ttname"><a href="url_8c.html#a7ce5f1891f27f3dde1bf95750644a431">url_parse_ciss</a></div><div class="ttdeci">int url_parse_ciss(ciss_url_t *ciss, char *src)</div><div class="ttdef"><b>Definition:</b> <a href="url_8c_source.html#l00183">url.c:183</a></div></div>
<div class="ttc" id="muttlib_8c_html_a6fbcbe533be7c4e05d99b0eb9cdb2581"><div class="ttname"><a href="muttlib_8c.html#a6fbcbe533be7c4e05d99b0eb9cdb2581">mutt_sleep</a></div><div class="ttdeci">void mutt_sleep(short s)</div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8c_source.html#l01851">muttlib.c:1851</a></div></div>
<div class="ttc" id="structACCOUNT_html_adc856985604cf482f6c8f839d42cb46a"><div class="ttname"><a href="structACCOUNT.html#adc856985604cf482f6c8f839d42cb46a">ACCOUNT::type</a></div><div class="ttdeci">unsigned char type</div><div class="ttdef"><b>Definition:</b> <a href="account_8h_source.html#l00050">account.h:50</a></div></div>
<div class="ttc" id="extlib_8c_html_a90829ddbd5f0edf736c9f6e595cfc0be"><div class="ttname"><a href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a></div><div class="ttdeci">void(* mutt_error)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="extlib_8c_source.html#l00037">extlib.c:37</a></div></div>
<div class="ttc" id="lib_8c_html_a26d804f329dea2733da34a4953a22a9d"><div class="ttname"><a href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a></div><div class="ttdeci">char * safe_strdup(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00234">lib.c:234</a></div></div>
<div class="ttc" id="smtp_8c_html_af6437be0fedb9dacef3a6b33d165ad8a"><div class="ttname"><a href="smtp_8c.html#af6437be0fedb9dacef3a6b33d165ad8a">SMTP_PORT</a></div><div class="ttdeci">#define SMTP_PORT</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00052">smtp.c:52</a></div></div>
<div class="ttc" id="account_8h_html_a06fc87d81c62e9abb8790b6e5713c55ba1b53b8866e01613c1e63f164b6977b3e"><div class="ttname"><a href="account_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba1b53b8866e01613c1e63f164b6977b3e">MUTT_ACCT_TYPE_SMTP</a></div><div class="ttdef"><b>Definition:</b> <a href="account_8h_source.html#l00032">account.h:32</a></div></div>
<div class="ttc" id="structACCOUNT_html_a6e2d0a9b75bfe913e0e848c76df21a6c"><div class="ttname"><a href="structACCOUNT.html#a6e2d0a9b75bfe913e0e848c76df21a6c">ACCOUNT::flags</a></div><div class="ttdeci">unsigned char flags</div><div class="ttdef"><b>Definition:</b> <a href="account_8h_source.html#l00051">account.h:51</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="account_8c_html_a21ae5cf1f17907e83331f6b3a520dddb"><div class="ttname"><a href="account_8c.html#a21ae5cf1f17907e83331f6b3a520dddb">mutt_account_fromurl</a></div><div class="ttdeci">int mutt_account_fromurl(ACCOUNT *account, ciss_url_t *url)</div><div class="ttdef"><b>Definition:</b> <a href="account_8c_source.html#l00074">account.c:74</a></div></div>
<div class="ttc" id="smtp_8c_html_a0e4660473a1ca02835a4b22e1ddb048f"><div class="ttname"><a href="smtp_8c.html#a0e4660473a1ca02835a4b22e1ddb048f">SMTPS_PORT</a></div><div class="ttdeci">#define SMTPS_PORT</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00053">smtp.c:53</a></div></div>
<div class="ttc" id="url_8h_html_ad30f363a2e5d592c88003f447806eb3ca5975934c7bde3342734ca20090bdbe79"><div class="ttname"><a href="url_8h.html#ad30f363a2e5d592c88003f447806eb3ca5975934c7bde3342734ca20090bdbe79">U_SMTPS</a></div><div class="ttdef"><b>Definition:</b> <a href="url_8h_source.html#l00014">url.h:14</a></div></div>
<div class="ttc" id="structciss__url__t_html_a752db69532eb9457f1ed7e558819a2e3"><div class="ttname"><a href="structciss__url__t.html#a752db69532eb9457f1ed7e558819a2e3">ciss_url_t::scheme</a></div><div class="ttdeci">url_scheme_t scheme</div><div class="ttdef"><b>Definition:</b> <a href="url_8h_source.html#l00028">url.h:28</a></div></div>
<div class="ttc" id="structACCOUNT_html_aea977bd7d99d1a68e96b4c5410a84c38"><div class="ttname"><a href="structACCOUNT.html#aea977bd7d99d1a68e96b4c5410a84c38">ACCOUNT::port</a></div><div class="ttdeci">unsigned short port</div><div class="ttdef"><b>Definition:</b> <a href="account_8h_source.html#l00049">account.h:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0de44525c1ea8977b943f3fb86386bf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0de44525c1ea8977b943f3fb86386bf2">&#9670;&nbsp;</a></span>smtp_open()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int smtp_open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONNECTION.html">CONNECTION</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00445">445</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;{</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordtype">int</span> rc;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="mutt__socket_8c.html#abac3f465fbeeaff38dc9b51043c375a4">mutt_socket_open</a> (conn))</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">/* get greeting string */</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordflow">if</span> ((rc = <a class="code" href="smtp_8c.html#a89fdbb31e8fca646b1415e9fda4a48cf">smtp_get_resp</a> (conn)))</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordflow">if</span> ((rc = <a class="code" href="smtp_8c.html#a25add54877c2d71a9f3ef7ac4d823c7c">smtp_helo</a> (conn)))</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="preprocessor">#ifdef USE_SSL</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structCONNECTION.html#a44859ffc0e533fd13031403375360838">ssf</a>)</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    rc = <a class="code" href="mutt_8h.html#a39fca1837c5ce7715cbf571669660c13abe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a>;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="mutt_8h.html#ae01642ac28c3b02ba17e0020477e90c1">option</a> (OPTSSLFORCETLS))</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    rc = <a class="code" href="mutt_8h.html#a39fca1837c5ce7715cbf571669660c13afee7088606c4724651c799a6a0b182b7">MUTT_YES</a>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="mutt_8h.html#ab78c2ac3ac8230d19fcca57dc84eb3ae">mutt_bit_isset</a> (<a class="code" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a>, <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609ae7cc0b2670caf4784fa8209e95971757">STARTTLS</a>) &amp;&amp;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;           (rc = <a class="code" href="init_8c.html#a620eb80c92ac555970111949ad0b7c56">query_quadoption</a> (OPT_SSLSTARTTLS,</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                   <a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Secure connection with TLS?&quot;</span>))) == <a class="code" href="mutt_8h.html#a39fca1837c5ce7715cbf571669660c13aaa75b5db14c0aed1fde665034f113339">MUTT_ABORT</a>)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keywordflow">if</span> (rc == <a class="code" href="mutt_8h.html#a39fca1837c5ce7715cbf571669660c13afee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a> (conn, <span class="stringliteral">&quot;STARTTLS\r\n&quot;</span>) &lt; 0)</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">if</span> ((rc = <a class="code" href="smtp_8c.html#a89fdbb31e8fca646b1415e9fda4a48cf">smtp_get_resp</a> (conn)))</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt__ssl_8c.html#a597e193842dba10de177461d123444f3">mutt_ssl_starttls</a> (conn))</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Could not negotiate TLS connection&quot;</span>));</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <a class="code" href="muttlib_8c.html#a6fbcbe533be7c4e05d99b0eb9cdb2581">mutt_sleep</a> (1);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">/* re-EHLO to get authentication mechanisms */</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">if</span> ((rc = <a class="code" href="smtp_8c.html#a25add54877c2d71a9f3ef7ac4d823c7c">smtp_helo</a> (conn)))</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structCONNECTION.html#ae90ecbc270392096c73277cf7ac07fb5">account</a>.<a class="code" href="structACCOUNT.html#a6e2d0a9b75bfe913e0e848c76df21a6c">flags</a> &amp; <a class="code" href="account_8h.html#ab496cae7636af7b356aad973a4a2e675">MUTT_ACCT_USER</a>)</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="mutt_8h.html#ab78c2ac3ac8230d19fcca57dc84eb3ae">mutt_bit_isset</a> (<a class="code" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a>, <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a8b22fbb60fcbd7a4a5e1e6ff6ee38218">AUTH</a>))</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;SMTP server does not support authentication&quot;</span>));</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <a class="code" href="muttlib_8c.html#a6fbcbe533be7c4e05d99b0eb9cdb2581">mutt_sleep</a> (1);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor">#ifdef USE_SASL</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a834b9cb0cab80c145b9c4366f3e97160">smtp_auth</a> (conn);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;SMTP authentication requires SASL&quot;</span>));</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <a class="code" href="muttlib_8c.html#a6fbcbe533be7c4e05d99b0eb9cdb2581">mutt_sleep</a> (1);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SASL */</span><span class="preprocessor"></span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;}</div><div class="ttc" id="mutt__socket_8c_html_abac3f465fbeeaff38dc9b51043c375a4"><div class="ttname"><a href="mutt__socket_8c.html#abac3f465fbeeaff38dc9b51043c375a4">mutt_socket_open</a></div><div class="ttdeci">int mutt_socket_open(CONNECTION *conn)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8c_source.html#l00059">mutt_socket.c:59</a></div></div>
<div class="ttc" id="account_8h_html_ab496cae7636af7b356aad973a4a2e675"><div class="ttname"><a href="account_8h.html#ab496cae7636af7b356aad973a4a2e675">MUTT_ACCT_USER</a></div><div class="ttdeci">#define MUTT_ACCT_USER</div><div class="ttdef"><b>Definition:</b> <a href="account_8h_source.html#l00038">account.h:38</a></div></div>
<div class="ttc" id="mutt__socket_8h_html_a8b6a425c6e3188a9378580f0d28d90b7"><div class="ttname"><a href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a></div><div class="ttdeci">#define mutt_socket_write(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00061">mutt_socket.h:61</a></div></div>
<div class="ttc" id="mutt_8h_html_ab78c2ac3ac8230d19fcca57dc84eb3ae"><div class="ttname"><a href="mutt_8h.html#ab78c2ac3ac8230d19fcca57dc84eb3ae">mutt_bit_isset</a></div><div class="ttdeci">#define mutt_bit_isset(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00626">mutt.h:626</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a8b22fbb60fcbd7a4a5e1e6ff6ee38218"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a8b22fbb60fcbd7a4a5e1e6ff6ee38218">AUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00061">smtp.c:61</a></div></div>
<div class="ttc" id="smtp_8c_html_a834b9cb0cab80c145b9c4366f3e97160"><div class="ttname"><a href="smtp_8c.html#a834b9cb0cab80c145b9c4366f3e97160">smtp_auth</a></div><div class="ttdeci">static int smtp_auth(CONNECTION *conn)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00511">smtp.c:511</a></div></div>
<div class="ttc" id="smtp_8c_html_a89fdbb31e8fca646b1415e9fda4a48cf"><div class="ttname"><a href="smtp_8c.html#a89fdbb31e8fca646b1415e9fda4a48cf">smtp_get_resp</a></div><div class="ttdeci">static int smtp_get_resp(CONNECTION *conn)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00102">smtp.c:102</a></div></div>
<div class="ttc" id="smtp_8c_html_a864d1b1264069d37762bca2c36c2a26e"><div class="ttname"><a href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a></div><div class="ttdeci">static unsigned char Capabilities[(CAPMAX+7)/8]</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00079">smtp.c:79</a></div></div>
<div class="ttc" id="muttlib_8c_html_a6fbcbe533be7c4e05d99b0eb9cdb2581"><div class="ttname"><a href="muttlib_8c.html#a6fbcbe533be7c4e05d99b0eb9cdb2581">mutt_sleep</a></div><div class="ttdeci">void mutt_sleep(short s)</div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8c_source.html#l01851">muttlib.c:1851</a></div></div>
<div class="ttc" id="mutt_8h_html_a39fca1837c5ce7715cbf571669660c13afee7088606c4724651c799a6a0b182b7"><div class="ttname"><a href="mutt_8h.html#a39fca1837c5ce7715cbf571669660c13afee7088606c4724651c799a6a0b182b7">MUTT_YES</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00287">mutt.h:287</a></div></div>
<div class="ttc" id="mutt_8h_html_ae01642ac28c3b02ba17e0020477e90c1"><div class="ttname"><a href="mutt_8h.html#ae01642ac28c3b02ba17e0020477e90c1">option</a></div><div class="ttdeci">#define option(x)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00631">mutt.h:631</a></div></div>
<div class="ttc" id="mutt__ssl_8c_html_a597e193842dba10de177461d123444f3"><div class="ttname"><a href="mutt__ssl_8c.html#a597e193842dba10de177461d123444f3">mutt_ssl_starttls</a></div><div class="ttdeci">int mutt_ssl_starttls(CONNECTION *conn)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__ssl_8c_source.html#l00091">mutt_ssl.c:91</a></div></div>
<div class="ttc" id="extlib_8c_html_a90829ddbd5f0edf736c9f6e595cfc0be"><div class="ttname"><a href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a></div><div class="ttdeci">void(* mutt_error)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="extlib_8c_source.html#l00037">extlib.c:37</a></div></div>
<div class="ttc" id="structCONNECTION_html_ae90ecbc270392096c73277cf7ac07fb5"><div class="ttname"><a href="structCONNECTION.html#ae90ecbc270392096c73277cf7ac07fb5">CONNECTION::account</a></div><div class="ttdeci">ACCOUNT account</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00033">mutt_socket.h:33</a></div></div>
<div class="ttc" id="init_8c_html_a620eb80c92ac555970111949ad0b7c56"><div class="ttname"><a href="init_8c.html#a620eb80c92ac555970111949ad0b7c56">query_quadoption</a></div><div class="ttdeci">int query_quadoption(int opt, const char *prompt)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00115">init.c:115</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609ae7cc0b2670caf4784fa8209e95971757"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609ae7cc0b2670caf4784fa8209e95971757">STARTTLS</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00060">smtp.c:60</a></div></div>
<div class="ttc" id="structCONNECTION_html_a44859ffc0e533fd13031403375360838"><div class="ttname"><a href="structCONNECTION.html#a44859ffc0e533fd13031403375360838">CONNECTION::ssf</a></div><div class="ttdeci">unsigned int ssf</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00035">mutt_socket.h:35</a></div></div>
<div class="ttc" id="structACCOUNT_html_a6e2d0a9b75bfe913e0e848c76df21a6c"><div class="ttname"><a href="structACCOUNT.html#a6e2d0a9b75bfe913e0e848c76df21a6c">ACCOUNT::flags</a></div><div class="ttdeci">unsigned char flags</div><div class="ttdef"><b>Definition:</b> <a href="account_8h_source.html#l00051">account.h:51</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="smtp_8c_html_a1816449b160df247d202072e542a32a1"><div class="ttname"><a href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a></div><div class="ttdeci">#define smtp_err_write</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00049">smtp.c:49</a></div></div>
<div class="ttc" id="smtp_8c_html_a25add54877c2d71a9f3ef7ac4d823c7c"><div class="ttname"><a href="smtp_8c.html#a25add54877c2d71a9f3ef7ac4d823c7c">smtp_helo</a></div><div class="ttdeci">static int smtp_helo(CONNECTION *conn)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00414">smtp.c:414</a></div></div>
<div class="ttc" id="mutt_8h_html_a39fca1837c5ce7715cbf571669660c13aaa75b5db14c0aed1fde665034f113339"><div class="ttname"><a href="mutt_8h.html#a39fca1837c5ce7715cbf571669660c13aaa75b5db14c0aed1fde665034f113339">MUTT_ABORT</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00285">mutt.h:285</a></div></div>
<div class="ttc" id="mutt_8h_html_a39fca1837c5ce7715cbf571669660c13abe3800cc419f25384aaf1892fc3c812b"><div class="ttname"><a href="mutt_8h.html#a39fca1837c5ce7715cbf571669660c13abe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00286">mutt.h:286</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5cf87569e236ca82851ae2afd70655bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cf87569e236ca82851ae2afd70655bd">&#9670;&nbsp;</a></span>smtp_code()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int smtp_code </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00081">81</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;{</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">char</span> code[4];</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (len &lt; 4)</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  code[0] = buf[0];</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  code[1] = buf[1];</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  code[2] = buf[2];</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  code[3] = 0;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="lib_8c.html#a4ab56bfb268e36d6698113758b7d53e2">mutt_atoi</a> (code, <a class="code" href="dcigettext_8c.html#a58257445f1a929304e537613b62ebb35">n</a>) &lt; 0)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div><div class="ttc" id="dcigettext_8c_html_a58257445f1a929304e537613b62ebb35"><div class="ttname"><a href="dcigettext_8c.html#a58257445f1a929304e537613b62ebb35">n</a></div><div class="ttdeci">unsigned long int n</div><div class="ttdef"><b>Definition:</b> <a href="dcigettext_8c_source.html#l00407">dcigettext.c:407</a></div></div>
<div class="ttc" id="lib_8c_html_a4ab56bfb268e36d6698113758b7d53e2"><div class="ttname"><a href="lib_8c.html#a4ab56bfb268e36d6698113758b7d53e2">mutt_atoi</a></div><div class="ttdeci">int mutt_atoi(const char *str, int *dst)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l01072">lib.c:1072</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a89fdbb31e8fca646b1415e9fda4a48cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89fdbb31e8fca646b1415e9fda4a48cf">&#9670;&nbsp;</a></span>smtp_get_resp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int smtp_get_resp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONNECTION.html">CONNECTION</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00102">102</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="dcigettext_8c.html#a58257445f1a929304e537613b62ebb35">n</a>;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">char</span> buf[1024];</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">do</span> {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    n = <a class="code" href="mutt__socket_8h.html#a88b274d2735e74bc83b2800b4b1196bb">mutt_socket_readln</a> (buf, <span class="keyword">sizeof</span> (buf), conn);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> (n &lt; 4) {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="comment">/* read error, or no response code */</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a03a78f4a9181af45cac263f2a313e474">smtp_err_read</a>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="ascii_8c.html#a9d48a33ce9613b259cc8d7fbc04c4f0e">ascii_strncasecmp</a> (<span class="stringliteral">&quot;8BITMIME&quot;</span>, buf + 4, 8))</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <a class="code" href="mutt_8h.html#aa8b893e8a8e83e9101f9ff23afd0a1f6">mutt_bit_set</a> (<a class="code" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a>, <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a81b701d65406433d3b37bb2057213266">EIGHTBITMIME</a>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="ascii_8c.html#a9d48a33ce9613b259cc8d7fbc04c4f0e">ascii_strncasecmp</a> (<span class="stringliteral">&quot;AUTH &quot;</span>, buf + 4, 5))</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <a class="code" href="mutt_8h.html#aa8b893e8a8e83e9101f9ff23afd0a1f6">mutt_bit_set</a> (<a class="code" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a>, <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a8b22fbb60fcbd7a4a5e1e6ff6ee38218">AUTH</a>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a> (&amp;<a class="code" href="smtp_8c.html#a4e61b16cfaf8c6f37eadbbcdf734e054">AuthMechs</a>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <a class="code" href="smtp_8c.html#a4e61b16cfaf8c6f37eadbbcdf734e054">AuthMechs</a> = <a class="code" href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a> (buf + 9);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="ascii_8c.html#a9d48a33ce9613b259cc8d7fbc04c4f0e">ascii_strncasecmp</a> (<span class="stringliteral">&quot;DSN&quot;</span>, buf + 4, 3))</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <a class="code" href="mutt_8h.html#aa8b893e8a8e83e9101f9ff23afd0a1f6">mutt_bit_set</a> (<a class="code" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a>, <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd">DSN</a>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="ascii_8c.html#a9d48a33ce9613b259cc8d7fbc04c4f0e">ascii_strncasecmp</a> (<span class="stringliteral">&quot;STARTTLS&quot;</span>, buf + 4, 8))</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="mutt_8h.html#aa8b893e8a8e83e9101f9ff23afd0a1f6">mutt_bit_set</a> (<a class="code" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a>, <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609ae7cc0b2670caf4784fa8209e95971757">STARTTLS</a>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="ascii_8c.html#a9d48a33ce9613b259cc8d7fbc04c4f0e">ascii_strncasecmp</a> (<span class="stringliteral">&quot;SMTPUTF8&quot;</span>, buf + 4, 8))</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <a class="code" href="mutt_8h.html#aa8b893e8a8e83e9101f9ff23afd0a1f6">mutt_bit_set</a> (<a class="code" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a>, <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a11ab51c9490b3f390e650b8826dc1fe4">SMTPUTF8</a>);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="smtp_8c.html#a5cf87569e236ca82851ae2afd70655bd">smtp_code</a> (buf, n, &amp;n) &lt; 0)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a2cb3d0a3a556014703d33a0b3cafa3e5">smtp_err_code</a>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  } <span class="keywordflow">while</span> (buf[3] == <span class="charliteral">&#39;-&#39;</span>);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="smtp_8c.html#a816bd1f7035855b6c4c4132b64571155">smtp_success</a> (n) || n == <a class="code" href="smtp_8c.html#a44a8faa29de46504ffad57d4f20b0487">smtp_continue</a>)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;SMTP session failed: %s&quot;</span>), buf);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div><div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a8b22fbb60fcbd7a4a5e1e6ff6ee38218"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a8b22fbb60fcbd7a4a5e1e6ff6ee38218">AUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00061">smtp.c:61</a></div></div>
<div class="ttc" id="lib_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00077">lib.h:77</a></div></div>
<div class="ttc" id="smtp_8c_html_a5cf87569e236ca82851ae2afd70655bd"><div class="ttname"><a href="smtp_8c.html#a5cf87569e236ca82851ae2afd70655bd">smtp_code</a></div><div class="ttdeci">static int smtp_code(char *buf, size_t len, int *n)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00081">smtp.c:81</a></div></div>
<div class="ttc" id="mutt_8h_html_aa8b893e8a8e83e9101f9ff23afd0a1f6"><div class="ttname"><a href="mutt_8h.html#aa8b893e8a8e83e9101f9ff23afd0a1f6">mutt_bit_set</a></div><div class="ttdeci">#define mutt_bit_set(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00623">mutt.h:623</a></div></div>
<div class="ttc" id="smtp_8c_html_a2cb3d0a3a556014703d33a0b3cafa3e5"><div class="ttname"><a href="smtp_8c.html#a2cb3d0a3a556014703d33a0b3cafa3e5">smtp_err_code</a></div><div class="ttdeci">#define smtp_err_code</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00050">smtp.c:50</a></div></div>
<div class="ttc" id="smtp_8c_html_a864d1b1264069d37762bca2c36c2a26e"><div class="ttname"><a href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a></div><div class="ttdeci">static unsigned char Capabilities[(CAPMAX+7)/8]</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00079">smtp.c:79</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a11ab51c9490b3f390e650b8826dc1fe4"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a11ab51c9490b3f390e650b8826dc1fe4">SMTPUTF8</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00064">smtp.c:64</a></div></div>
<div class="ttc" id="dcigettext_8c_html_a58257445f1a929304e537613b62ebb35"><div class="ttname"><a href="dcigettext_8c.html#a58257445f1a929304e537613b62ebb35">n</a></div><div class="ttdeci">unsigned long int n</div><div class="ttdef"><b>Definition:</b> <a href="dcigettext_8c_source.html#l00407">dcigettext.c:407</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a81b701d65406433d3b37bb2057213266"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a81b701d65406433d3b37bb2057213266">EIGHTBITMIME</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00063">smtp.c:63</a></div></div>
<div class="ttc" id="extlib_8c_html_a90829ddbd5f0edf736c9f6e595cfc0be"><div class="ttname"><a href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a></div><div class="ttdeci">void(* mutt_error)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="extlib_8c_source.html#l00037">extlib.c:37</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd">DSN</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00062">smtp.c:62</a></div></div>
<div class="ttc" id="lib_8c_html_a26d804f329dea2733da34a4953a22a9d"><div class="ttname"><a href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a></div><div class="ttdeci">char * safe_strdup(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00234">lib.c:234</a></div></div>
<div class="ttc" id="mutt__socket_8h_html_a88b274d2735e74bc83b2800b4b1196bb"><div class="ttname"><a href="mutt__socket_8h.html#a88b274d2735e74bc83b2800b4b1196bb">mutt_socket_readln</a></div><div class="ttdeci">#define mutt_socket_readln(A, B, C)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00059">mutt_socket.h:59</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609ae7cc0b2670caf4784fa8209e95971757"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609ae7cc0b2670caf4784fa8209e95971757">STARTTLS</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00060">smtp.c:60</a></div></div>
<div class="ttc" id="smtp_8c_html_a03a78f4a9181af45cac263f2a313e474"><div class="ttname"><a href="smtp_8c.html#a03a78f4a9181af45cac263f2a313e474">smtp_err_read</a></div><div class="ttdeci">#define smtp_err_read</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00048">smtp.c:48</a></div></div>
<div class="ttc" id="smtp_8c_html_a816bd1f7035855b6c4c4132b64571155"><div class="ttname"><a href="smtp_8c.html#a816bd1f7035855b6c4c4132b64571155">smtp_success</a></div><div class="ttdeci">#define smtp_success(x)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00044">smtp.c:44</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="smtp_8c_html_a4e61b16cfaf8c6f37eadbbcdf734e054"><div class="ttname"><a href="smtp_8c.html#a4e61b16cfaf8c6f37eadbbcdf734e054">AuthMechs</a></div><div class="ttdeci">static char * AuthMechs</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00078">smtp.c:78</a></div></div>
<div class="ttc" id="smtp_8c_html_a44a8faa29de46504ffad57d4f20b0487"><div class="ttname"><a href="smtp_8c.html#a44a8faa29de46504ffad57d4f20b0487">smtp_continue</a></div><div class="ttdeci">#define smtp_continue</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00046">smtp.c:46</a></div></div>
<div class="ttc" id="ascii_8c_html_a9d48a33ce9613b259cc8d7fbc04c4f0e"><div class="ttname"><a href="ascii_8c.html#a9d48a33ce9613b259cc8d7fbc04c4f0e">ascii_strncasecmp</a></div><div class="ttdeci">int ascii_strncasecmp(const char *a, const char *b, int n)</div><div class="ttdef"><b>Definition:</b> <a href="ascii_8c_source.html#l00088">ascii.c:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4573858e2fd480944bb8fa81d0ca8784"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4573858e2fd480944bb8fa81d0ca8784">&#9670;&nbsp;</a></span>smtp_rcpt_to()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int smtp_rcpt_to </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONNECTION.html">CONNECTION</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structADDRESS.html">ADDRESS</a> *&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00142">142</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;{</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordtype">char</span> buf[1024];</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordtype">int</span> r;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">while</span> (a)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">/* weed out group mailboxes, since those are for display only */</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> (!a-&gt;<a class="code" href="structADDRESS.html#a32f4c9272659da90e486d8ad80eef132">mailbox</a> || a-&gt;<a class="code" href="structADDRESS.html#a4df089a560cefb0a4bc3bfdd36a391b5">group</a>)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      a = a-&gt;<a class="code" href="structADDRESS.html#a3b16062c28e57119c480b6bd272dbb37">next</a>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt_8h.html#ab78c2ac3ac8230d19fcca57dc84eb3ae">mutt_bit_isset</a> (<a class="code" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a>, <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd">DSN</a>) &amp;&amp; <a class="code" href="globals_8h.html#aad30c5b3398eb28921883d7d94de27a8">DsnNotify</a>)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (buf, <span class="keyword">sizeof</span> (buf), <span class="stringliteral">&quot;RCPT TO:&lt;%s&gt; NOTIFY=%s\r\n&quot;</span>,</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                a-&gt;<a class="code" href="structADDRESS.html#a32f4c9272659da90e486d8ad80eef132">mailbox</a>, <a class="code" href="globals_8h.html#aad30c5b3398eb28921883d7d94de27a8">DsnNotify</a>);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (buf, <span class="keyword">sizeof</span> (buf), <span class="stringliteral">&quot;RCPT TO:&lt;%s&gt;\r\n&quot;</span>, a-&gt;<a class="code" href="structADDRESS.html#a32f4c9272659da90e486d8ad80eef132">mailbox</a>);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a> (conn, buf) == -1)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> ((r = <a class="code" href="smtp_8c.html#a89fdbb31e8fca646b1415e9fda4a48cf">smtp_get_resp</a> (conn)))</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">return</span> r;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    a = a-&gt;<a class="code" href="structADDRESS.html#a3b16062c28e57119c480b6bd272dbb37">next</a>;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;}</div><div class="ttc" id="mutt__socket_8h_html_a8b6a425c6e3188a9378580f0d28d90b7"><div class="ttname"><a href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a></div><div class="ttdeci">#define mutt_socket_write(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00061">mutt_socket.h:61</a></div></div>
<div class="ttc" id="mutt_8h_html_ab78c2ac3ac8230d19fcca57dc84eb3ae"><div class="ttname"><a href="mutt_8h.html#ab78c2ac3ac8230d19fcca57dc84eb3ae">mutt_bit_isset</a></div><div class="ttdeci">#define mutt_bit_isset(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00626">mutt.h:626</a></div></div>
<div class="ttc" id="structADDRESS_html_a3b16062c28e57119c480b6bd272dbb37"><div class="ttname"><a href="structADDRESS.html#a3b16062c28e57119c480b6bd272dbb37">ADDRESS::next</a></div><div class="ttdeci">struct address_t * next</div><div class="ttdef"><b>Definition:</b> <a href="rfc822_8h_source.html#l00044">rfc822.h:44</a></div></div>
<div class="ttc" id="smtp_8c_html_a89fdbb31e8fca646b1415e9fda4a48cf"><div class="ttname"><a href="smtp_8c.html#a89fdbb31e8fca646b1415e9fda4a48cf">smtp_get_resp</a></div><div class="ttdeci">static int smtp_get_resp(CONNECTION *conn)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00102">smtp.c:102</a></div></div>
<div class="ttc" id="smtp_8c_html_a864d1b1264069d37762bca2c36c2a26e"><div class="ttname"><a href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a></div><div class="ttdeci">static unsigned char Capabilities[(CAPMAX+7)/8]</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00079">smtp.c:79</a></div></div>
<div class="ttc" id="globals_8h_html_aad30c5b3398eb28921883d7d94de27a8"><div class="ttname"><a href="globals_8h.html#aad30c5b3398eb28921883d7d94de27a8">DsnNotify</a></div><div class="ttdeci">WHERE char * DsnNotify</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00050">globals.h:50</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd">DSN</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00062">smtp.c:62</a></div></div>
<div class="ttc" id="structADDRESS_html_a32f4c9272659da90e486d8ad80eef132"><div class="ttname"><a href="structADDRESS.html#a32f4c9272659da90e486d8ad80eef132">ADDRESS::mailbox</a></div><div class="ttdeci">char * mailbox</div><div class="ttdef"><b>Definition:</b> <a href="rfc822_8h_source.html#l00042">rfc822.h:42</a></div></div>
<div class="ttc" id="structADDRESS_html_a4df089a560cefb0a4bc3bfdd36a391b5"><div class="ttname"><a href="structADDRESS.html#a4df089a560cefb0a4bc3bfdd36a391b5">ADDRESS::group</a></div><div class="ttdeci">int group</div><div class="ttdef"><b>Definition:</b> <a href="rfc822_8h_source.html#l00043">rfc822.h:43</a></div></div>
<div class="ttc" id="smtp_8c_html_a1816449b160df247d202072e542a32a1"><div class="ttname"><a href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a></div><div class="ttdeci">#define smtp_err_write</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00049">smtp.c:49</a></div></div>
<div class="ttc" id="dotlock_8c_html_a357a42eb6494ea592e9c3f96c55cebe2"><div class="ttname"><a href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a></div><div class="ttdeci">int snprintf(char *, size_t, const char *,...)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a043b2ff2473aeb7e19afb585ee1957af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a043b2ff2473aeb7e19afb585ee1957af">&#9670;&nbsp;</a></span>smtp_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int smtp_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONNECTION.html">CONNECTION</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>msgfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00171">171</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;{</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordtype">char</span> buf[1024];</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  FILE *fp = 0;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <a class="code" href="structprogress__t.html">progress_t</a> progress;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keyword">struct </span>stat st;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordtype">int</span> r, term = 0;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordtype">size_t</span> buflen = 0;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  fp = fopen (msgfile, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">if</span> (!fp)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;SMTP session failed: unable to open %s&quot;</span>), msgfile);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  stat (msgfile, &amp;st);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  unlink (msgfile);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="curs__lib_8c.html#a31d880349dbde736393f9f4205b9121d">mutt_progress_init</a> (&amp;progress, <a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Sending message...&quot;</span>), <a class="code" href="mutt__curses_8h.html#a6f348ff00c346a8800ecb62b776a31ef">MUTT_PROGRESS_SIZE</a>,</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                      NetInc, st.st_size);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (buf, <span class="keyword">sizeof</span> (buf), <span class="stringliteral">&quot;DATA\r\n&quot;</span>);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a> (conn, buf) == -1)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="lib_8c.html#af03da38defdb7d2ba4e9e517c3c54836">safe_fclose</a> (&amp;fp);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">if</span> ((r = <a class="code" href="smtp_8c.html#a89fdbb31e8fca646b1415e9fda4a48cf">smtp_get_resp</a> (conn)))</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="lib_8c.html#af03da38defdb7d2ba4e9e517c3c54836">safe_fclose</a> (&amp;fp);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">return</span> r;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">while</span> (fgets (buf, <span class="keyword">sizeof</span> (buf) - 1, fp))</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    buflen = <a class="code" href="lib_8c.html#a00be9c99a4660441645a663008f85cbe">mutt_strlen</a> (buf);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    term = buflen &amp;&amp; buf[buflen-1] == <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> (term &amp;&amp; (buflen == 1 || buf[buflen - 2] != <span class="charliteral">&#39;\r&#39;</span>))</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (buf + buflen - 1, <span class="keyword">sizeof</span> (buf) - buflen + 1, <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">if</span> (buf[0] == <span class="charliteral">&#39;.&#39;</span>)</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="mutt__socket_8c.html#aae4f15275d152601fb8f0943aff2b543">mutt_socket_write_d</a> (conn, <span class="stringliteral">&quot;.&quot;</span>, -1, <a class="code" href="mutt__socket_8h.html#a20fef332e75f8a0589dfdfac3f034037">MUTT_SOCK_LOG_FULL</a>) == -1)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <a class="code" href="lib_8c.html#af03da38defdb7d2ba4e9e517c3c54836">safe_fclose</a> (&amp;fp);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt__socket_8c.html#aae4f15275d152601fb8f0943aff2b543">mutt_socket_write_d</a> (conn, buf, -1, <a class="code" href="mutt__socket_8h.html#a20fef332e75f8a0589dfdfac3f034037">MUTT_SOCK_LOG_FULL</a>) == -1)</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <a class="code" href="lib_8c.html#af03da38defdb7d2ba4e9e517c3c54836">safe_fclose</a> (&amp;fp);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="curs__lib_8c.html#a1d2bd337acff989fac73cd5aadf727b9">mutt_progress_update</a> (&amp;progress, ftell (fp), -1);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">if</span> (!term &amp;&amp; buflen &amp;&amp;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <a class="code" href="mutt__socket_8c.html#aae4f15275d152601fb8f0943aff2b543">mutt_socket_write_d</a> (conn, <span class="stringliteral">&quot;\r\n&quot;</span>, -1, <a class="code" href="mutt__socket_8h.html#a20fef332e75f8a0589dfdfac3f034037">MUTT_SOCK_LOG_FULL</a>) == -1)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="lib_8c.html#af03da38defdb7d2ba4e9e517c3c54836">safe_fclose</a> (&amp;fp);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="lib_8c.html#af03da38defdb7d2ba4e9e517c3c54836">safe_fclose</a> (&amp;fp);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">/* terminate the message body */</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a> (conn, <span class="stringliteral">&quot;.\r\n&quot;</span>) == -1)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">if</span> ((r = <a class="code" href="smtp_8c.html#a89fdbb31e8fca646b1415e9fda4a48cf">smtp_get_resp</a> (conn)))</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">return</span> r;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;}</div><div class="ttc" id="mutt__socket_8c_html_aae4f15275d152601fb8f0943aff2b543"><div class="ttname"><a href="mutt__socket_8c.html#aae4f15275d152601fb8f0943aff2b543">mutt_socket_write_d</a></div><div class="ttdeci">int mutt_socket_write_d(CONNECTION *conn, const char *buf, int len, int dbg)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8c_source.html#l00112">mutt_socket.c:112</a></div></div>
<div class="ttc" id="lib_8c_html_a00be9c99a4660441645a663008f85cbe"><div class="ttname"><a href="lib_8c.html#a00be9c99a4660441645a663008f85cbe">mutt_strlen</a></div><div class="ttdeci">size_t mutt_strlen(const char *a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00912">lib.c:912</a></div></div>
<div class="ttc" id="mutt__socket_8h_html_a8b6a425c6e3188a9378580f0d28d90b7"><div class="ttname"><a href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a></div><div class="ttdeci">#define mutt_socket_write(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00061">mutt_socket.h:61</a></div></div>
<div class="ttc" id="curs__lib_8c_html_a31d880349dbde736393f9f4205b9121d"><div class="ttname"><a href="curs__lib_8c.html#a31d880349dbde736393f9f4205b9121d">mutt_progress_init</a></div><div class="ttdeci">void mutt_progress_init(progress_t *progress, const char *msg, unsigned short flags, unsigned short inc, long size)</div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00389">curs_lib.c:389</a></div></div>
<div class="ttc" id="smtp_8c_html_a89fdbb31e8fca646b1415e9fda4a48cf"><div class="ttname"><a href="smtp_8c.html#a89fdbb31e8fca646b1415e9fda4a48cf">smtp_get_resp</a></div><div class="ttdeci">static int smtp_get_resp(CONNECTION *conn)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00102">smtp.c:102</a></div></div>
<div class="ttc" id="mutt__socket_8h_html_a20fef332e75f8a0589dfdfac3f034037"><div class="ttname"><a href="mutt__socket_8h.html#a20fef332e75f8a0589dfdfac3f034037">MUTT_SOCK_LOG_FULL</a></div><div class="ttdeci">#define MUTT_SOCK_LOG_FULL</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00029">mutt_socket.h:29</a></div></div>
<div class="ttc" id="structprogress__t_html"><div class="ttname"><a href="structprogress__t.html">progress_t</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt__curses_8h_source.html#l00160">mutt_curses.h:160</a></div></div>
<div class="ttc" id="extlib_8c_html_a90829ddbd5f0edf736c9f6e595cfc0be"><div class="ttname"><a href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a></div><div class="ttdeci">void(* mutt_error)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="extlib_8c_source.html#l00037">extlib.c:37</a></div></div>
<div class="ttc" id="lib_8c_html_af03da38defdb7d2ba4e9e517c3c54836"><div class="ttname"><a href="lib_8c.html#af03da38defdb7d2ba4e9e517c3c54836">safe_fclose</a></div><div class="ttdeci">int safe_fclose(FILE **f)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00203">lib.c:203</a></div></div>
<div class="ttc" id="curs__lib_8c_html_a1d2bd337acff989fac73cd5aadf727b9"><div class="ttname"><a href="curs__lib_8c.html#a1d2bd337acff989fac73cd5aadf727b9">mutt_progress_update</a></div><div class="ttdeci">void mutt_progress_update(progress_t *progress, long pos, int percent)</div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00491">curs_lib.c:491</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="smtp_8c_html_a1816449b160df247d202072e542a32a1"><div class="ttname"><a href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a></div><div class="ttdeci">#define smtp_err_write</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00049">smtp.c:49</a></div></div>
<div class="ttc" id="dotlock_8c_html_a357a42eb6494ea592e9c3f96c55cebe2"><div class="ttname"><a href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a></div><div class="ttdeci">int snprintf(char *, size_t, const char *,...)</div></div>
<div class="ttc" id="mutt__curses_8h_html_a6f348ff00c346a8800ecb62b776a31ef"><div class="ttname"><a href="mutt__curses_8h.html#a6f348ff00c346a8800ecb62b776a31ef">MUTT_PROGRESS_SIZE</a></div><div class="ttdeci">#define MUTT_PROGRESS_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="mutt__curses_8h_source.html#l00157">mutt_curses.h:157</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7052392c4bab85f8e0b231617a3f5312"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7052392c4bab85f8e0b231617a3f5312">&#9670;&nbsp;</a></span>address_uses_unicode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int address_uses_unicode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00245">245</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">if</span> (!a)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">while</span> (*a)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) *a &amp; (1&lt;&lt;7))</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    a++;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a372905fefabbe5ed994926e9111e2226"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a372905fefabbe5ed994926e9111e2226">&#9670;&nbsp;</a></span>addresses_use_unicode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int addresses_use_unicode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structADDRESS.html">ADDRESS</a> *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00264">264</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordflow">while</span> (a)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span>(a-&gt;<a class="code" href="structADDRESS.html#a32f4c9272659da90e486d8ad80eef132">mailbox</a> &amp;&amp; !a-&gt;<a class="code" href="structADDRESS.html#a4df089a560cefb0a4bc3bfdd36a391b5">group</a> &amp;&amp; <a class="code" href="smtp_8c.html#a7052392c4bab85f8e0b231617a3f5312">address_uses_unicode</a>(a-&gt;<a class="code" href="structADDRESS.html#a32f4c9272659da90e486d8ad80eef132">mailbox</a>))</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    a = a-&gt;<a class="code" href="structADDRESS.html#a3b16062c28e57119c480b6bd272dbb37">next</a>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;}</div><div class="ttc" id="structADDRESS_html_a3b16062c28e57119c480b6bd272dbb37"><div class="ttname"><a href="structADDRESS.html#a3b16062c28e57119c480b6bd272dbb37">ADDRESS::next</a></div><div class="ttdeci">struct address_t * next</div><div class="ttdef"><b>Definition:</b> <a href="rfc822_8h_source.html#l00044">rfc822.h:44</a></div></div>
<div class="ttc" id="structADDRESS_html_a32f4c9272659da90e486d8ad80eef132"><div class="ttname"><a href="structADDRESS.html#a32f4c9272659da90e486d8ad80eef132">ADDRESS::mailbox</a></div><div class="ttdeci">char * mailbox</div><div class="ttdef"><b>Definition:</b> <a href="rfc822_8h_source.html#l00042">rfc822.h:42</a></div></div>
<div class="ttc" id="smtp_8c_html_a7052392c4bab85f8e0b231617a3f5312"><div class="ttname"><a href="smtp_8c.html#a7052392c4bab85f8e0b231617a3f5312">address_uses_unicode</a></div><div class="ttdeci">static int address_uses_unicode(const char *a)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00245">smtp.c:245</a></div></div>
<div class="ttc" id="structADDRESS_html_a4df089a560cefb0a4bc3bfdd36a391b5"><div class="ttname"><a href="structADDRESS.html#a4df089a560cefb0a4bc3bfdd36a391b5">ADDRESS::group</a></div><div class="ttdeci">int group</div><div class="ttdef"><b>Definition:</b> <a href="rfc822_8h_source.html#l00043">rfc822.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a025390cb6e4c15df20678a380e23da1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a025390cb6e4c15df20678a380e23da1e">&#9670;&nbsp;</a></span>mutt_smtp_send()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_smtp_send </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structADDRESS.html">ADDRESS</a> *&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structADDRESS.html">ADDRESS</a> *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structADDRESS.html">ADDRESS</a> *&#160;</td>
          <td class="paramname"><em>cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structADDRESS.html">ADDRESS</a> *&#160;</td>
          <td class="paramname"><em>bcc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>msgfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eightbit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00277">277</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;{</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="structCONNECTION.html">CONNECTION</a> *conn;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="structACCOUNT.html">ACCOUNT</a> account;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* envfrom;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordtype">char</span> buf[1024];</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordtype">int</span> ret = -1;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">/* it might be better to synthesize an envelope from from user and host</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">   * but this condition is most likely arrived at accidentally */</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="globals_8h.html#a8e906d12625516687373c4ac28d2ccfe">EnvFrom</a>)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    envfrom = <a class="code" href="globals_8h.html#a8e906d12625516687373c4ac28d2ccfe">EnvFrom</a>-&gt;<a class="code" href="structADDRESS.html#a32f4c9272659da90e486d8ad80eef132">mailbox</a>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (from)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    envfrom = from-&gt;<a class="code" href="structADDRESS.html#a32f4c9272659da90e486d8ad80eef132">mailbox</a>;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No from address given&quot;</span>));</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="smtp_8c.html#a9a75505bd53f738baa45179f85c970b3">smtp_fill_account</a> (&amp;account) &lt; 0)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">if</span> (!(conn = <a class="code" href="mutt__socket_8c.html#a9fa16f74786c0d1e3d7b09fe8a6b107e">mutt_conn_find</a> (<a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;account)))</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <a class="code" href="smtp_8c.html#aee943fe85d22876d59094cf9d82d8fe6">Esmtp</a> = eightbit;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">do</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">/* send our greeting */</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">if</span> (( ret = <a class="code" href="smtp_8c.html#a0de44525c1ea8977b943f3fb86386bf2">smtp_open</a> (conn)))</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a> (&amp;<a class="code" href="smtp_8c.html#a4e61b16cfaf8c6f37eadbbcdf734e054">AuthMechs</a>);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">/* send the sender&#39;s address */</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    ret = <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (buf, <span class="keyword">sizeof</span> (buf), <span class="stringliteral">&quot;MAIL FROM:&lt;%s&gt;&quot;</span>, envfrom);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">if</span> (eightbit &amp;&amp; <a class="code" href="mutt_8h.html#ab78c2ac3ac8230d19fcca57dc84eb3ae">mutt_bit_isset</a> (<a class="code" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a>, <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a81b701d65406433d3b37bb2057213266">EIGHTBITMIME</a>))</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <a class="code" href="lib_8c.html#ac3744fac3824735710a762a464759275">safe_strncat</a> (buf, <span class="keyword">sizeof</span> (buf), <span class="stringliteral">&quot; BODY=8BITMIME&quot;</span>, 15);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      ret += 14;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="globals_8h.html#adec33ef673f99787b8b5c431a23928ef">DsnReturn</a> &amp;&amp; <a class="code" href="mutt_8h.html#ab78c2ac3ac8230d19fcca57dc84eb3ae">mutt_bit_isset</a> (<a class="code" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a>, <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd">DSN</a>))</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      ret += <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (buf + ret, <span class="keyword">sizeof</span> (buf) - ret, <span class="stringliteral">&quot; RET=%s&quot;</span>, <a class="code" href="globals_8h.html#adec33ef673f99787b8b5c431a23928ef">DsnReturn</a>);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt_8h.html#ab78c2ac3ac8230d19fcca57dc84eb3ae">mutt_bit_isset</a> (<a class="code" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a>, <a class="code" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a11ab51c9490b3f390e650b8826dc1fe4">SMTPUTF8</a>) &amp;&amp;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        (<a class="code" href="smtp_8c.html#a7052392c4bab85f8e0b231617a3f5312">address_uses_unicode</a>(envfrom) ||</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;         <a class="code" href="smtp_8c.html#a372905fefabbe5ed994926e9111e2226">addresses_use_unicode</a>(to) ||</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;         <a class="code" href="smtp_8c.html#a372905fefabbe5ed994926e9111e2226">addresses_use_unicode</a>(cc) ||</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;         <a class="code" href="smtp_8c.html#a372905fefabbe5ed994926e9111e2226">addresses_use_unicode</a>(bcc)))</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      ret += <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (buf + ret, <span class="keyword">sizeof</span> (buf) - ret, <span class="stringliteral">&quot; SMTPUTF8&quot;</span>);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="lib_8c.html#ac3744fac3824735710a762a464759275">safe_strncat</a> (buf, <span class="keyword">sizeof</span> (buf), <span class="stringliteral">&quot;\r\n&quot;</span>, 3);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a> (conn, buf) == -1)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      ret = <a class="code" href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span> ((ret = <a class="code" href="smtp_8c.html#a89fdbb31e8fca646b1415e9fda4a48cf">smtp_get_resp</a> (conn)))</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">/* send the recipient list */</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">if</span> ((ret = <a class="code" href="smtp_8c.html#a4573858e2fd480944bb8fa81d0ca8784">smtp_rcpt_to</a> (conn, to)) || (ret = <a class="code" href="smtp_8c.html#a4573858e2fd480944bb8fa81d0ca8784">smtp_rcpt_to</a> (conn, cc))</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        || (ret = <a class="code" href="smtp_8c.html#a4573858e2fd480944bb8fa81d0ca8784">smtp_rcpt_to</a> (conn, bcc)))</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">/* send the message data */</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">if</span> ((ret = <a class="code" href="smtp_8c.html#a043b2ff2473aeb7e19afb585ee1957af">smtp_data</a> (conn, msgfile)))</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a> (conn, <span class="stringliteral">&quot;QUIT\r\n&quot;</span>);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    ret = 0;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordflow">while</span> (0);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordflow">if</span> (conn)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="mutt__socket_8c.html#a27ea30f9e2d3bd1c955fc1a612912ee5">mutt_socket_close</a> (conn);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordflow">if</span> (ret == <a class="code" href="smtp_8c.html#a03a78f4a9181af45cac263f2a313e474">smtp_err_read</a>)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;SMTP session failed: read error&quot;</span>));</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == <a class="code" href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a>)</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;SMTP session failed: write error&quot;</span>));</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == <a class="code" href="smtp_8c.html#a2cb3d0a3a556014703d33a0b3cafa3e5">smtp_err_code</a>)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a> (<a class="code" href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Invalid server response&quot;</span>));</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div><div class="ttc" id="explodename_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="explodename_8c_source.html#l00034">explodename.c:34</a></div></div>
<div class="ttc" id="mutt__socket_8c_html_a9fa16f74786c0d1e3d7b09fe8a6b107e"><div class="ttname"><a href="mutt__socket_8c.html#a9fa16f74786c0d1e3d7b09fe8a6b107e">mutt_conn_find</a></div><div class="ttdeci">CONNECTION * mutt_conn_find(const CONNECTION *start, const ACCOUNT *account)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8c_source.html#l00263">mutt_socket.c:263</a></div></div>
<div class="ttc" id="lib_8c_html_ac3744fac3824735710a762a464759275"><div class="ttname"><a href="lib_8c.html#ac3744fac3824735710a762a464759275">safe_strncat</a></div><div class="ttdeci">char * safe_strncat(char *d, size_t l, const char *s, size_t sl)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00266">lib.c:266</a></div></div>
<div class="ttc" id="mutt__socket_8h_html_a8b6a425c6e3188a9378580f0d28d90b7"><div class="ttname"><a href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a></div><div class="ttdeci">#define mutt_socket_write(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00061">mutt_socket.h:61</a></div></div>
<div class="ttc" id="mutt_8h_html_ab78c2ac3ac8230d19fcca57dc84eb3ae"><div class="ttname"><a href="mutt_8h.html#ab78c2ac3ac8230d19fcca57dc84eb3ae">mutt_bit_isset</a></div><div class="ttdeci">#define mutt_bit_isset(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00626">mutt.h:626</a></div></div>
<div class="ttc" id="structACCOUNT_html"><div class="ttname"><a href="structACCOUNT.html">ACCOUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="account_8h_source.html#l00043">account.h:43</a></div></div>
<div class="ttc" id="lib_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00077">lib.h:77</a></div></div>
<div class="ttc" id="smtp_8c_html_a89fdbb31e8fca646b1415e9fda4a48cf"><div class="ttname"><a href="smtp_8c.html#a89fdbb31e8fca646b1415e9fda4a48cf">smtp_get_resp</a></div><div class="ttdeci">static int smtp_get_resp(CONNECTION *conn)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00102">smtp.c:102</a></div></div>
<div class="ttc" id="mutt__socket_8c_html_a27ea30f9e2d3bd1c955fc1a612912ee5"><div class="ttname"><a href="mutt__socket_8c.html#a27ea30f9e2d3bd1c955fc1a612912ee5">mutt_socket_close</a></div><div class="ttdeci">int mutt_socket_close(CONNECTION *conn)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8c_source.html#l00074">mutt_socket.c:74</a></div></div>
<div class="ttc" id="smtp_8c_html_a2cb3d0a3a556014703d33a0b3cafa3e5"><div class="ttname"><a href="smtp_8c.html#a2cb3d0a3a556014703d33a0b3cafa3e5">smtp_err_code</a></div><div class="ttdeci">#define smtp_err_code</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00050">smtp.c:50</a></div></div>
<div class="ttc" id="smtp_8c_html_aee943fe85d22876d59094cf9d82d8fe6"><div class="ttname"><a href="smtp_8c.html#aee943fe85d22876d59094cf9d82d8fe6">Esmtp</a></div><div class="ttdeci">static int Esmtp</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00077">smtp.c:77</a></div></div>
<div class="ttc" id="smtp_8c_html_a372905fefabbe5ed994926e9111e2226"><div class="ttname"><a href="smtp_8c.html#a372905fefabbe5ed994926e9111e2226">addresses_use_unicode</a></div><div class="ttdeci">static int addresses_use_unicode(const ADDRESS *a)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00264">smtp.c:264</a></div></div>
<div class="ttc" id="smtp_8c_html_a864d1b1264069d37762bca2c36c2a26e"><div class="ttname"><a href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a></div><div class="ttdeci">static unsigned char Capabilities[(CAPMAX+7)/8]</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00079">smtp.c:79</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a11ab51c9490b3f390e650b8826dc1fe4"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a11ab51c9490b3f390e650b8826dc1fe4">SMTPUTF8</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00064">smtp.c:64</a></div></div>
<div class="ttc" id="smtp_8c_html_a043b2ff2473aeb7e19afb585ee1957af"><div class="ttname"><a href="smtp_8c.html#a043b2ff2473aeb7e19afb585ee1957af">smtp_data</a></div><div class="ttdeci">static int smtp_data(CONNECTION *conn, const char *msgfile)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00171">smtp.c:171</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a81b701d65406433d3b37bb2057213266"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a81b701d65406433d3b37bb2057213266">EIGHTBITMIME</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00063">smtp.c:63</a></div></div>
<div class="ttc" id="extlib_8c_html_a90829ddbd5f0edf736c9f6e595cfc0be"><div class="ttname"><a href="extlib_8c.html#a90829ddbd5f0edf736c9f6e595cfc0be">mutt_error</a></div><div class="ttdeci">void(* mutt_error)(const char *,...)</div><div class="ttdef"><b>Definition:</b> <a href="extlib_8c_source.html#l00037">extlib.c:37</a></div></div>
<div class="ttc" id="smtp_8c_html_a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd"><div class="ttname"><a href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a0d3ca538f7747b4aab4b486c6984bfbd">DSN</a></div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00062">smtp.c:62</a></div></div>
<div class="ttc" id="structADDRESS_html_a32f4c9272659da90e486d8ad80eef132"><div class="ttname"><a href="structADDRESS.html#a32f4c9272659da90e486d8ad80eef132">ADDRESS::mailbox</a></div><div class="ttdeci">char * mailbox</div><div class="ttdef"><b>Definition:</b> <a href="rfc822_8h_source.html#l00042">rfc822.h:42</a></div></div>
<div class="ttc" id="structCONNECTION_html"><div class="ttname"><a href="structCONNECTION.html">CONNECTION</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00031">mutt_socket.h:31</a></div></div>
<div class="ttc" id="smtp_8c_html_a9a75505bd53f738baa45179f85c970b3"><div class="ttname"><a href="smtp_8c.html#a9a75505bd53f738baa45179f85c970b3">smtp_fill_account</a></div><div class="ttdeci">static int smtp_fill_account(ACCOUNT *account)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00365">smtp.c:365</a></div></div>
<div class="ttc" id="smtp_8c_html_a7052392c4bab85f8e0b231617a3f5312"><div class="ttname"><a href="smtp_8c.html#a7052392c4bab85f8e0b231617a3f5312">address_uses_unicode</a></div><div class="ttdeci">static int address_uses_unicode(const char *a)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00245">smtp.c:245</a></div></div>
<div class="ttc" id="smtp_8c_html_a03a78f4a9181af45cac263f2a313e474"><div class="ttname"><a href="smtp_8c.html#a03a78f4a9181af45cac263f2a313e474">smtp_err_read</a></div><div class="ttdeci">#define smtp_err_read</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00048">smtp.c:48</a></div></div>
<div class="ttc" id="smtp_8c_html_a0de44525c1ea8977b943f3fb86386bf2"><div class="ttname"><a href="smtp_8c.html#a0de44525c1ea8977b943f3fb86386bf2">smtp_open</a></div><div class="ttdeci">static int smtp_open(CONNECTION *conn)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00445">smtp.c:445</a></div></div>
<div class="ttc" id="lib_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="lib_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00046">lib.h:46</a></div></div>
<div class="ttc" id="smtp_8c_html_a1816449b160df247d202072e542a32a1"><div class="ttname"><a href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a></div><div class="ttdeci">#define smtp_err_write</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00049">smtp.c:49</a></div></div>
<div class="ttc" id="dotlock_8c_html_a357a42eb6494ea592e9c3f96c55cebe2"><div class="ttname"><a href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a></div><div class="ttdeci">int snprintf(char *, size_t, const char *,...)</div></div>
<div class="ttc" id="globals_8h_html_a8e906d12625516687373c4ac28d2ccfe"><div class="ttname"><a href="globals_8h.html#a8e906d12625516687373c4ac28d2ccfe">EnvFrom</a></div><div class="ttdeci">WHERE ADDRESS * EnvFrom</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00031">globals.h:31</a></div></div>
<div class="ttc" id="smtp_8c_html_a4e61b16cfaf8c6f37eadbbcdf734e054"><div class="ttname"><a href="smtp_8c.html#a4e61b16cfaf8c6f37eadbbcdf734e054">AuthMechs</a></div><div class="ttdeci">static char * AuthMechs</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00078">smtp.c:78</a></div></div>
<div class="ttc" id="globals_8h_html_adec33ef673f99787b8b5c431a23928ef"><div class="ttname"><a href="globals_8h.html#adec33ef673f99787b8b5c431a23928ef">DsnReturn</a></div><div class="ttdeci">WHERE char * DsnReturn</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00051">globals.h:51</a></div></div>
<div class="ttc" id="smtp_8c_html_a4573858e2fd480944bb8fa81d0ca8784"><div class="ttname"><a href="smtp_8c.html#a4573858e2fd480944bb8fa81d0ca8784">smtp_rcpt_to</a></div><div class="ttdeci">static int smtp_rcpt_to(CONNECTION *conn, const ADDRESS *a)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00142">smtp.c:142</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a25add54877c2d71a9f3ef7ac4d823c7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25add54877c2d71a9f3ef7ac4d823c7c">&#9670;&nbsp;</a></span>smtp_helo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int smtp_helo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCONNECTION.html">CONNECTION</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00414">414</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;{</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordtype">char</span> buf[<a class="code" href="dotlock_8c.html#a2ed4d73ac96556fca2623216ca4a4e4a">LONG_STRING</a>];</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* fqdn;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <a class="code" href="protos_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (<a class="code" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a>, 0, <span class="keyword">sizeof</span> (<a class="code" href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a>));</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="smtp_8c.html#aee943fe85d22876d59094cf9d82d8fe6">Esmtp</a>)</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  {</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">/* if TLS or AUTH are requested, use EHLO */</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structCONNECTION.html#ae90ecbc270392096c73277cf7ac07fb5">account</a>.<a class="code" href="structACCOUNT.html#a6e2d0a9b75bfe913e0e848c76df21a6c">flags</a> &amp; <a class="code" href="account_8h.html#ab496cae7636af7b356aad973a4a2e675">MUTT_ACCT_USER</a>)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <a class="code" href="smtp_8c.html#aee943fe85d22876d59094cf9d82d8fe6">Esmtp</a> = 1;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="preprocessor">#ifdef USE_SSL</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt_8h.html#ae01642ac28c3b02ba17e0020477e90c1">option</a> (OPTSSLFORCETLS) || <a class="code" href="init_8c.html#a8c4255d9b94cc433de3f56fe1e08356d">quadoption</a> (OPT_SSLSTARTTLS) != <a class="code" href="mutt_8h.html#a39fca1837c5ce7715cbf571669660c13abe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a>)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <a class="code" href="smtp_8c.html#aee943fe85d22876d59094cf9d82d8fe6">Esmtp</a> = 1;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordflow">if</span>(!(fqdn = <a class="code" href="protos_8h.html#aecd9b32c37607d142c079e370070700a">mutt_fqdn</a> (0)))</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    fqdn = <a class="code" href="lib_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a> (<a class="code" href="globals_8h.html#aee983eb9cbe744b096f092e64abe21e0">Hostname</a>);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a> (buf, <span class="keyword">sizeof</span> (buf), <span class="stringliteral">&quot;%s %s\r\n&quot;</span>, <a class="code" href="smtp_8c.html#aee943fe85d22876d59094cf9d82d8fe6">Esmtp</a> ? <span class="stringliteral">&quot;EHLO&quot;</span> : <span class="stringliteral">&quot;HELO&quot;</span>, fqdn);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">/* XXX there should probably be a wrapper in mutt_socket.c that</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">    * repeatedly calls conn-&gt;write until all data is sent.  This</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">    * currently doesn&#39;t check for a short write.</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a> (conn, buf) == -1)</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="smtp_8c.html#a89fdbb31e8fca646b1415e9fda4a48cf">smtp_get_resp</a> (conn);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div><div class="ttc" id="account_8h_html_ab496cae7636af7b356aad973a4a2e675"><div class="ttname"><a href="account_8h.html#ab496cae7636af7b356aad973a4a2e675">MUTT_ACCT_USER</a></div><div class="ttdeci">#define MUTT_ACCT_USER</div><div class="ttdef"><b>Definition:</b> <a href="account_8h_source.html#l00038">account.h:38</a></div></div>
<div class="ttc" id="mutt__socket_8h_html_a8b6a425c6e3188a9378580f0d28d90b7"><div class="ttname"><a href="mutt__socket_8h.html#a8b6a425c6e3188a9378580f0d28d90b7">mutt_socket_write</a></div><div class="ttdeci">#define mutt_socket_write(A, B)</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00061">mutt_socket.h:61</a></div></div>
<div class="ttc" id="protos_8h_html_aecd9b32c37607d142c079e370070700a"><div class="ttname"><a href="protos_8h.html#aecd9b32c37607d142c079e370070700a">mutt_fqdn</a></div><div class="ttdeci">const char * mutt_fqdn(short)</div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l02158">sendlib.c:2158</a></div></div>
<div class="ttc" id="smtp_8c_html_a89fdbb31e8fca646b1415e9fda4a48cf"><div class="ttname"><a href="smtp_8c.html#a89fdbb31e8fca646b1415e9fda4a48cf">smtp_get_resp</a></div><div class="ttdeci">static int smtp_get_resp(CONNECTION *conn)</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00102">smtp.c:102</a></div></div>
<div class="ttc" id="smtp_8c_html_aee943fe85d22876d59094cf9d82d8fe6"><div class="ttname"><a href="smtp_8c.html#aee943fe85d22876d59094cf9d82d8fe6">Esmtp</a></div><div class="ttdeci">static int Esmtp</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00077">smtp.c:77</a></div></div>
<div class="ttc" id="smtp_8c_html_a864d1b1264069d37762bca2c36c2a26e"><div class="ttname"><a href="smtp_8c.html#a864d1b1264069d37762bca2c36c2a26e">Capabilities</a></div><div class="ttdeci">static unsigned char Capabilities[(CAPMAX+7)/8]</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00079">smtp.c:79</a></div></div>
<div class="ttc" id="mutt_8h_html_ae01642ac28c3b02ba17e0020477e90c1"><div class="ttname"><a href="mutt_8h.html#ae01642ac28c3b02ba17e0020477e90c1">option</a></div><div class="ttdeci">#define option(x)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00631">mutt.h:631</a></div></div>
<div class="ttc" id="structCONNECTION_html_ae90ecbc270392096c73277cf7ac07fb5"><div class="ttname"><a href="structCONNECTION.html#ae90ecbc270392096c73277cf7ac07fb5">CONNECTION::account</a></div><div class="ttdeci">ACCOUNT account</div><div class="ttdef"><b>Definition:</b> <a href="mutt__socket_8h_source.html#l00033">mutt_socket.h:33</a></div></div>
<div class="ttc" id="init_8c_html_a8c4255d9b94cc433de3f56fe1e08356d"><div class="ttname"><a href="init_8c.html#a8c4255d9b94cc433de3f56fe1e08356d">quadoption</a></div><div class="ttdeci">int quadoption(int opt)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00107">init.c:107</a></div></div>
<div class="ttc" id="structACCOUNT_html_a6e2d0a9b75bfe913e0e848c76df21a6c"><div class="ttname"><a href="structACCOUNT.html#a6e2d0a9b75bfe913e0e848c76df21a6c">ACCOUNT::flags</a></div><div class="ttdeci">unsigned char flags</div><div class="ttdef"><b>Definition:</b> <a href="account_8h_source.html#l00051">account.h:51</a></div></div>
<div class="ttc" id="lib_8h_html_a7e0481bed27661ea2679f256b24e0283"><div class="ttname"><a href="lib_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a></div><div class="ttdeci">#define NONULL(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00078">lib.h:78</a></div></div>
<div class="ttc" id="smtp_8c_html_a1816449b160df247d202072e542a32a1"><div class="ttname"><a href="smtp_8c.html#a1816449b160df247d202072e542a32a1">smtp_err_write</a></div><div class="ttdeci">#define smtp_err_write</div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00049">smtp.c:49</a></div></div>
<div class="ttc" id="dotlock_8c_html_a357a42eb6494ea592e9c3f96c55cebe2"><div class="ttname"><a href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a></div><div class="ttdeci">int snprintf(char *, size_t, const char *,...)</div></div>
<div class="ttc" id="dotlock_8c_html_a2ed4d73ac96556fca2623216ca4a4e4a"><div class="ttname"><a href="dotlock_8c.html#a2ed4d73ac96556fca2623216ca4a4e4a">LONG_STRING</a></div><div class="ttdeci">#define LONG_STRING</div><div class="ttdef"><b>Definition:</b> <a href="dotlock_8c_source.html#l00063">dotlock.c:63</a></div></div>
<div class="ttc" id="globals_8h_html_aee983eb9cbe744b096f092e64abe21e0"><div class="ttname"><a href="globals_8h.html#aee983eb9cbe744b096f092e64abe21e0">Hostname</a></div><div class="ttdeci">WHERE char * Hostname</div><div class="ttdef"><b>Definition:</b> <a href="globals_8h_source.html#l00061">globals.h:61</a></div></div>
<div class="ttc" id="mutt_8h_html_a39fca1837c5ce7715cbf571669660c13abe3800cc419f25384aaf1892fc3c812b"><div class="ttname"><a href="mutt_8h.html#a39fca1837c5ce7715cbf571669660c13abe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00286">mutt.h:286</a></div></div>
<div class="ttc" id="protos_8h_html_adb03df3679ce1445e801310614624ccb"><div class="ttname"><a href="protos_8h.html#adb03df3679ce1445e801310614624ccb">memset</a></div><div class="ttdeci">void * memset()</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aee943fe85d22876d59094cf9d82d8fe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee943fe85d22876d59094cf9d82d8fe6">&#9670;&nbsp;</a></span>Esmtp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Esmtp = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00077">77</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
<a id="a4e61b16cfaf8c6f37eadbbcdf734e054"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e61b16cfaf8c6f37eadbbcdf734e054">&#9670;&nbsp;</a></span>AuthMechs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char* AuthMechs = <a class="el" href="regex_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00078">78</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
<a id="a864d1b1264069d37762bca2c36c2a26e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a864d1b1264069d37762bca2c36c2a26e">&#9670;&nbsp;</a></span>Capabilities</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char Capabilities[(<a class="el" href="smtp_8c.html#a458e651af6690959efa2afb96be7d609a59d924fd58cee243d7b1a29267e4bff4">CAPMAX</a>+7)/8]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="smtp_8c_source.html#l00079">79</a> of file <a class="el" href="smtp_8c_source.html">smtp.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
