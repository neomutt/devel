<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: hcache.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mutt.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">1.7.1</span>
   </div>
   <div id="projectbrief">Mail Reader</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">hcache.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="mutt_8h_source.html">mutt.h</a>&quot;</code><br />
</div>
<p><a href="hcache_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a53d002117c873a29e77bfadf9793f327"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hcache_8h.html#a53d002117c873a29e77bfadf9793f327">hcache_namer_t</a>) (<a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *path, char *dest, size_t dlen)</td></tr>
<tr class="separator:a53d002117c873a29e77bfadf9793f327"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae01c81d7bc2f290309a28bbb8474ff40"><td class="memItemLeft" align="right" valign="top">header_cache_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hcache_8h.html#ae01c81d7bc2f290309a28bbb8474ff40">mutt_hcache_open</a> (<a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *path, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *folder, <a class="el" href="hcache_8h.html#a53d002117c873a29e77bfadf9793f327">hcache_namer_t</a> namer)</td></tr>
<tr class="memdesc:ae01c81d7bc2f290309a28bbb8474ff40"><td class="mdescLeft">&#160;</td><td class="mdescRight">open the connection to the header cache.  <a href="#ae01c81d7bc2f290309a28bbb8474ff40">More...</a><br /></td></tr>
<tr class="separator:ae01c81d7bc2f290309a28bbb8474ff40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab70197e91a184083ea2ac9d4d75c47f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hcache_8h.html#ab70197e91a184083ea2ac9d4d75c47f0">mutt_hcache_close</a> (header_cache_t *h)</td></tr>
<tr class="memdesc:ab70197e91a184083ea2ac9d4d75c47f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">close the connection to the header cache.  <a href="#ab70197e91a184083ea2ac9d4d75c47f0">More...</a><br /></td></tr>
<tr class="separator:ab70197e91a184083ea2ac9d4d75c47f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a328c1cf43151360a9001b2423ffd6ab8"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hcache_8h.html#a328c1cf43151360a9001b2423ffd6ab8">mutt_hcache_fetch</a> (header_cache_t *h, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *<a class="el" href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, size_t keylen)</td></tr>
<tr class="memdesc:a328c1cf43151360a9001b2423ffd6ab8"><td class="mdescLeft">&#160;</td><td class="mdescRight">fetch and validate a message's header from the cache.  <a href="#a328c1cf43151360a9001b2423ffd6ab8">More...</a><br /></td></tr>
<tr class="separator:a328c1cf43151360a9001b2423ffd6ab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae65c9e1141287d9e21e541475df3f7bf"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hcache_8h.html#ae65c9e1141287d9e21e541475df3f7bf">mutt_hcache_fetch_raw</a> (header_cache_t *h, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *<a class="el" href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, size_t keylen)</td></tr>
<tr class="memdesc:ae65c9e1141287d9e21e541475df3f7bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">fetch a message's header from the cache.  <a href="#ae65c9e1141287d9e21e541475df3f7bf">More...</a><br /></td></tr>
<tr class="separator:ae65c9e1141287d9e21e541475df3f7bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51e16ac36abe59d7df4b6be113efe90c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hcache_8h.html#a51e16ac36abe59d7df4b6be113efe90c">mutt_hcache_free</a> (header_cache_t *h, void **data)</td></tr>
<tr class="memdesc:a51e16ac36abe59d7df4b6be113efe90c"><td class="mdescLeft">&#160;</td><td class="mdescRight">free previously fetched data.  <a href="#a51e16ac36abe59d7df4b6be113efe90c">More...</a><br /></td></tr>
<tr class="separator:a51e16ac36abe59d7df4b6be113efe90c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9823bf6c6a98105772e3dc6f92043a3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structHEADER.html">HEADER</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hcache_8h.html#a9823bf6c6a98105772e3dc6f92043a3a">mutt_hcache_restore</a> (<a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> unsigned char *d)</td></tr>
<tr class="memdesc:a9823bf6c6a98105772e3dc6f92043a3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">restore a <a class="el" href="structHEADER.html">HEADER</a> from data retrieved from the cache.  <a href="#a9823bf6c6a98105772e3dc6f92043a3a">More...</a><br /></td></tr>
<tr class="separator:a9823bf6c6a98105772e3dc6f92043a3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77d4c577fd723ef084ad2a9b018ba833"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hcache_8h.html#a77d4c577fd723ef084ad2a9b018ba833">mutt_hcache_store</a> (header_cache_t *h, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *<a class="el" href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, size_t keylen, <a class="el" href="structHEADER.html">HEADER</a> *header, unsigned int uidvalidity)</td></tr>
<tr class="memdesc:a77d4c577fd723ef084ad2a9b018ba833"><td class="mdescLeft">&#160;</td><td class="mdescRight">store a <a class="el" href="structHEADER.html">HEADER</a> along with a validity datum.  <a href="#a77d4c577fd723ef084ad2a9b018ba833">More...</a><br /></td></tr>
<tr class="separator:a77d4c577fd723ef084ad2a9b018ba833"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add0651518cff8eb01d398664cd98037b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hcache_8h.html#add0651518cff8eb01d398664cd98037b">mutt_hcache_store_raw</a> (header_cache_t *h, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *<a class="el" href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, size_t keylen, void *data, size_t dlen)</td></tr>
<tr class="memdesc:add0651518cff8eb01d398664cd98037b"><td class="mdescLeft">&#160;</td><td class="mdescRight">store a key / data pair.  <a href="#add0651518cff8eb01d398664cd98037b">More...</a><br /></td></tr>
<tr class="separator:add0651518cff8eb01d398664cd98037b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af464c9289099045a67095846de0939de"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hcache_8h.html#af464c9289099045a67095846de0939de">mutt_hcache_delete</a> (header_cache_t *h, <a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *<a class="el" href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, size_t keylen)</td></tr>
<tr class="memdesc:af464c9289099045a67095846de0939de"><td class="mdescLeft">&#160;</td><td class="mdescRight">delete a key / data pair.  <a href="#af464c9289099045a67095846de0939de">More...</a><br /></td></tr>
<tr class="separator:af464c9289099045a67095846de0939de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19989208cbd44d4083d872702017e1fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hcache_8h.html#a19989208cbd44d4083d872702017e1fc">mutt_hcache_backend_list</a> (void)</td></tr>
<tr class="memdesc:a19989208cbd44d4083d872702017e1fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">get a list of backend identification strings.  <a href="#a19989208cbd44d4083d872702017e1fc">More...</a><br /></td></tr>
<tr class="separator:a19989208cbd44d4083d872702017e1fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a69ce8852e97f26b5355cffddc69dcd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hcache_8h.html#a9a69ce8852e97f26b5355cffddc69dcd">mutt_hcache_is_valid_backend</a> (<a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *s)</td></tr>
<tr class="memdesc:a9a69ce8852e97f26b5355cffddc69dcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">mutt_hcache_is_valid_backend  <a href="#a9a69ce8852e97f26b5355cffddc69dcd">More...</a><br /></td></tr>
<tr class="separator:a9a69ce8852e97f26b5355cffddc69dcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a53d002117c873a29e77bfadf9793f327"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53d002117c873a29e77bfadf9793f327">&#9670;&nbsp;</a></span>hcache_namer_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* hcache_namer_t) (<a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *path, char *dest, size_t dlen)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="hcache_8h_source.html#l00030">30</a> of file <a class="el" href="hcache_8h_source.html">hcache.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae01c81d7bc2f290309a28bbb8474ff40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae01c81d7bc2f290309a28bbb8474ff40">&#9670;&nbsp;</a></span>mutt_hcache_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">header_cache_t* mutt_hcache_open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>folder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hcache_8h.html#a53d002117c873a29e77bfadf9793f327">hcache_namer_t</a>&#160;</td>
          <td class="paramname"><em>namer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>open the connection to the header cache. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>Location of the header cache (often as specified by the user). </td></tr>
    <tr><td class="paramname">folder</td><td>Name of the folder containing the messages. </td></tr>
    <tr><td class="paramname">namer</td><td>Optional (might be NULL) client-specific function to form the final name of the hcache database file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to a header_cache_t struct on success, NULL otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="hcache_8c_source.html#l00735">735</a> of file <a class="el" href="hcache_8c_source.html">hcache.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;{</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keyword">const</span> <a class="code" href="structhcache__ops__t.html">hcache_ops_t</a> *ops = <a class="code" href="hcache_8c.html#a51511cd14787b537b38ed24431384743">hcache_get_ops</a>();</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">if</span> (!ops)</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  header_cache_t *h = <a class="code" href="lib_8c.html#a725ea15665b1be820aee11fddd857f8a">safe_calloc</a>(1, <span class="keyword">sizeof</span> (header_cache_t));</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="comment">/* Calculate the current hcache version from dynamic configuration */</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="hcache_8c.html#ac0dde9400cb5f702e4b8c6fbd6e5c0ab">hcachever</a> == 0x0) {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keyword">union </span>{</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> charval[16];</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> intval;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    } digest;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keyword">struct </span><a class="code" href="structmd5__ctx.html">md5_ctx</a> ctx;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="structSPAM__LIST.html">SPAM_LIST</a> *spam;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <a class="code" href="structRX__LIST.html">RX_LIST</a> *nospam;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <a class="code" href="hcache_8c.html#ac0dde9400cb5f702e4b8c6fbd6e5c0ab">hcachever</a> = HCACHEVER;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="md5_8c.html#ac3ac4bf337ea2ebffcecb83d4533f877">md5_init_ctx</a>(&amp;ctx);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">/* Seed with the compiled-in header structure hash */</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="md5_8c.html#a2167ee252f9d864c15739ad707f9c88e">md5_process_bytes</a>(&amp;<a class="code" href="hcache_8c.html#ac0dde9400cb5f702e4b8c6fbd6e5c0ab">hcachever</a>, <span class="keyword">sizeof</span>(<a class="code" href="hcache_8c.html#ac0dde9400cb5f702e4b8c6fbd6e5c0ab">hcachever</a>), &amp;ctx);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="comment">/* Mix in user&#39;s spam list */</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">for</span> (spam = SpamList; spam; spam = spam-&gt;next)</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <a class="code" href="md5_8c.html#a2167ee252f9d864c15739ad707f9c88e">md5_process_bytes</a>(spam-&gt;rx-&gt;pattern, strlen(spam-&gt;rx-&gt;pattern), &amp;ctx);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <a class="code" href="md5_8c.html#a2167ee252f9d864c15739ad707f9c88e">md5_process_bytes</a>(spam-&gt;template, strlen(spam-&gt;template), &amp;ctx);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    }</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">/* Mix in user&#39;s nospam list */</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">for</span> (nospam = NoSpamList; nospam; nospam = nospam-&gt;<a class="code" href="structRX__LIST.html#aab70653c2056db953a9256e42875a486">next</a>)</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    {</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <a class="code" href="md5_8c.html#a2167ee252f9d864c15739ad707f9c88e">md5_process_bytes</a>(nospam-&gt;<a class="code" href="structRX__LIST.html#ae810fb84ecf9e7d33b7044a8a7bcce6d">rx</a>-&gt;<a class="code" href="structREGEXP.html#a7ae21539f8eb962f0a2cc0fffb48f33f">pattern</a>, strlen(nospam-&gt;<a class="code" href="structRX__LIST.html#ae810fb84ecf9e7d33b7044a8a7bcce6d">rx</a>-&gt;<a class="code" href="structREGEXP.html#a7ae21539f8eb962f0a2cc0fffb48f33f">pattern</a>), &amp;ctx);</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    }</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">/* Get a hash and take its bytes as an (unsigned int) hash version */</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="md5_8c.html#afb354a896f5c60f65a937a95f15ee7b7">md5_finish_ctx</a>(&amp;ctx, digest.charval);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <a class="code" href="hcache_8c.html#ac0dde9400cb5f702e4b8c6fbd6e5c0ab">hcachever</a> = digest.intval;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  }</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  h-&gt;folder = <a class="code" href="hcache_8c.html#a950cdaf6e000a670ba816ef87bca445e">get_foldername</a>(folder);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  h-&gt;crc = <a class="code" href="hcache_8c.html#ac0dde9400cb5f702e4b8c6fbd6e5c0ab">hcachever</a>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordflow">if</span> (!path || path[0] == <span class="charliteral">&#39;\0&#39;</span>)</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;h-&gt;folder);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;h);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  path = <a class="code" href="hcache_8c.html#afd994a099ba19d68418180c8421aaa45">mutt_hcache_per_folder</a>(path, h-&gt;folder, namer);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  h-&gt;ctx = ops-&gt;<a class="code" href="structhcache__ops__t.html#aeca48daf0b4f904da698493c4a533e82">open</a>(path);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="keywordflow">if</span> (h-&gt;ctx)</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordflow">return</span> h;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="comment">/* remove a possibly incompatible version */</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">if</span> (unlink (path) == 0)</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    {</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      h-&gt;ctx = ops-&gt;<a class="code" href="structhcache__ops__t.html#aeca48daf0b4f904da698493c4a533e82">open</a>(path);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keywordflow">if</span> (h-&gt;ctx)</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keywordflow">return</span> h;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;h-&gt;folder);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;h);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  }</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;}</div><div class="ttc" id="structSPAM__LIST_html"><div class="ttname"><a href="structSPAM__LIST.html">SPAM_LIST</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00645">mutt.h:645</a></div></div>
<div class="ttc" id="structRX__LIST_html"><div class="ttname"><a href="structRX__LIST.html">RX_LIST</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00639">mutt.h:639</a></div></div>
<div class="ttc" id="explodename_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="explodename_8c_source.html#l00034">explodename.c:34</a></div></div>
<div class="ttc" id="md5_8c_html_ac3ac4bf337ea2ebffcecb83d4533f877"><div class="ttname"><a href="md5_8c.html#ac3ac4bf337ea2ebffcecb83d4533f877">md5_init_ctx</a></div><div class="ttdeci">void md5_init_ctx(struct md5_ctx *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="md5_8c_source.html#l00072">md5.c:72</a></div></div>
<div class="ttc" id="lib_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00077">lib.h:77</a></div></div>
<div class="ttc" id="hcache_8c_html_a950cdaf6e000a670ba816ef87bca445e"><div class="ttname"><a href="hcache_8c.html#a950cdaf6e000a670ba816ef87bca445e">get_foldername</a></div><div class="ttdeci">static char * get_foldername(const char *folder)</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00718">hcache.c:718</a></div></div>
<div class="ttc" id="structREGEXP_html_a7ae21539f8eb962f0a2cc0fffb48f33f"><div class="ttname"><a href="structREGEXP.html#a7ae21539f8eb962f0a2cc0fffb48f33f">REGEXP::pattern</a></div><div class="ttdeci">char * pattern</div><div class="ttdef"><b>Definition:</b> <a href="mutt__regex_8h_source.html#l00044">mutt_regex.h:44</a></div></div>
<div class="ttc" id="structRX__LIST_html_aab70653c2056db953a9256e42875a486"><div class="ttname"><a href="structRX__LIST.html#aab70653c2056db953a9256e42875a486">RX_LIST::next</a></div><div class="ttdeci">struct rx_list_t * next</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00642">mutt.h:642</a></div></div>
<div class="ttc" id="hcache_8c_html_afd994a099ba19d68418180c8421aaa45"><div class="ttname"><a href="hcache_8c.html#afd994a099ba19d68418180c8421aaa45">mutt_hcache_per_folder</a></div><div class="ttdeci">static const char * mutt_hcache_per_folder(const char *path, const char *folder, hcache_namer_t namer)</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00531">hcache.c:531</a></div></div>
<div class="ttc" id="structhcache__ops__t_html_aeca48daf0b4f904da698493c4a533e82"><div class="ttname"><a href="structhcache__ops__t.html#aeca48daf0b4f904da698493c4a533e82">hcache_ops_t::open</a></div><div class="ttdeci">hcache_open_t open</div><div class="ttdef"><b>Definition:</b> <a href="hcache-backend_8h_source.html#l00103">hcache-backend.h:103</a></div></div>
<div class="ttc" id="hcache_8c_html_ac0dde9400cb5f702e4b8c6fbd6e5c0ab"><div class="ttname"><a href="hcache_8c.html#ac0dde9400cb5f702e4b8c6fbd6e5c0ab">hcachever</a></div><div class="ttdeci">static unsigned int hcachever</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00039">hcache.c:39</a></div></div>
<div class="ttc" id="lib_8c_html_a725ea15665b1be820aee11fddd857f8a"><div class="ttname"><a href="lib_8c.html#a725ea15665b1be820aee11fddd857f8a">safe_calloc</a></div><div class="ttdeci">void * safe_calloc(size_t nmemb, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00122">lib.c:122</a></div></div>
<div class="ttc" id="md5_8c_html_afb354a896f5c60f65a937a95f15ee7b7"><div class="ttname"><a href="md5_8c.html#afb354a896f5c60f65a937a95f15ee7b7">md5_finish_ctx</a></div><div class="ttdeci">void * md5_finish_ctx(struct md5_ctx *ctx, void *resbuf)</div><div class="ttdef"><b>Definition:</b> <a href="md5_8c_source.html#l00109">md5.c:109</a></div></div>
<div class="ttc" id="md5_8c_html_a2167ee252f9d864c15739ad707f9c88e"><div class="ttname"><a href="md5_8c.html#a2167ee252f9d864c15739ad707f9c88e">md5_process_bytes</a></div><div class="ttdeci">void md5_process_bytes(const void *buffer, size_t len, struct md5_ctx *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="md5_8c_source.html#l00219">md5.c:219</a></div></div>
<div class="ttc" id="structhcache__ops__t_html"><div class="ttname"><a href="structhcache__ops__t.html">hcache_ops_t</a></div><div class="ttdef"><b>Definition:</b> <a href="hcache-backend_8h_source.html#l00100">hcache-backend.h:100</a></div></div>
<div class="ttc" id="structRX__LIST_html_ae810fb84ecf9e7d33b7044a8a7bcce6d"><div class="ttname"><a href="structRX__LIST.html#ae810fb84ecf9e7d33b7044a8a7bcce6d">RX_LIST::rx</a></div><div class="ttdeci">REGEXP * rx</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00641">mutt.h:641</a></div></div>
<div class="ttc" id="hcache_8c_html_a51511cd14787b537b38ed24431384743"><div class="ttname"><a href="hcache_8c.html#a51511cd14787b537b38ed24431384743">hcache_get_ops</a></div><div class="ttdeci">#define hcache_get_ops()</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00107">hcache.c:107</a></div></div>
<div class="ttc" id="structmd5__ctx_html"><div class="ttname"><a href="structmd5__ctx.html">md5_ctx</a></div><div class="ttdef"><b>Definition:</b> <a href="md5_8h_source.html#l00068">md5.h:68</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab70197e91a184083ea2ac9d4d75c47f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab70197e91a184083ea2ac9d4d75c47f0">&#9670;&nbsp;</a></span>mutt_hcache_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_hcache_close </td>
          <td>(</td>
          <td class="paramtype">header_cache_t *&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>close the connection to the header cache. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>Pointer to the header_cache_t structure got by mutt_hcache_open. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="hcache_8c_source.html#l00809">809</a> of file <a class="el" href="hcache_8c_source.html">hcache.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;{</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keyword">const</span> <a class="code" href="structhcache__ops__t.html">hcache_ops_t</a> *ops = <a class="code" href="hcache_8c.html#a51511cd14787b537b38ed24431384743">hcache_get_ops</a>();</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordflow">if</span> (!h || !ops)</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  ops-&gt;<a class="code" href="structhcache__ops__t.html#aa64c0adf20262deea521071a0a15f231">close</a>(&amp;h-&gt;ctx);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a> (&amp;h-&gt;folder);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a> (&amp;h);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;}</div><div class="ttc" id="lib_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00077">lib.h:77</a></div></div>
<div class="ttc" id="structhcache__ops__t_html"><div class="ttname"><a href="structhcache__ops__t.html">hcache_ops_t</a></div><div class="ttdef"><b>Definition:</b> <a href="hcache-backend_8h_source.html#l00100">hcache-backend.h:100</a></div></div>
<div class="ttc" id="hcache_8c_html_a51511cd14787b537b38ed24431384743"><div class="ttname"><a href="hcache_8c.html#a51511cd14787b537b38ed24431384743">hcache_get_ops</a></div><div class="ttdeci">#define hcache_get_ops()</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00107">hcache.c:107</a></div></div>
<div class="ttc" id="structhcache__ops__t_html_aa64c0adf20262deea521071a0a15f231"><div class="ttname"><a href="structhcache__ops__t.html#aa64c0adf20262deea521071a0a15f231">hcache_ops_t::close</a></div><div class="ttdeci">hcache_close_t close</div><div class="ttdef"><b>Definition:</b> <a href="hcache-backend_8h_source.html#l00108">hcache-backend.h:108</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a328c1cf43151360a9001b2423ffd6ab8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a328c1cf43151360a9001b2423ffd6ab8">&#9670;&nbsp;</a></span>mutt_hcache_fetch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* mutt_hcache_fetch </td>
          <td>(</td>
          <td class="paramtype">header_cache_t *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>fetch and validate a message's header from the cache. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>Pointer to the header_cache_t structure got by mutt_hcache_open. </td></tr>
    <tr><td class="paramname">key</td><td>Message identification string. </td></tr>
    <tr><td class="paramname">keylen</td><td>Length of the string pointed to by key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the data if found and valid, NULL otherwise. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function performs a check on the validity of the data found by comparing it with the crc value of the header_cache_t structure. </dd>
<dd>
The returned pointer must be freed by calling mutt_hcache_free. This must be done before closing the header cache with mutt_hcache_close. </dd></dl>

<p class="definition">Definition at line <a class="el" href="hcache_8c_source.html#l00821">821</a> of file <a class="el" href="hcache_8c_source.html">hcache.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;{</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keywordtype">void</span>* data;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  data = <a class="code" href="hcache_8c.html#ae65c9e1141287d9e21e541475df3f7bf">mutt_hcache_fetch_raw</a> (h, <a class="code" href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, keylen);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="keywordflow">if</span> (!data)</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  {</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  }</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="hcache_8c.html#a9c09e8506dbc73b516f4e8518d576d13">crc_matches</a>(data, h-&gt;crc))</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  {</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <a class="code" href="hcache_8c.html#a51e16ac36abe59d7df4b6be113efe90c">mutt_hcache_free</a>(h, &amp;data);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  }</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordflow">return</span> data;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;}</div><div class="ttc" id="explodename_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="explodename_8c_source.html#l00034">explodename.c:34</a></div></div>
<div class="ttc" id="charset_8c_html_acd3d88da3c0e0313c3645ff34f62f542"><div class="ttname"><a href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> <a href="charset_8c_source.html#l00055">charset.c:55</a></div></div>
<div class="ttc" id="hcache_8c_html_ae65c9e1141287d9e21e541475df3f7bf"><div class="ttname"><a href="hcache_8c.html#ae65c9e1141287d9e21e541475df3f7bf">mutt_hcache_fetch_raw</a></div><div class="ttdeci">void * mutt_hcache_fetch_raw(header_cache_t *h, const char *key, size_t keylen)</div><div class="ttdoc">fetch a message&amp;#39;s header from the cache. </div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00841">hcache.c:841</a></div></div>
<div class="ttc" id="hcache_8c_html_a51e16ac36abe59d7df4b6be113efe90c"><div class="ttname"><a href="hcache_8c.html#a51e16ac36abe59d7df4b6be113efe90c">mutt_hcache_free</a></div><div class="ttdeci">void mutt_hcache_free(header_cache_t *h, void **data)</div><div class="ttdoc">free previously fetched data. </div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00855">hcache.c:855</a></div></div>
<div class="ttc" id="hcache_8c_html_a9c09e8506dbc73b516f4e8518d576d13"><div class="ttname"><a href="hcache_8c.html#a9c09e8506dbc73b516f4e8518d576d13">crc_matches</a></div><div class="ttdeci">static int crc_matches(const char *d, unsigned int crc)</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00516">hcache.c:516</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae65c9e1141287d9e21e541475df3f7bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae65c9e1141287d9e21e541475df3f7bf">&#9670;&nbsp;</a></span>mutt_hcache_fetch_raw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* mutt_hcache_fetch_raw </td>
          <td>(</td>
          <td class="paramtype">header_cache_t *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>fetch a message's header from the cache. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>Pointer to the header_cache_t structure got by mutt_hcache_open. </td></tr>
    <tr><td class="paramname">key</td><td>Message identification string. </td></tr>
    <tr><td class="paramname">keylen</td><td>Length of the string pointed to by key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the data if found, NULL otherwise. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function does not perform any check on the validity of the data found. </dd>
<dd>
The returned pointer must be freed by calling mutt_hcache_free. This must be done before closing the header cache with mutt_hcache_close. </dd></dl>

<p class="definition">Definition at line <a class="el" href="hcache_8c_source.html#l00841">841</a> of file <a class="el" href="hcache_8c_source.html">hcache.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;{</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keywordtype">char</span> path[<a class="code" href="dcigettext_8c.html#a45614b6d4dc532a7211d75e0aa18c964">_POSIX_PATH_MAX</a>];</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keyword">const</span> <a class="code" href="structhcache__ops__t.html">hcache_ops_t</a> *ops = <a class="code" href="hcache_8c.html#a51511cd14787b537b38ed24431384743">hcache_get_ops</a>();</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordflow">if</span> (!h || !ops)</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  keylen = <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a>(path, <span class="keyword">sizeof</span>(path), <span class="stringliteral">&quot;%s%s&quot;</span>, h-&gt;folder, <a class="code" href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keywordflow">return</span> ops-&gt;<a class="code" href="structhcache__ops__t.html#a7dafaeb2a551ca01eaf004c36ce09eea">fetch</a>(h-&gt;ctx, path, keylen);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;}</div><div class="ttc" id="explodename_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="explodename_8c_source.html#l00034">explodename.c:34</a></div></div>
<div class="ttc" id="charset_8c_html_acd3d88da3c0e0313c3645ff34f62f542"><div class="ttname"><a href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> <a href="charset_8c_source.html#l00055">charset.c:55</a></div></div>
<div class="ttc" id="dcigettext_8c_html_a45614b6d4dc532a7211d75e0aa18c964"><div class="ttname"><a href="dcigettext_8c.html#a45614b6d4dc532a7211d75e0aa18c964">_POSIX_PATH_MAX</a></div><div class="ttdeci">#define _POSIX_PATH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="dcigettext_8c_source.html#l00159">dcigettext.c:159</a></div></div>
<div class="ttc" id="dotlock_8c_html_a357a42eb6494ea592e9c3f96c55cebe2"><div class="ttname"><a href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a></div><div class="ttdeci">int snprintf(char *, size_t, const char *,...)</div></div>
<div class="ttc" id="structhcache__ops__t_html"><div class="ttname"><a href="structhcache__ops__t.html">hcache_ops_t</a></div><div class="ttdef"><b>Definition:</b> <a href="hcache-backend_8h_source.html#l00100">hcache-backend.h:100</a></div></div>
<div class="ttc" id="hcache_8c_html_a51511cd14787b537b38ed24431384743"><div class="ttname"><a href="hcache_8c.html#a51511cd14787b537b38ed24431384743">hcache_get_ops</a></div><div class="ttdeci">#define hcache_get_ops()</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00107">hcache.c:107</a></div></div>
<div class="ttc" id="structhcache__ops__t_html_a7dafaeb2a551ca01eaf004c36ce09eea"><div class="ttname"><a href="structhcache__ops__t.html#a7dafaeb2a551ca01eaf004c36ce09eea">hcache_ops_t::fetch</a></div><div class="ttdeci">hcache_fetch_t fetch</div><div class="ttdef"><b>Definition:</b> <a href="hcache-backend_8h_source.html#l00104">hcache-backend.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a51e16ac36abe59d7df4b6be113efe90c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51e16ac36abe59d7df4b6be113efe90c">&#9670;&nbsp;</a></span>mutt_hcache_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_hcache_free </td>
          <td>(</td>
          <td class="paramtype">header_cache_t *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>free previously fetched data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>Pointer to the header_cache_t structure got by mutt_hcache_open. </td></tr>
    <tr><td class="paramname">data</td><td>Pointer to the data got using hcache_fetch or hcache_fetch_raw. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="hcache_8c_source.html#l00855">855</a> of file <a class="el" href="hcache_8c_source.html">hcache.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;{</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="keyword">const</span> <a class="code" href="structhcache__ops__t.html">hcache_ops_t</a> *ops = <a class="code" href="hcache_8c.html#a51511cd14787b537b38ed24431384743">hcache_get_ops</a>();</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="keywordflow">if</span> (!h || !ops)</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  ops-&gt;<a class="code" href="structhcache__ops__t.html#a0ee9f8b1055a9ff3244a5f84d56b186f">free</a>(h-&gt;ctx, data); <span class="comment">/* __MEM_CHECKED__ */</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;}</div><div class="ttc" id="structhcache__ops__t_html_a0ee9f8b1055a9ff3244a5f84d56b186f"><div class="ttname"><a href="structhcache__ops__t.html#a0ee9f8b1055a9ff3244a5f84d56b186f">hcache_ops_t::free</a></div><div class="ttdeci">hcache_free_t free</div><div class="ttdef"><b>Definition:</b> <a href="hcache-backend_8h_source.html#l00105">hcache-backend.h:105</a></div></div>
<div class="ttc" id="structhcache__ops__t_html"><div class="ttname"><a href="structhcache__ops__t.html">hcache_ops_t</a></div><div class="ttdef"><b>Definition:</b> <a href="hcache-backend_8h_source.html#l00100">hcache-backend.h:100</a></div></div>
<div class="ttc" id="hcache_8c_html_a51511cd14787b537b38ed24431384743"><div class="ttname"><a href="hcache_8c.html#a51511cd14787b537b38ed24431384743">hcache_get_ops</a></div><div class="ttdeci">#define hcache_get_ops()</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00107">hcache.c:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9823bf6c6a98105772e3dc6f92043a3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9823bf6c6a98105772e3dc6f92043a3a">&#9670;&nbsp;</a></span>mutt_hcache_restore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structHEADER.html">HEADER</a>* mutt_hcache_restore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> unsigned char *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>restore a <a class="el" href="structHEADER.html">HEADER</a> from data retrieved from the cache. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>Data retrieved using mutt_hcache_fetch or mutt_hcache_fetch_raw. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the restored header (cannot be NULL). </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The returned <a class="el" href="structHEADER.html">HEADER</a> must be free'd by caller code with mutt_free_header. </dd></dl>

<p class="definition">Definition at line <a class="el" href="hcache_8c_source.html#l00692">692</a> of file <a class="el" href="hcache_8c_source.html">hcache.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;{</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="keywordtype">int</span> off = 0;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <a class="code" href="structHEADER.html">HEADER</a> *h = <a class="code" href="protos_8h.html#ac0665efcb55965ec87b1626c794ffcfa">mutt_new_header</a>();</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordtype">int</span> convert = !<a class="code" href="mbyte_8c.html#aa7cfe33018400660f7eb87eb189fc223">Charset_is_utf8</a>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="comment">/* skip validate */</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  off += <span class="keyword">sizeof</span> (<a class="code" href="unionvalidate.html">validate</a>);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="comment">/* skip crc */</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  off += <span class="keyword">sizeof</span> (<span class="keywordtype">unsigned</span> int);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  memcpy(h, d + off, <span class="keyword">sizeof</span> (<a class="code" href="structHEADER.html">HEADER</a>));</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  off += <span class="keyword">sizeof</span> (<a class="code" href="structHEADER.html">HEADER</a>);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  h-&gt;<a class="code" href="structHEADER.html#ae018c74ea2e19cfc03288a0e2d28bb24">env</a> = <a class="code" href="protos_8h.html#ad32e7c5b93058eee3c10159549d69a91">mutt_new_envelope</a>();</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <a class="code" href="hcache_8c.html#a5d1393dfe5b348b6fe6725009b8011aa">restore_envelope</a>(h-&gt;<a class="code" href="structHEADER.html#ae018c74ea2e19cfc03288a0e2d28bb24">env</a>, d, &amp;off, convert);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  h-&gt;<a class="code" href="structHEADER.html#ad45a608a5d953bc6b62878ad39206d6d">content</a> = <a class="code" href="muttlib_8c.html#a7067702c3f9fb989af03341e79130d1d">mutt_new_body</a>();</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <a class="code" href="hcache_8c.html#aee152d9a9ab03a2badcc6042d9987ae3">restore_body</a>(h-&gt;<a class="code" href="structHEADER.html#ad45a608a5d953bc6b62878ad39206d6d">content</a>, d, &amp;off, convert);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <a class="code" href="hcache_8c.html#ab6a22756054eee740e62703e2ec84948">restore_char</a>(&amp;h-&gt;<a class="code" href="structHEADER.html#adfd64f7b7d5e6ac5ec71591c66b5f881">maildir_flags</a>, d, &amp;off, convert);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">return</span> h;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;}</div><div class="ttc" id="protos_8h_html_ac0665efcb55965ec87b1626c794ffcfa"><div class="ttname"><a href="protos_8h.html#ac0665efcb55965ec87b1626c794ffcfa">mutt_new_header</a></div><div class="ttdeci">#define mutt_new_header()</div><div class="ttdef"><b>Definition:</b> <a href="protos_8h_source.html#l00076">protos.h:76</a></div></div>
<div class="ttc" id="structHEADER_html_adfd64f7b7d5e6ac5ec71591c66b5f881"><div class="ttname"><a href="structHEADER.html#adfd64f7b7d5e6ac5ec71591c66b5f881">HEADER::maildir_flags</a></div><div class="ttdeci">char * maildir_flags</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00901">mutt.h:901</a></div></div>
<div class="ttc" id="structHEADER_html"><div class="ttname"><a href="structHEADER.html">HEADER</a></div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00820">mutt.h:820</a></div></div>
<div class="ttc" id="mbyte_8c_html_aa7cfe33018400660f7eb87eb189fc223"><div class="ttname"><a href="mbyte_8c.html#aa7cfe33018400660f7eb87eb189fc223">Charset_is_utf8</a></div><div class="ttdeci">int Charset_is_utf8</div><div class="ttdef"><b>Definition:</b> <a href="mbyte_8c_source.html#l00039">mbyte.c:39</a></div></div>
<div class="ttc" id="hcache_8c_html_a5d1393dfe5b348b6fe6725009b8011aa"><div class="ttname"><a href="hcache_8c.html#a5d1393dfe5b348b6fe6725009b8011aa">restore_envelope</a></div><div class="ttdeci">static void restore_envelope(ENVELOPE *e, const unsigned char *d, int *off, int convert)</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00475">hcache.c:475</a></div></div>
<div class="ttc" id="structHEADER_html_ad45a608a5d953bc6b62878ad39206d6d"><div class="ttname"><a href="structHEADER.html#ad45a608a5d953bc6b62878ad39206d6d">HEADER::content</a></div><div class="ttdeci">BODY * content</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00879">mutt.h:879</a></div></div>
<div class="ttc" id="unionvalidate_html"><div class="ttname"><a href="unionvalidate.html">validate</a></div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00056">hcache.c:56</a></div></div>
<div class="ttc" id="protos_8h_html_ad32e7c5b93058eee3c10159549d69a91"><div class="ttname"><a href="protos_8h.html#ad32e7c5b93058eee3c10159549d69a91">mutt_new_envelope</a></div><div class="ttdeci">#define mutt_new_envelope()</div><div class="ttdef"><b>Definition:</b> <a href="protos_8h_source.html#l00077">protos.h:77</a></div></div>
<div class="ttc" id="muttlib_8c_html_a7067702c3f9fb989af03341e79130d1d"><div class="ttname"><a href="muttlib_8c.html#a7067702c3f9fb989af03341e79130d1d">mutt_new_body</a></div><div class="ttdeci">BODY * mutt_new_body(void)</div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8c_source.html#l00068">muttlib.c:68</a></div></div>
<div class="ttc" id="hcache_8c_html_ab6a22756054eee740e62703e2ec84948"><div class="ttname"><a href="hcache_8c.html#ab6a22756054eee740e62703e2ec84948">restore_char</a></div><div class="ttdeci">static void restore_char(char **c, const unsigned char *d, int *off, int convert)</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00194">hcache.c:194</a></div></div>
<div class="ttc" id="structHEADER_html_ae018c74ea2e19cfc03288a0e2d28bb24"><div class="ttname"><a href="structHEADER.html#ae018c74ea2e19cfc03288a0e2d28bb24">HEADER::env</a></div><div class="ttdeci">ENVELOPE * env</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00878">mutt.h:878</a></div></div>
<div class="ttc" id="hcache_8c_html_aee152d9a9ab03a2badcc6042d9987ae3"><div class="ttname"><a href="hcache_8c.html#aee152d9a9ab03a2badcc6042d9987ae3">restore_body</a></div><div class="ttdeci">static void restore_body(BODY *c, const unsigned char *d, int *off, int convert)</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00418">hcache.c:418</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a77d4c577fd723ef084ad2a9b018ba833"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77d4c577fd723ef084ad2a9b018ba833">&#9670;&nbsp;</a></span>mutt_hcache_store()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_hcache_store </td>
          <td>(</td>
          <td class="paramtype">header_cache_t *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHEADER.html">HEADER</a> *&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>uidvalidity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>store a <a class="el" href="structHEADER.html">HEADER</a> along with a validity datum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>Pointer to the header_cache_t structure got by mutt_hcache_open. </td></tr>
    <tr><td class="paramname">key</td><td>Message identification string. </td></tr>
    <tr><td class="paramname">keylen</td><td>Length of the string pointed to by key. </td></tr>
    <tr><td class="paramname">header</td><td>Message header to store. </td></tr>
    <tr><td class="paramname">uidvalidity</td><td>IMAP-specific UIDVALIDITY value, or 0 to use the current time. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="hcache_8c_source.html#l00866">866</a> of file <a class="el" href="hcache_8c_source.html">hcache.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;{</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <span class="keywordtype">char</span>* data;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordtype">int</span> dlen;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keywordflow">if</span> (!h)</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  data = <a class="code" href="hcache_8c.html#af84ec602905f18817c08b60849053eb7">mutt_hcache_dump</a>(h, header, &amp;dlen, uidvalidity);</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  ret = <a class="code" href="hcache_8c.html#add0651518cff8eb01d398664cd98037b">mutt_hcache_store_raw</a> (h, <a class="code" href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>, keylen, data, dlen);</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <a class="code" href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;data);</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;}</div><div class="ttc" id="lib_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="lib_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00077">lib.h:77</a></div></div>
<div class="ttc" id="charset_8c_html_acd3d88da3c0e0313c3645ff34f62f542"><div class="ttname"><a href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> <a href="charset_8c_source.html#l00055">charset.c:55</a></div></div>
<div class="ttc" id="hcache_8c_html_add0651518cff8eb01d398664cd98037b"><div class="ttname"><a href="hcache_8c.html#add0651518cff8eb01d398664cd98037b">mutt_hcache_store_raw</a></div><div class="ttdeci">int mutt_hcache_store_raw(header_cache_t *h, const char *key, size_t keylen, void *data, size_t dlen)</div><div class="ttdoc">store a key / data pair. </div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00885">hcache.c:885</a></div></div>
<div class="ttc" id="hcache_8c_html_af84ec602905f18817c08b60849053eb7"><div class="ttname"><a href="hcache_8c.html#af84ec602905f18817c08b60849053eb7">mutt_hcache_dump</a></div><div class="ttdeci">static void * mutt_hcache_dump(header_cache_t *h, HEADER *header, int *off, unsigned int uidvalidity)</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00633">hcache.c:633</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="add0651518cff8eb01d398664cd98037b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add0651518cff8eb01d398664cd98037b">&#9670;&nbsp;</a></span>mutt_hcache_store_raw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_hcache_store_raw </td>
          <td>(</td>
          <td class="paramtype">header_cache_t *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>dlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>store a key / data pair. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>Pointer to the header_cache_t structure got by mutt_hcache_open. </td></tr>
    <tr><td class="paramname">key</td><td>Message identification string. </td></tr>
    <tr><td class="paramname">keylen</td><td>Length of the string pointed to by key. </td></tr>
    <tr><td class="paramname">data</td><td>Payload to associate with key. </td></tr>
    <tr><td class="paramname">dlen</td><td>Length of the buffer pointed to by the  parameter. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="hcache_8c_source.html#l00885">885</a> of file <a class="el" href="hcache_8c_source.html">hcache.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;{</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keywordtype">char</span> path[<a class="code" href="dcigettext_8c.html#a45614b6d4dc532a7211d75e0aa18c964">_POSIX_PATH_MAX</a>];</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="keyword">const</span> <a class="code" href="structhcache__ops__t.html">hcache_ops_t</a> *ops = <a class="code" href="hcache_8c.html#a51511cd14787b537b38ed24431384743">hcache_get_ops</a>();</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">if</span> (!h || !ops)</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  keylen = <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a>(path, <span class="keyword">sizeof</span>(path), <span class="stringliteral">&quot;%s%s&quot;</span>, h-&gt;folder, <a class="code" href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keywordflow">return</span> ops-&gt;<a class="code" href="structhcache__ops__t.html#a4b5c586667243b50bad3c5f830308af6">store</a>(h-&gt;ctx, path, keylen, data, dlen);</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;}</div><div class="ttc" id="structhcache__ops__t_html_a4b5c586667243b50bad3c5f830308af6"><div class="ttname"><a href="structhcache__ops__t.html#a4b5c586667243b50bad3c5f830308af6">hcache_ops_t::store</a></div><div class="ttdeci">hcache_store_t store</div><div class="ttdef"><b>Definition:</b> <a href="hcache-backend_8h_source.html#l00106">hcache-backend.h:106</a></div></div>
<div class="ttc" id="charset_8c_html_acd3d88da3c0e0313c3645ff34f62f542"><div class="ttname"><a href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> <a href="charset_8c_source.html#l00055">charset.c:55</a></div></div>
<div class="ttc" id="dcigettext_8c_html_a45614b6d4dc532a7211d75e0aa18c964"><div class="ttname"><a href="dcigettext_8c.html#a45614b6d4dc532a7211d75e0aa18c964">_POSIX_PATH_MAX</a></div><div class="ttdeci">#define _POSIX_PATH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="dcigettext_8c_source.html#l00159">dcigettext.c:159</a></div></div>
<div class="ttc" id="dotlock_8c_html_a357a42eb6494ea592e9c3f96c55cebe2"><div class="ttname"><a href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a></div><div class="ttdeci">int snprintf(char *, size_t, const char *,...)</div></div>
<div class="ttc" id="structhcache__ops__t_html"><div class="ttname"><a href="structhcache__ops__t.html">hcache_ops_t</a></div><div class="ttdef"><b>Definition:</b> <a href="hcache-backend_8h_source.html#l00100">hcache-backend.h:100</a></div></div>
<div class="ttc" id="hcache_8c_html_a51511cd14787b537b38ed24431384743"><div class="ttname"><a href="hcache_8c.html#a51511cd14787b537b38ed24431384743">hcache_get_ops</a></div><div class="ttdeci">#define hcache_get_ops()</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00107">hcache.c:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af464c9289099045a67095846de0939de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af464c9289099045a67095846de0939de">&#9670;&nbsp;</a></span>mutt_hcache_delete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_hcache_delete </td>
          <td>(</td>
          <td class="paramtype">header_cache_t *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>delete a key / data pair. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>Pointer to the header_cache_t structure got by mutt_hcache_open. </td></tr>
    <tr><td class="paramname">key</td><td>Message identification string. </td></tr>
    <tr><td class="paramname">keylen</td><td>Length of the string pointed to by key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="hcache_8c_source.html#l00900">900</a> of file <a class="el" href="hcache_8c_source.html">hcache.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;{</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="keywordtype">char</span> path[<a class="code" href="dcigettext_8c.html#a45614b6d4dc532a7211d75e0aa18c964">_POSIX_PATH_MAX</a>];</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keyword">const</span> <a class="code" href="structhcache__ops__t.html">hcache_ops_t</a> *ops = <a class="code" href="hcache_8c.html#a51511cd14787b537b38ed24431384743">hcache_get_ops</a>();</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordflow">if</span> (!h)</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  keylen = <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a>(path, <span class="keyword">sizeof</span>(path), <span class="stringliteral">&quot;%s%s&quot;</span>, h-&gt;folder, <a class="code" href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keywordflow">return</span> ops-&gt;<a class="code" href="structhcache__ops__t.html#a0e90baeea684e215f8bfe9dbeaed94be">delete</a>(h-&gt;ctx, path, keylen);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;}</div><div class="ttc" id="charset_8c_html_acd3d88da3c0e0313c3645ff34f62f542"><div class="ttname"><a href="charset_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> <a href="charset_8c_source.html#l00055">charset.c:55</a></div></div>
<div class="ttc" id="dcigettext_8c_html_a45614b6d4dc532a7211d75e0aa18c964"><div class="ttname"><a href="dcigettext_8c.html#a45614b6d4dc532a7211d75e0aa18c964">_POSIX_PATH_MAX</a></div><div class="ttdeci">#define _POSIX_PATH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="dcigettext_8c_source.html#l00159">dcigettext.c:159</a></div></div>
<div class="ttc" id="structhcache__ops__t_html_a0e90baeea684e215f8bfe9dbeaed94be"><div class="ttname"><a href="structhcache__ops__t.html#a0e90baeea684e215f8bfe9dbeaed94be">hcache_ops_t::delete</a></div><div class="ttdeci">hcache_delete_t delete</div><div class="ttdef"><b>Definition:</b> <a href="hcache-backend_8h_source.html#l00107">hcache-backend.h:107</a></div></div>
<div class="ttc" id="dotlock_8c_html_a357a42eb6494ea592e9c3f96c55cebe2"><div class="ttname"><a href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a></div><div class="ttdeci">int snprintf(char *, size_t, const char *,...)</div></div>
<div class="ttc" id="structhcache__ops__t_html"><div class="ttname"><a href="structhcache__ops__t.html">hcache_ops_t</a></div><div class="ttdef"><b>Definition:</b> <a href="hcache-backend_8h_source.html#l00100">hcache-backend.h:100</a></div></div>
<div class="ttc" id="hcache_8c_html_a51511cd14787b537b38ed24431384743"><div class="ttname"><a href="hcache_8c.html#a51511cd14787b537b38ed24431384743">hcache_get_ops</a></div><div class="ttdeci">#define hcache_get_ops()</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00107">hcache.c:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a19989208cbd44d4083d872702017e1fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19989208cbd44d4083d872702017e1fc">&#9670;&nbsp;</a></span>mutt_hcache_backend_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char* mutt_hcache_backend_list </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get a list of backend identification strings. </p>
<dl class="section return"><dt>Returns</dt><dd>Comma separated string describing the compiled-in backends. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The returned string must be free'd by the caller. </dd></dl>

<p class="definition">Definition at line <a class="el" href="hcache_8c_source.html#l00914">914</a> of file <a class="el" href="hcache_8c_source.html">hcache.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;{</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordtype">char</span> tmp[<a class="code" href="lib_8h.html#a0f4d394a3ab4e09bff60f714c66dc5ee">STRING</a>] = {0};</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="keyword">const</span> <a class="code" href="structhcache__ops__t.html">hcache_ops_t</a> **ops = <a class="code" href="hcache_8c.html#ac28bf7f84358bb47503a1570601ee1bb">hcache_ops</a>;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="keywordtype">size_t</span> len = 0;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="keywordflow">for</span> (; *ops; ++ops)</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  {</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">if</span> (len != 0)</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      len += <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a>(tmp+len, <a class="code" href="lib_8h.html#a0f4d394a3ab4e09bff60f714c66dc5ee">STRING</a>-len, <span class="stringliteral">&quot;, &quot;</span>);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    len += <a class="code" href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a>(tmp+len, <a class="code" href="lib_8h.html#a0f4d394a3ab4e09bff60f714c66dc5ee">STRING</a>-len, <span class="stringliteral">&quot;%s&quot;</span>, (*ops)-&gt;name);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a>(tmp);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;}</div><div class="ttc" id="hcache_8c_html_ac28bf7f84358bb47503a1570601ee1bb"><div class="ttname"><a href="hcache_8c.html#ac28bf7f84358bb47503a1570601ee1bb">hcache_ops</a></div><div class="ttdeci">HCACHE_BACKEND_LIST const hcache_ops_t * hcache_ops[]</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00068">hcache.c:68</a></div></div>
<div class="ttc" id="lib_8c_html_a26d804f329dea2733da34a4953a22a9d"><div class="ttname"><a href="lib_8c.html#a26d804f329dea2733da34a4953a22a9d">safe_strdup</a></div><div class="ttdeci">char * safe_strdup(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8c_source.html#l00234">lib.c:234</a></div></div>
<div class="ttc" id="dotlock_8c_html_a357a42eb6494ea592e9c3f96c55cebe2"><div class="ttname"><a href="dotlock_8c.html#a357a42eb6494ea592e9c3f96c55cebe2">snprintf</a></div><div class="ttdeci">int snprintf(char *, size_t, const char *,...)</div></div>
<div class="ttc" id="structhcache__ops__t_html"><div class="ttname"><a href="structhcache__ops__t.html">hcache_ops_t</a></div><div class="ttdef"><b>Definition:</b> <a href="hcache-backend_8h_source.html#l00100">hcache-backend.h:100</a></div></div>
<div class="ttc" id="lib_8h_html_a0f4d394a3ab4e09bff60f714c66dc5ee"><div class="ttname"><a href="lib_8h.html#a0f4d394a3ab4e09bff60f714c66dc5ee">STRING</a></div><div class="ttdeci">#define STRING</div><div class="ttdef"><b>Definition:</b> <a href="lib_8h_source.html#l00062">lib.h:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a69ce8852e97f26b5355cffddc69dcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a69ce8852e97f26b5355cffddc69dcd">&#9670;&nbsp;</a></span>mutt_hcache_is_valid_backend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_hcache_is_valid_backend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="plural_8c.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>mutt_hcache_is_valid_backend </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>String identifying a backend. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if s is recognized as a valid backend, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="hcache_8c_source.html#l00933">933</a> of file <a class="el" href="hcache_8c_source.html">hcache.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;{</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="hcache_8c.html#a99254f079fd121f3d0980c5bcf689ae5">hcache_get_backend_ops</a>(s) != <a class="code" href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;}</div><div class="ttc" id="explodename_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="explodename_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="explodename_8c_source.html#l00034">explodename.c:34</a></div></div>
<div class="ttc" id="hcache_8c_html_a99254f079fd121f3d0980c5bcf689ae5"><div class="ttname"><a href="hcache_8c.html#a99254f079fd121f3d0980c5bcf689ae5">hcache_get_backend_ops</a></div><div class="ttdeci">static const hcache_ops_t * hcache_get_backend_ops(const char *backend)</div><div class="ttdef"><b>Definition:</b> <a href="hcache_8c_source.html#l00091">hcache.c:91</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
